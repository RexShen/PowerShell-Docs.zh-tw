---
external help file: Microsoft.PowerShell.Commands.Diagnostics.dll-Help.xml
keywords: powershell,cmdlet
Locale: en-US
Module Name: Microsoft.PowerShell.Diagnostics
ms.date: 11/20/2019
online version: https://docs.microsoft.com/powershell/module/microsoft.powershell.diagnostics/get-winevent?view=powershell-7&WT.mc_id=ps-gethelp
schema: 2.0.0
title: Get-WinEvent
ms.openlocfilehash: a35fe7d46773f8d20ed0ca40ea856a0e9619a2b5
ms.sourcegitcommit: de63e9481cf8024883060aae61fb02c59c2de662
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/03/2020
ms.locfileid: "93201199"
---
# <span data-ttu-id="ad296-103">Get-WinEvent</span><span class="sxs-lookup"><span data-stu-id="ad296-103">Get-WinEvent</span></span>

## <span data-ttu-id="ad296-104">概要</span><span class="sxs-lookup"><span data-stu-id="ad296-104">SYNOPSIS</span></span>
<span data-ttu-id="ad296-105">從本機電腦和遠端電腦上的事件記錄檔和事件追蹤記錄檔取得事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-105">Gets events from event logs and event tracing log files on local and remote computers.</span></span>

## <span data-ttu-id="ad296-106">SYNTAX</span><span class="sxs-lookup"><span data-stu-id="ad296-106">SYNTAX</span></span>

### <span data-ttu-id="ad296-107">GetLogSet (預設) </span><span class="sxs-lookup"><span data-stu-id="ad296-107">GetLogSet (Default)</span></span>

```
Get-WinEvent [[-LogName] <String[]>] [-MaxEvents <Int64>] [-ComputerName <String>]
 [-Credential <PSCredential>] [-FilterXPath <String>] [-Force] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="ad296-108">ListLogSet</span><span class="sxs-lookup"><span data-stu-id="ad296-108">ListLogSet</span></span>

```
Get-WinEvent [-ListLog] <String[]> [-ComputerName <String>] [-Credential <PSCredential>] [-Force]
 [<CommonParameters>]
```

### <span data-ttu-id="ad296-109">ListProviderSet</span><span class="sxs-lookup"><span data-stu-id="ad296-109">ListProviderSet</span></span>

```
Get-WinEvent [-ListProvider] <String[]> [-ComputerName <String>] [-Credential <PSCredential>]
 [<CommonParameters>]
```

### <span data-ttu-id="ad296-110">GetProviderSet</span><span class="sxs-lookup"><span data-stu-id="ad296-110">GetProviderSet</span></span>

```
Get-WinEvent [-ProviderName] <String[]> [-MaxEvents <Int64>] [-ComputerName <String>]
 [-Credential <PSCredential>] [-FilterXPath <String>] [-Force] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="ad296-111">FileSet</span><span class="sxs-lookup"><span data-stu-id="ad296-111">FileSet</span></span>

```
Get-WinEvent [-Path] <String[]> [-MaxEvents <Int64>] [-Credential <PSCredential>]
 [-FilterXPath <String>] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="ad296-112">HashQuerySet</span><span class="sxs-lookup"><span data-stu-id="ad296-112">HashQuerySet</span></span>

```
Get-WinEvent [-MaxEvents <Int64>] [-ComputerName <String>] [-Credential <PSCredential>]
 [-FilterHashtable] <Hashtable[]> [-Force] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="ad296-113">XmlQuerySet</span><span class="sxs-lookup"><span data-stu-id="ad296-113">XmlQuerySet</span></span>

```
Get-WinEvent [-MaxEvents <Int64>] [-ComputerName <String>] [-Credential <PSCredential>]
 [-FilterXml] <XmlDocument> [-Oldest] [<CommonParameters>]
```

## <span data-ttu-id="ad296-114">DESCRIPTION</span><span class="sxs-lookup"><span data-stu-id="ad296-114">DESCRIPTION</span></span>

<span data-ttu-id="ad296-115">此 `Get-WinEvent` Cmdlet 會從事件記錄檔中取得事件，包括傳統記錄檔，例如 **系統** 和 **應用程式** 記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-115">The `Get-WinEvent` cmdlet gets events from event logs, including classic logs, such as the **System** and **Application** logs.</span></span> <span data-ttu-id="ad296-116">Cmdlet 會從 windows Vista 引進的 Windows 事件記錄技術所產生的事件記錄檔中取得資料。</span><span class="sxs-lookup"><span data-stu-id="ad296-116">The cmdlet gets data from event logs that are generated by the Windows Event Log technology introduced in Windows Vista.</span></span> <span data-ttu-id="ad296-117">此外，Windows 事件追蹤所產生的記錄檔中的事件 **(ETW)** 。</span><span class="sxs-lookup"><span data-stu-id="ad296-117">And, events in log files generated by **Event Tracing for Windows (ETW)** .</span></span> <span data-ttu-id="ad296-118">依預設，會 `Get-WinEvent` 以最新到最舊的順序傳回事件資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-118">By default, `Get-WinEvent` returns event information in the order of newest to oldest.</span></span>

<span data-ttu-id="ad296-119">`Get-WinEvent` 列出事件記錄檔和事件記錄檔提供者。</span><span class="sxs-lookup"><span data-stu-id="ad296-119">`Get-WinEvent` lists event logs and event log providers.</span></span> <span data-ttu-id="ad296-120">若要中斷命令，請按下<kbd>CTRL</kbd> + <kbd>C</kbd>。</span><span class="sxs-lookup"><span data-stu-id="ad296-120">To interrupt the command, press <kbd>CTRL</kbd>+<kbd>C</kbd>.</span></span> <span data-ttu-id="ad296-121">您可以從選取的記錄檔或從選取的事件提供者所產生的記錄檔取得事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-121">You can get events from selected logs or from logs generated by selected event providers.</span></span> <span data-ttu-id="ad296-122">而且您可以在單一命令中結合來自多個來源的事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-122">And, you can combine events from multiple sources in a single command.</span></span>
<span data-ttu-id="ad296-123">`Get-WinEvent` 可讓您使用 XPath 查詢、結構化 XML 查詢，以及雜湊表查詢來篩選事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-123">`Get-WinEvent` allows you to filter events using XPath queries, structured XML queries, and hash table queries.</span></span>

<span data-ttu-id="ad296-124">如果您不是以系統管理員身分執行 PowerShell，您可能會看到錯誤訊息，指出您無法抓取記錄檔的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-124">If you're not running PowerShell as an Administrator, you might see error messages that you cannot retrieve information about a log.</span></span>

## <span data-ttu-id="ad296-125">範例</span><span class="sxs-lookup"><span data-stu-id="ad296-125">EXAMPLES</span></span>

### <span data-ttu-id="ad296-126">範例1：從本機電腦取得所有記錄</span><span class="sxs-lookup"><span data-stu-id="ad296-126">Example 1: Get all the logs from a local computer</span></span>

<span data-ttu-id="ad296-127">此命令會取得本機電腦上的所有事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-127">This command gets all the event logs on the local computer.</span></span> <span data-ttu-id="ad296-128">記錄會以取得它們的順序列出 `Get-WinEvent` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-128">Logs are listed in the order that `Get-WinEvent` gets them.</span></span> <span data-ttu-id="ad296-129">傳統記錄檔會先抓取，接著是新的 Windows 事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-129">Classic logs are retrieved first, followed by the new Windows Event logs.</span></span>
<span data-ttu-id="ad296-130">記錄檔的 **RecordCount** 可能是 null （空白或零）。</span><span class="sxs-lookup"><span data-stu-id="ad296-130">It's possible for a log's **RecordCount** to be null, which is blank, or zero.</span></span>

```powershell
Get-WinEvent -ListLog *
```

```Output
LogMode   MaximumSizeInBytes RecordCount LogName
-------   ------------------ ----------- -------
Circular            15532032       14500 Application
Circular             1052672         117 Azure Information Protection
Circular             1052672        3015 CxAudioSvcLog
Circular            20971520             ForwardedEvents
Circular            20971520           0 HardwareEvents
```

<span data-ttu-id="ad296-131">`Get-WinEvent`Cmdlet 會從電腦取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-131">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="ad296-132">**ListLog** 參數會使用星號 (`*`) 萬用字元來顯示每個記錄檔的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-132">The **ListLog** parameter uses the asterisk (`*`) wildcard to display information about each log.</span></span>

### <span data-ttu-id="ad296-133">範例2：取得傳統安裝程式記錄檔</span><span class="sxs-lookup"><span data-stu-id="ad296-133">Example 2: Get the classic Setup log</span></span>

<span data-ttu-id="ad296-134">此命令會取得代表傳統 **安裝程式** 記錄檔的 **system.diagnostics.eventing.reader.eventlogconfiguration** 物件。</span><span class="sxs-lookup"><span data-stu-id="ad296-134">This command gets an **EventLogConfiguration** object that represents the classic **Setup** log.</span></span> <span data-ttu-id="ad296-135">物件包含記錄檔的相關資訊，例如檔案大小、提供者、檔案路徑，以及是否啟用記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-135">The object includes information about the log, such as file size, provider, file path, and whether the log is enabled.</span></span>

```powershell
Get-WinEvent -ListLog Setup | Format-List -Property *
```

```Output
FileSize                       : 69632
IsLogFull                      : False
LastAccessTime                 : 3/13/2019 09:41:46
LastWriteTime                  : 3/13/2019 09:41:46
OldestRecordNumber             : 1
RecordCount                    : 23
LogName                        : Setup
LogType                        : Operational
LogIsolation                   : Application
IsEnabled                      : True
IsClassicLog                   : False
SecurityDescriptor             : O:BAG:SYD: ...
LogFilePath                    : %SystemRoot%\System32\Winevt\Logs\Setup.evtx
MaximumSizeInBytes             : 1052672
LogMode                        : Circular
OwningProviderName             : Microsoft-Windows-Eventlog
ProviderNames                  : {Microsoft-Windows-WUSA, Microsoft-Windows-ActionQueue...
ProviderLevel                  :
ProviderKeywords               :
ProviderBufferSize             : 64
ProviderMinimumNumberOfBuffers : 0
ProviderMaximumNumberOfBuffers : 64
ProviderLatency                : 1000
ProviderControlGuid            :
```

<span data-ttu-id="ad296-136">此 `Get-WinEvent` Cmdlet 會使用 **ListLog** 參數來指定 **安裝程式** 記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-136">The `Get-WinEvent` cmdlet uses the **ListLog** parameter to specify the **Setup** log.</span></span> <span data-ttu-id="ad296-137">物件會向下傳送至 `Format-List` Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-137">The object is sent down the pipeline to the `Format-List` cmdlet.</span></span> <span data-ttu-id="ad296-138">`Format-List` 使用 **Property** 參數搭配星號 (`*`) 萬用字元來顯示每個屬性。</span><span class="sxs-lookup"><span data-stu-id="ad296-138">`Format-List` uses the **Property** parameter with the asterisk (`*`) wildcard to display each property.</span></span>

### <span data-ttu-id="ad296-139">範例3：取得伺服器的事件記錄檔</span><span class="sxs-lookup"><span data-stu-id="ad296-139">Example 3: Get event logs from a server</span></span>

<span data-ttu-id="ad296-140">此命令只會取得本機電腦上包含事件的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-140">This command only gets event logs on the local computer that contain events.</span></span> <span data-ttu-id="ad296-141">記錄檔的 **RecordCount** 可能是 null 或零。</span><span class="sxs-lookup"><span data-stu-id="ad296-141">It's possible for a log's **RecordCount** to be null or zero.</span></span> <span data-ttu-id="ad296-142">此範例會使用 `$_` 變數。</span><span class="sxs-lookup"><span data-stu-id="ad296-142">The example uses the `$_` variable.</span></span> <span data-ttu-id="ad296-143">如需詳細資訊，請參閱 [about_Automatic_Variables](../Microsoft.PowerShell.Core/about/about_automatic_variables.md)。</span><span class="sxs-lookup"><span data-stu-id="ad296-143">For more information, see [about_Automatic_Variables](../Microsoft.PowerShell.Core/about/about_automatic_variables.md).</span></span>

```powershell
Get-WinEvent -ListLog * -ComputerName localhost | Where-Object { $_.RecordCount }
```

```Output
LogMode   MaximumSizeInBytes RecordCount LogName
-------   ------------------ ----------- -------
Circular            15532032       14546 Application
Circular             1052672         117 Azure Information Protection
Circular             1052672        2990 CxAudioSvcLog
Circular             1052672           9 MSFTVPN Setup
Circular             1052672         282 OAlerts
```

<span data-ttu-id="ad296-144">`Get-WinEvent`Cmdlet 會從電腦取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-144">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="ad296-145">**ListLog** 參數會使用星號 (`*`) 萬用字元來顯示每個記錄檔的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-145">The **ListLog** parameter uses the asterisk (`*`) wildcard to display information about each log.</span></span> <span data-ttu-id="ad296-146">**ComputerName** 參數指定要從本機電腦（ **localhost** ）取得記錄。</span><span class="sxs-lookup"><span data-stu-id="ad296-146">The **ComputerName** parameter specifies to get the logs from the local computer, **localhost** .</span></span> <span data-ttu-id="ad296-147">這些物件會向下傳送至 `Where-Object` Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-147">The objects are sent down the pipeline to the `Where-Object` cmdlet.</span></span> <span data-ttu-id="ad296-148">`Where-Object` 用 `$_.RecordCount` 來只傳回包含資料的記錄。</span><span class="sxs-lookup"><span data-stu-id="ad296-148">`Where-Object` uses `$_.RecordCount` to return only logs that contain data.</span></span> <span data-ttu-id="ad296-149">`$_` 這是一個變數，代表管線中的目前物件。</span><span class="sxs-lookup"><span data-stu-id="ad296-149">`$_` is a variable that represents the current object in the pipeline.</span></span> <span data-ttu-id="ad296-150">**RecordCount** 是具有非 null 值之物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="ad296-150">**RecordCount** is a property of the object with a non-null value.</span></span>

### <span data-ttu-id="ad296-151">範例4：取得多部伺服器的事件記錄檔</span><span class="sxs-lookup"><span data-stu-id="ad296-151">Example 4: Get event logs from multiple servers</span></span>

<span data-ttu-id="ad296-152">這個範例會取得物件，代表三部電腦上的 **應用程式** 事件記錄檔： Server01、Server02 和 Server03。</span><span class="sxs-lookup"><span data-stu-id="ad296-152">This example gets objects that represent the **Application** event logs on three computers: Server01, Server02, and Server03.</span></span> <span data-ttu-id="ad296-153">使用 **ForEach** 關鍵字的原因是 **ComputerName** 參數只接受一個值。</span><span class="sxs-lookup"><span data-stu-id="ad296-153">The **ForEach** keyword is used because the **ComputerName** parameter accepts only one value.</span></span> <span data-ttu-id="ad296-154">如需詳細資訊，請參閱 [about_Foreach](../Microsoft.PowerShell.Core/about/about_Foreach.md)。</span><span class="sxs-lookup"><span data-stu-id="ad296-154">For more information, see [about_Foreach](../Microsoft.PowerShell.Core/about/about_Foreach.md).</span></span>

```powershell
$S = 'Server01', 'Server02', 'Server03'
ForEach ($Server in $S) {
  Get-WinEvent -ListLog Application -ComputerName $Server |
    Select-Object LogMode, MaximumSizeInBytes, RecordCount, LogName,
      @{name='ComputerName'; expression={$Server}} |
    Format-Table -AutoSize
}
```

```Output
 LogMode MaximumSizeInBytes RecordCount LogName     ComputerName
 ------- ------------------ ----------- -------     ------------
Circular           15532032       14577 Application Server01
Circular           15532032        9689 Application Server02
Circular           15532032        5309 Application Server03
```

<span data-ttu-id="ad296-155">變數會 `$S` 將名稱儲存為三部伺服器： **Server01** 、 **Server02** 和 **Server03** 。</span><span class="sxs-lookup"><span data-stu-id="ad296-155">The variable `$S` stores the names three servers: **Server01** , **Server02** , and **Server03** .</span></span> <span data-ttu-id="ad296-156">**ForEach** 語句會使用迴圈來處理每一部伺服器 `($Server in $S)` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-156">The **ForEach** statement uses a loop to process each server, `($Server in $S)`.</span></span> <span data-ttu-id="ad296-157">大括弧 (中的腳本區塊會 `{ }`) 執行此 `Get-WinEvent` 命令。</span><span class="sxs-lookup"><span data-stu-id="ad296-157">The script block in the curly braces (`{ }`) runs the `Get-WinEvent` command.</span></span> <span data-ttu-id="ad296-158">**ListLog** 參數會指定 **應用程式** 記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-158">The **ListLog** parameter specifies the **Application** log.</span></span> <span data-ttu-id="ad296-159">**ComputerName** 參數會使用變數 `$Server` 來取得每部伺服器的記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-159">The **ComputerName** parameter uses the variable `$Server` to get log information from each server.</span></span>

<span data-ttu-id="ad296-160">這些物件會向下傳送至 `Select-Object` Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-160">The objects are sent down the pipeline to the `Select-Object` cmdlet.</span></span> <span data-ttu-id="ad296-161">`Select-Object` 取得屬性 **LogMode** 、 **MaximumSizeInBytes** 、 **RecordCount** 、 **LogName** ，並使用匯出運算式來顯示使用變數的 **ComputerName** `$Server` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-161">`Select-Object` gets the properties **LogMode** , **MaximumSizeInBytes** , **RecordCount** , **LogName** , and uses a calculated expression to display the **ComputerName** using the `$Server` variable.</span></span> <span data-ttu-id="ad296-162">這些物件會向下傳送至 Cmdlet， `Format-Table` 以在 PowerShell 主控台中顯示輸出。</span><span class="sxs-lookup"><span data-stu-id="ad296-162">The objects are sent down the pipeline to the `Format-Table` cmdlet to display the output in the PowerShell console.</span></span> <span data-ttu-id="ad296-163">**AutoSize** 參數會將輸出格式化為符合畫面。</span><span class="sxs-lookup"><span data-stu-id="ad296-163">The **AutoSize** parameter formats the output to fit the screen.</span></span>

### <span data-ttu-id="ad296-164">範例5：取得事件記錄檔提供者和記錄檔名稱</span><span class="sxs-lookup"><span data-stu-id="ad296-164">Example 5: Get event log providers and log names</span></span>

<span data-ttu-id="ad296-165">此命令會取得事件記錄檔提供者以及它們所寫入的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-165">This command gets the event log providers and the logs to which they write.</span></span>

```powershell
Get-WinEvent -ListProvider *
```

```Output
Name     : .NET Runtime
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}

Name     : .NET Runtime Optimization Service
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}
```

<span data-ttu-id="ad296-166">`Get-WinEvent`Cmdlet 會從電腦取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-166">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="ad296-167">**ListProvider** 參數會使用星號 (`*`) 萬用字元來顯示每個提供者的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-167">The **ListProvider** parameter uses the asterisk (`*`) wildcard to display information about each provider.</span></span> <span data-ttu-id="ad296-168">在輸出中， **名稱** 是提供者，而 **LogLinks** 是提供者寫入的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-168">In the output, the **Name** is the provider and **LogLinks** is the log that the provider writes to.</span></span>

### <span data-ttu-id="ad296-169">範例6：取得寫入特定記錄檔的所有事件記錄提供者</span><span class="sxs-lookup"><span data-stu-id="ad296-169">Example 6: Get all event log providers that write to a specific log</span></span>

<span data-ttu-id="ad296-170">此命令會取得寫入 **應用程式** 記錄檔的所有提供者。</span><span class="sxs-lookup"><span data-stu-id="ad296-170">This command gets all of the providers that write to the **Application** log.</span></span>

```powershell
(Get-WinEvent -ListLog Application).ProviderNames
```

```Output
.NET Runtime
.NET Runtime Optimization Service
Application
Application Error
Application Hang
Application Management
```

<span data-ttu-id="ad296-171">`Get-WinEvent`Cmdlet 會從電腦取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-171">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="ad296-172">**ListLog** 參數會使用 **應用程式** 取得該記錄檔的物件。</span><span class="sxs-lookup"><span data-stu-id="ad296-172">The **ListLog** parameter uses **Application** to get objects for that log.</span></span> <span data-ttu-id="ad296-173">**ProviderNames** 是物件的屬性，會顯示寫入 **應用程式** 記錄檔的提供者。</span><span class="sxs-lookup"><span data-stu-id="ad296-173">**ProviderNames** is a property of the object and displays the providers that write to the **Application** log.</span></span>

### <span data-ttu-id="ad296-174">範例7：取得包含特定字串的事件記錄檔提供者名稱</span><span class="sxs-lookup"><span data-stu-id="ad296-174">Example 7: Get event log provider names that contain a specific string</span></span>

<span data-ttu-id="ad296-175">此命令會取得名稱中包含特定字串的事件記錄檔提供者名稱。</span><span class="sxs-lookup"><span data-stu-id="ad296-175">This command gets the event log providers with names that include a specific string in the provider's name.</span></span>

```powershell
Get-WinEvent -ListProvider *Policy*
```

```Output
Name     : Group Policy Applications
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}

Name     : Group Policy Client
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}

Name     : Group Policy Data Sources
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}
```

<span data-ttu-id="ad296-176">`Get-WinEvent`Cmdlet 會從電腦取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-176">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="ad296-177">**ListProvider** 參數會使用星號 (`*`) 萬用字元來尋找提供者名稱內任何位置的 **原則** 。</span><span class="sxs-lookup"><span data-stu-id="ad296-177">The **ListProvider** parameter uses the asterisk (`*`) wildcard to find **Policy** anywhere within the provider's name.</span></span>

### <span data-ttu-id="ad296-178">範例8：取得事件提供者所產生的事件識別碼</span><span class="sxs-lookup"><span data-stu-id="ad296-178">Example 8: Get Event Ids that the event provider generates</span></span>

<span data-ttu-id="ad296-179">此命令會列出 **Microsoft Windows GroupPolicy** 事件提供者所產生的事件識別碼以及事件描述。</span><span class="sxs-lookup"><span data-stu-id="ad296-179">This command lists the Event Ids that the **Microsoft-Windows-GroupPolicy** event provider generates along with the event description.</span></span>

```powershell
(Get-WinEvent -ListProvider Microsoft-Windows-GroupPolicy).Events | Format-Table Id, Description
```

```Output
  Id  Description
  --  -----------
1500  The Group Policy settings for the computer were processed successfully...
1501  The Group Policy settings for the user were processed successfully...
4115  Group Policy Service started.
4116  Started the Group Policy service initialization phase.
4117  Group Policy Session started.
```

<span data-ttu-id="ad296-180">`Get-WinEvent`Cmdlet 會從電腦取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-180">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="ad296-181">**ListProvider** 參數會指定提供者 **GroupPolicy** 。</span><span class="sxs-lookup"><span data-stu-id="ad296-181">The **ListProvider** parameter specifies the provider, **Microsoft-Windows-GroupPolicy** .</span></span> <span data-ttu-id="ad296-182">運算式會以括弧括住，並使用 **Events** 屬性來取得物件。</span><span class="sxs-lookup"><span data-stu-id="ad296-182">The expression is wrapped in parentheses and uses the **Events** property to get objects.</span></span> <span data-ttu-id="ad296-183">這些物件會向下傳送至 `Format-Table` Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-183">The objects are sent down the pipeline to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="ad296-184">`Format-Table` 顯示事件物件的 **識別碼** 和 **描述** 。</span><span class="sxs-lookup"><span data-stu-id="ad296-184">`Format-Table` displays the **Id** and **Description** of the event objects.</span></span>

### <span data-ttu-id="ad296-185">範例9：從事件物件屬性取得記錄資訊</span><span class="sxs-lookup"><span data-stu-id="ad296-185">Example 9: Get log information from event object properties</span></span>

<span data-ttu-id="ad296-186">這個範例示範如何使用事件物件屬性取得記錄檔內容的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-186">This example shows how to get information about a log's contents using event object properties.</span></span>
<span data-ttu-id="ad296-187">事件物件會儲存在變數中，然後依 **事件識別碼** 和 **層級** 進行分組和計算。</span><span class="sxs-lookup"><span data-stu-id="ad296-187">Event objects are stored in a variable and then grouped and counted by **Event Id** and **Level** .</span></span>

```powershell
$Event = Get-WinEvent -LogName 'Windows PowerShell'
$Event.Count
$Event | Group-Object -Property Id -NoElement | Sort-Object -Property Count -Descending
$Event | Group-Object -Property LevelDisplayName -NoElement
```

```Output
195

Count  Name
-----  ----
  147  600
   22  400
   21  601
    3  403
    2  103

Count  Name
-----  ----
    2  Warning
  193  Information
```

<span data-ttu-id="ad296-188">此 `Get-WinEvent` Cmdlet 會使用 **LogName** 參數來指定 **Windows PowerShell** 事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-188">The `Get-WinEvent` cmdlet uses the **LogName** parameter to specify the **Windows PowerShell** event log.</span></span> <span data-ttu-id="ad296-189">事件物件會儲存在變數中 `$Event` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-189">The event objects are stored in the `$Event` variable.</span></span> <span data-ttu-id="ad296-190">的 [ **計數** ] 屬性會 `$Event` 顯示已記錄的事件總數。</span><span class="sxs-lookup"><span data-stu-id="ad296-190">The **Count** property of `$Event`shows the total number of logged events.</span></span>

<span data-ttu-id="ad296-191">此 `$Event` 變數會向下傳送至 `Group-Object` Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-191">The `$Event` variable is sent down the pipeline to the `Group-Object` cmdlet.</span></span> <span data-ttu-id="ad296-192">`Group-Object` 使用 **Property** 參數指定 **Id** 屬性，並依事件識別碼值來計算物件數目。</span><span class="sxs-lookup"><span data-stu-id="ad296-192">`Group-Object` uses the **Property** parameter to specify the **Id** property and counts the objects by the event Id value.</span></span> <span data-ttu-id="ad296-193">**NoElement** 參數會從物件輸出中移除其他屬性。</span><span class="sxs-lookup"><span data-stu-id="ad296-193">The **NoElement** parameter removes other properties from the objects output.</span></span> <span data-ttu-id="ad296-194">分組的物件會向下傳送至 `Sort-Object` Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-194">The grouped objects are sent down the pipeline to the `Sort-Object` cmdlet.</span></span> <span data-ttu-id="ad296-195">`Sort-Object` 使用 **Property** 參數依 **計數** 排序物件。</span><span class="sxs-lookup"><span data-stu-id="ad296-195">`Sort-Object` uses the **Property** parameter to sort the objects by **Count** .</span></span> <span data-ttu-id="ad296-196">**遞減** 參數會依計數顯示輸出，從最高到最低。</span><span class="sxs-lookup"><span data-stu-id="ad296-196">The **Descending** parameter displays the output by count, from highest to lowest.</span></span> <span data-ttu-id="ad296-197">在輸出中，[ **計數** ] 資料行包含每個事件的總計數。</span><span class="sxs-lookup"><span data-stu-id="ad296-197">In the output, the **Count** column contains the total number of each event.</span></span> <span data-ttu-id="ad296-198">[ **名稱** ] 資料行包含已分組的事件識別碼。</span><span class="sxs-lookup"><span data-stu-id="ad296-198">The **Name** column contains the grouped event Id numbers.</span></span>

<span data-ttu-id="ad296-199">此 `$Event` 變數會向下傳送至 `Group-Object` Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-199">The `$Event` variable is sent down the pipeline to the `Group-Object` cmdlet.</span></span> <span data-ttu-id="ad296-200">`Group-Object` 使用 **Property** 參數指定 **LevelDisplayName** 屬性，並依 **LevelDisplayName** 計算物件數目。</span><span class="sxs-lookup"><span data-stu-id="ad296-200">`Group-Object` uses the **Property** parameter to specify the **LevelDisplayName** property and counts the objects by **LevelDisplayName** .</span></span> <span data-ttu-id="ad296-201">物件是依 **警告** 和 **資訊** 等層級進行分組。</span><span class="sxs-lookup"><span data-stu-id="ad296-201">The objects are grouped by the levels such as **Warning** and **Information** .</span></span>
<span data-ttu-id="ad296-202">**NoElement** 參數會從輸出中移除其他屬性。</span><span class="sxs-lookup"><span data-stu-id="ad296-202">The **NoElement** parameter removes other properties from the output.</span></span> <span data-ttu-id="ad296-203">在輸出中，[ **計數** ] 資料行包含每個事件的總計數。</span><span class="sxs-lookup"><span data-stu-id="ad296-203">In the output, the **Count** column contains the total number of each event.</span></span> <span data-ttu-id="ad296-204">[ **名稱** ] 資料行包含群組的 **LevelDisplayName** 。</span><span class="sxs-lookup"><span data-stu-id="ad296-204">The **Name** column contains the grouped **LevelDisplayName** .</span></span>

### <span data-ttu-id="ad296-205">範例10：取得名稱中有指定字串的錯誤事件</span><span class="sxs-lookup"><span data-stu-id="ad296-205">Example 10: Get error events that have a specified string in their name</span></span>

<span data-ttu-id="ad296-206">這個範例會使用以逗號分隔的記錄檔名稱字串。</span><span class="sxs-lookup"><span data-stu-id="ad296-206">This example uses a comma-separated string of log names.</span></span> <span data-ttu-id="ad296-207">輸出會依層級分組，例如錯誤或警告，以及記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="ad296-207">The output is grouped by the level such as error or warning and the log name.</span></span>

```powershell
Get-WinEvent -LogName *PowerShell*, Microsoft-Windows-Kernel-WHEA* |
  Group-Object -Property LevelDisplayName, LogName -NoElement |
    Format-Table -AutoSize
```

```Output
Count  Name
-----  ----
    1  Error, PowerShellCore/Operational
   26  Information, Microsoft-Windows-Kernel-WHEA/Operational
  488  Information, Microsoft-Windows-PowerShell/Operational
   77  Information, PowerShellCore/Operational
 9835  Information, Windows PowerShell
   19  Verbose, PowerShellCore/Operational
  444  Warning, Microsoft-Windows-PowerShell/Operational
  512  Warning, PowerShellCore/Operational
```

<span data-ttu-id="ad296-208">`Get-WinEvent`Cmdlet 會從電腦取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-208">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="ad296-209">**LogName** 參數會使用以逗號分隔的字串，並以星號 (`*`) 萬用字元來指定記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="ad296-209">The **LogName** parameter uses a comma-separated string with the asterisk (`*`) wildcard to specify the log names.</span></span> <span data-ttu-id="ad296-210">這些物件會向下傳送至 `Group-Object` Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-210">The objects are sent down the pipeline to the `Group-Object` cmdlet.</span></span> <span data-ttu-id="ad296-211">`Group-Object` 使用 **Property** 參數，依 **LevelDisplayName** 和 **LogName** 將物件分組。</span><span class="sxs-lookup"><span data-stu-id="ad296-211">`Group-Object` uses the **Property** parameter to group the objects by **LevelDisplayName** and **LogName** .</span></span> <span data-ttu-id="ad296-212">**NoElement** 參數會從輸出中移除其他屬性。</span><span class="sxs-lookup"><span data-stu-id="ad296-212">The **NoElement** parameter removes other properties from the output.</span></span> <span data-ttu-id="ad296-213">分組的物件會向下傳送至 `Format-Table` Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-213">The grouped objects are sent down the pipeline to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="ad296-214">`Format-Table` 使用 **AutoSize** 參數來格式化資料行。</span><span class="sxs-lookup"><span data-stu-id="ad296-214">`Format-Table` uses the **AutoSize** parameter to format the columns.</span></span> <span data-ttu-id="ad296-215">[ **計數** ] 資料行包含每個事件的總計數。</span><span class="sxs-lookup"><span data-stu-id="ad296-215">The **Count** column contains the total number of each event.</span></span> <span data-ttu-id="ad296-216">[ **名稱** ] 資料行包含已分組的 **LevelDisplayName** 和 **LogName** 。</span><span class="sxs-lookup"><span data-stu-id="ad296-216">The **Name** column contains the grouped **LevelDisplayName** and **LogName** .</span></span>

### <span data-ttu-id="ad296-217">範例11：從封存的事件記錄檔取得事件</span><span class="sxs-lookup"><span data-stu-id="ad296-217">Example 11: Get events from an archived event log</span></span>

<span data-ttu-id="ad296-218">`Get-WinEvent` 可以從已儲存的記錄檔取得事件資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-218">`Get-WinEvent` can get event information from saved log files.</span></span> <span data-ttu-id="ad296-219">此範例會使用儲存在本機電腦上的封存 PowerShell 記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-219">This sample uses an archived PowerShell log that is stored on the local computer.</span></span>

```powershell
Get-WinEvent -Path 'C:\Test\Windows PowerShell.evtx'
```

```Output
   ProviderName: PowerShell

TimeCreated              Id LevelDisplayName  Message
-----------              -- ----------------  -------
3/15/2019 13:54:13      403 Information       Engine state is changed from Available to Stopped...
3/15/2019 13:54:13      400 Information       Engine state is changed from None to Available...
3/15/2019 13:54:13      600 Information       Provider "Variable" is Started...
3/15/2019 13:54:13      600 Information       Provider "Function" is Started...
3/15/2019 13:54:13      600 Information       Provider "FileSystem" is Started...
```

<span data-ttu-id="ad296-220">`Get-WinEvent`Cmdlet 會從電腦取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-220">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="ad296-221">**Path** 參數會指定目錄和檔案名。</span><span class="sxs-lookup"><span data-stu-id="ad296-221">The **Path** parameter specifies the directory and file name.</span></span>

### <span data-ttu-id="ad296-222">範例12：從封存的事件記錄檔中取得特定數目的事件</span><span class="sxs-lookup"><span data-stu-id="ad296-222">Example 12: Get a specific number of events from an archived event log</span></span>

<span data-ttu-id="ad296-223">這些命令會從封存的事件記錄檔取得特定數目的事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-223">These commands get a specific number of events from an archived event log.</span></span> <span data-ttu-id="ad296-224">`Get-WinEvent` 具有可取得事件數目上限或最舊事件的參數。</span><span class="sxs-lookup"><span data-stu-id="ad296-224">`Get-WinEvent` has parameters that can get a maximum number of events or the oldest events.</span></span> <span data-ttu-id="ad296-225">此範例會使用儲存在 **C:\Test\PowerShellCore 操作** 的封存 PowerShell 記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-225">This sample uses an archived PowerShell log that is stored in **C:\Test\PowerShellCore Operational.evtx** .</span></span>

```powershell
Get-WinEvent -Path 'C:\Test\PowerShellCore Operational.evtx' -MaxEvents 100
```

```Output
   ProviderName: PowerShellCore

TimeCreated                 Id   LevelDisplayName  Message
-----------                 --   ----------------  -------
3/15/2019 09:54:54        4104   Warning           Creating Scriptblock text (1 of 1):...
3/15/2019 09:37:13       40962   Information       PowerShell console is ready for user input
3/15/2019 07:56:24        4104   Warning           Creating Scriptblock text (1 of 1):...
...
3/7/2019 10:53:22        40961   Information       PowerShell console is starting up
3/7/2019 10:53:22         8197   Verbose           Runspace state changed to Opening
3/7/2019 10:53:22         8195   Verbose           Opening RunspacePool
```

<span data-ttu-id="ad296-226">`Get-WinEvent`Cmdlet 會從電腦取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-226">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="ad296-227">**Path** 參數指定目錄和檔案名。</span><span class="sxs-lookup"><span data-stu-id="ad296-227">The **Path** parameter specifies the directory and filename.</span></span> <span data-ttu-id="ad296-228">**MaxEvents** 參數會指定顯示100筆記錄，從最新到最舊。</span><span class="sxs-lookup"><span data-stu-id="ad296-228">The **MaxEvents** parameter specifies that 100 records are displayed, from newest to oldest.</span></span>

### <span data-ttu-id="ad296-229">範例13： Windows 的事件追蹤</span><span class="sxs-lookup"><span data-stu-id="ad296-229">Example 13: Event Tracing for Windows</span></span>

<span data-ttu-id="ad296-230">Windows 事件追蹤 (ETW) 在事件發生時將事件寫入記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-230">Event Tracing for Windows (ETW) writes events to the log as events occur.</span></span> <span data-ttu-id="ad296-231">這些事件會以最舊到最新的順序儲存。</span><span class="sxs-lookup"><span data-stu-id="ad296-231">The events are stored in the order of oldest to newest.</span></span> <span data-ttu-id="ad296-232">封存的 ETW 檔案會儲存為 `.etl` **tracelog.exe。**</span><span class="sxs-lookup"><span data-stu-id="ad296-232">An archived ETW file is saved as an `.etl` such as **TraceLog.etl** .</span></span>
<span data-ttu-id="ad296-233">事件會依照寫入記錄檔的順序列出，因此需要 *最舊* 的參數。</span><span class="sxs-lookup"><span data-stu-id="ad296-233">The events are listed in the order in which they are written to the log, so the *Oldest* parameter is required.</span></span>

```powershell
Get-WinEvent -Path 'C:\Tracing\TraceLog.etl' -Oldest |
  Sort-Object -Property TimeCreated -Descending |
    Select-Object -First 100
```

<span data-ttu-id="ad296-234">`Get-WinEvent`Cmdlet 會從封存的檔案取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-234">The `Get-WinEvent` cmdlet gets log information from the archived file.</span></span> <span data-ttu-id="ad296-235">**Path** 參數會指定目錄和檔案名。</span><span class="sxs-lookup"><span data-stu-id="ad296-235">The **Path** parameter specifies the directory and file name.</span></span> <span data-ttu-id="ad296-236">**最舊** 的參數可用來依照寫入順序（最舊到最新）來輸出事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-236">The **Oldest** parameter is used to output events in the order they are written, oldest to newest.</span></span> <span data-ttu-id="ad296-237">物件會向下傳送至 Cmdlet，以 `Sort-Object` `Sort-Object` 依 **TimeCreated** 屬性的值以遞減順序排序物件。</span><span class="sxs-lookup"><span data-stu-id="ad296-237">The objects are sent down the pipeline to the `Sort-Object` cmdlet `Sort-Object` sorts the objects in descending order by the value of the **TimeCreated** property.</span></span> <span data-ttu-id="ad296-238">這些物件會向下傳送至 `Select-Object` Cmdlet，以顯示100最新的事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-238">The objects are sent down the pipeline to the `Select-Object` cmdlet that displays the 100 newest events.</span></span>

### <span data-ttu-id="ad296-239">範例14：從事件追蹤記錄檔取得事件</span><span class="sxs-lookup"><span data-stu-id="ad296-239">Example 14: Get events from an event trace log</span></span>

<span data-ttu-id="ad296-240">這個範例示範如何從事件追蹤記錄檔取得事件 (`.etl`) ，以及 () 的封存 Windows PowerShell 記錄檔 `.evtx` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-240">This example shows how to get the events from an event trace log file (`.etl`) and an archived Windows PowerShell log file (`.evtx`).</span></span> <span data-ttu-id="ad296-241">您可以在單一命令中結合多個檔案類型。</span><span class="sxs-lookup"><span data-stu-id="ad296-241">You can combine multiple file types in a single command.</span></span>
<span data-ttu-id="ad296-242">由於檔案包含相同類型的 **.NET Framework** 物件 **EventLogRecord** ，因此您可以使用相同的屬性來篩選它們。</span><span class="sxs-lookup"><span data-stu-id="ad296-242">Because the files contain the same type of **.NET Framework** object, **EventLogRecord** , you can filter them with the same properties.</span></span> <span data-ttu-id="ad296-243">此命令需要 **最舊** 的參數，因為它是從檔案讀取 `.etl` ，但是 **最舊** 的參數會套用至每個檔案。</span><span class="sxs-lookup"><span data-stu-id="ad296-243">The command requires the **Oldest** parameter because it is reading from an `.etl` file, but the **Oldest** parameter applies to each file.</span></span>

```powershell
Get-WinEvent -Path 'C:\Tracing\TraceLog.etl', 'C:\Test\Windows PowerShell.evtx' -Oldest |
  Where-Object { $_.Id -eq '403' }
```

<span data-ttu-id="ad296-244">`Get-WinEvent`Cmdlet 會從封存的檔案取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-244">The `Get-WinEvent` cmdlet gets log information from the archived files.</span></span> <span data-ttu-id="ad296-245">**Path** 參數會使用以逗號分隔的清單來指定每個檔案目錄和檔案名。</span><span class="sxs-lookup"><span data-stu-id="ad296-245">The **Path** parameter uses a comma-separated list to specify each files directory and file name.</span></span> <span data-ttu-id="ad296-246">**最舊** 的參數可用來依照寫入順序（最舊到最新）來輸出事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-246">The **Oldest** parameter is used to output events in the order they are written, oldest to newest.</span></span> <span data-ttu-id="ad296-247">這些物件會向下傳送至 `Where-Object` Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-247">The objects are sent down the pipeline to the `Where-Object` cmdlet.</span></span> <span data-ttu-id="ad296-248">`Where-Object` 使用腳本區塊來尋找 **識別碼** 為 **403** 的事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-248">`Where-Object` uses a script block to find events with and **Id** of **403** .</span></span> <span data-ttu-id="ad296-249">`$_`變數代表管線中目前的物件，而 **識別碼** 是事件識別碼屬性。</span><span class="sxs-lookup"><span data-stu-id="ad296-249">The `$_` variable represents the current object in the pipeline and **Id** is the Event Id property.</span></span>

### <span data-ttu-id="ad296-250">範例15：篩選事件記錄檔結果</span><span class="sxs-lookup"><span data-stu-id="ad296-250">Example 15: Filter event log results</span></span>

<span data-ttu-id="ad296-251">此範例顯示各種不同的方法，可篩選並從事件記錄檔中選取事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-251">This example shows a variety of methods to filter and select events from an event log.</span></span> <span data-ttu-id="ad296-252">所有這些命令都會從 **Windows PowerShell** 事件記錄檔取得過去24小時內發生的事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-252">All of these commands get events that occurred in the last 24-hours from the **Windows PowerShell** event log.</span></span>
<span data-ttu-id="ad296-253">篩選方法比使用 Cmdlet 更有效率 `Where-Object` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-253">The filter methods are more efficient than using the `Where-Object` cmdlet.</span></span> <span data-ttu-id="ad296-254">篩選準則會在抓取物件時套用。</span><span class="sxs-lookup"><span data-stu-id="ad296-254">Filters are applied as the objects are retrieved.</span></span> <span data-ttu-id="ad296-255">`Where-Object` 抓取所有物件，然後將篩選套用至所有物件。</span><span class="sxs-lookup"><span data-stu-id="ad296-255">`Where-Object` retrieves all of the objects, then applies filters to all of the objects.</span></span>

```powershell
# Using the Where-Object cmdlet:
$Yesterday = (Get-Date) - (New-TimeSpan -Day 1)
Get-WinEvent -LogName 'Windows PowerShell' | Where-Object { $_.TimeCreated -ge $Yesterday }

# Using the FilterHashtable parameter:
$Yesterday = (Get-Date) - (New-TimeSpan -Day 1)
Get-WinEvent -FilterHashtable @{ LogName='Windows PowerShell'; Level=3; StartTime=$Yesterday }

# Using the FilterXML parameter:
$xmlQuery = @'
<QueryList>
  <Query Id="0" Path="Windows PowerShell">
    <Select Path="System">*[System[(Level=3) and
        TimeCreated[timediff(@SystemTime) &lt;= 86400000]]]</Select>
  </Query>
</QueryList>
'@
Get-WinEvent -FilterXML $xmlQuery

# Using the FilterXPath parameter:
$XPath = '*[System[Level=3 and TimeCreated[timediff(@SystemTime) &lt;= 86400000]]]'
Get-WinEvent -LogName 'Windows PowerShell' -FilterXPath $XPath
```

### <span data-ttu-id="ad296-256">範例16：使用 FilterHashtable 從應用程式記錄檔取得事件</span><span class="sxs-lookup"><span data-stu-id="ad296-256">Example 16: Use FilterHashtable to get events from the Application log</span></span>

<span data-ttu-id="ad296-257">此範例使用 **FilterHashtable** 參數從 **應用程式** 記錄檔取得事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-257">This example uses the **FilterHashtable** parameter to get events from the **Application** log.</span></span> <span data-ttu-id="ad296-258">雜湊表使用索引 **鍵/值** 組。</span><span class="sxs-lookup"><span data-stu-id="ad296-258">The hash table uses **key/value** pairs.</span></span> <span data-ttu-id="ad296-259">如需 **FilterHashtable** 參數的詳細資訊，請參閱 [使用 FilterHashtable 建立 Get-WinEvent 查詢](/powershell/scripting/samples/Creating-Get-WinEvent-queries-with-FilterHashtable)。</span><span class="sxs-lookup"><span data-stu-id="ad296-259">For more information about the **FilterHashtable** parameter, see [Creating Get-WinEvent queries with FilterHashtable](/powershell/scripting/samples/Creating-Get-WinEvent-queries-with-FilterHashtable).</span></span>
<span data-ttu-id="ad296-260">如需雜湊表的相關詳細資訊，請參閱 [about_Hash_Tables](../Microsoft.PowerShell.Core/about/about_hash_tables.md)。</span><span class="sxs-lookup"><span data-stu-id="ad296-260">For more information about hash tables, see [about_Hash_Tables](../Microsoft.PowerShell.Core/about/about_hash_tables.md).</span></span>

```powershell
$Date = (Get-Date).AddDays(-2)
Get-WinEvent -FilterHashtable @{ LogName='Application'; StartTime=$Date; Id='1003' }
```

<span data-ttu-id="ad296-261">此 `Get-Date` Cmdlet 會使用 **AddDays** 方法來取得目前日期前兩天的日期。</span><span class="sxs-lookup"><span data-stu-id="ad296-261">The `Get-Date` cmdlet uses the **AddDays** method to get a date that is two days before the current date.</span></span> <span data-ttu-id="ad296-262">Date 物件儲存在 `$Date` 變數中。</span><span class="sxs-lookup"><span data-stu-id="ad296-262">The date object is stored in the `$Date` variable.</span></span>

<span data-ttu-id="ad296-263">`Get-WinEvent`Cmdlet 會取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-263">The `Get-WinEvent` cmdlet gets log information.</span></span> <span data-ttu-id="ad296-264">**FilterHashtable** 參數是用來篩選輸出。</span><span class="sxs-lookup"><span data-stu-id="ad296-264">The **FilterHashtable** parameter is used to filter the output.</span></span> <span data-ttu-id="ad296-265">**LogName** 索引鍵會將值指定為 **應用程式** 記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-265">The **LogName** key specifies the value as the **Application** log.</span></span> <span data-ttu-id="ad296-266">**StartTime** 索引鍵會使用儲存在變數中的值 `$Date` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-266">The **StartTime** key uses the value stored in the `$Date` variable.</span></span> <span data-ttu-id="ad296-267">**識別碼** 索引鍵會使用事件識別碼值 **1003** 。</span><span class="sxs-lookup"><span data-stu-id="ad296-267">The **Id** key uses an Event Id value, **1003** .</span></span>

### <span data-ttu-id="ad296-268">範例17：使用 FilterHashtable 取得應用程式錯誤</span><span class="sxs-lookup"><span data-stu-id="ad296-268">Example 17: Use FilterHashtable to get application errors</span></span>

<span data-ttu-id="ad296-269">此範例會使用 **FilterHashtable** 參數，找出在上周發生 Internet Explorer 應用程式錯誤。</span><span class="sxs-lookup"><span data-stu-id="ad296-269">This example uses the **FilterHashtable** parameter to find Internet Explorer application errors that occurred within the last week.</span></span>

```powershell
$StartTime = (Get-Date).AddDays(-7)
Get-WinEvent -FilterHashtable @{
  Logname='Application'
  ProviderName='Application Error'
  Data='iexplore.exe'
  StartTime=$StartTime
}
```

<span data-ttu-id="ad296-270">此 `Get-Date` Cmdlet 會使用 **AddDays** 方法來取得目前日期前七天的日期。</span><span class="sxs-lookup"><span data-stu-id="ad296-270">The `Get-Date` cmdlet uses the **AddDays** method to get a date that is seven days before the current date.</span></span> <span data-ttu-id="ad296-271">Date 物件儲存在 `$StartTime` 變數中。</span><span class="sxs-lookup"><span data-stu-id="ad296-271">The date object is stored in the `$StartTime` variable.</span></span>

<span data-ttu-id="ad296-272">`Get-WinEvent`Cmdlet 會取得記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ad296-272">The `Get-WinEvent` cmdlet gets log information.</span></span> <span data-ttu-id="ad296-273">**FilterHashtable** 參數是用來篩選輸出。</span><span class="sxs-lookup"><span data-stu-id="ad296-273">The **FilterHashtable** parameter is used to filter the output.</span></span> <span data-ttu-id="ad296-274">**LogName** 索引鍵會將值指定為 **應用程式** 記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-274">The **LogName** key specifies the value as the **Application** log.</span></span> <span data-ttu-id="ad296-275">**ProviderName** 索引鍵會使用值，也就是 **應用程式錯誤** ，也就是事件的 **來源** 。</span><span class="sxs-lookup"><span data-stu-id="ad296-275">The **ProviderName** key uses the value, **Application Error** , which is the event's **Source** .</span></span> <span data-ttu-id="ad296-276">**資料** 索引鍵會使用值 **iexplore.exe** **StartTime** 索引鍵使用儲存在變數中的值 `$StartTime` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-276">The **Data** key uses the value **iexplore.exe** The **StartTime** key uses the value stored in `$StartTime` variable.</span></span>

### <span data-ttu-id="ad296-277">範例18：使用 SuppressHashFilter 來篩選應用程式錯誤</span><span class="sxs-lookup"><span data-stu-id="ad296-277">Example 18: Use SuppressHashFilter to filter application errors</span></span>

<span data-ttu-id="ad296-278">如同上述的範例16，此範例使用 **FilterHashtable** 參數從 **應用程式** 記錄檔取得事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-278">Like Example 16 above, this example uses the **FilterHashtable** parameter to get events from the **Application** log.</span></span> <span data-ttu-id="ad296-279">不過，我們會加入 **SuppressHashFilter** 索引鍵，以篩選出 **資訊** 層級事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-279">However, we add the **SuppressHashFilter** key to filter out **Information** level events.</span></span>

```powershell
$Date = (Get-Date).AddDays(-2)
$filter = @{
  LogName='Application'
  StartTime=$Date
  SuppressHashFilter=@{Level=4}
}
Get-WinEvent -FilterHashtable $filter
```

<span data-ttu-id="ad296-280">在此範例中， `Get-WinEvent` 會取得過去兩天內 **應用程式** 記錄檔中的所有事件，但其 **層級** 為 4 (資訊) 。</span><span class="sxs-lookup"><span data-stu-id="ad296-280">In this example, `Get-WinEvent` gets all events from the **Application** log for the last two days except those that have a **Level** of 4 (Information).</span></span>

## <span data-ttu-id="ad296-281">PARAMETERS</span><span class="sxs-lookup"><span data-stu-id="ad296-281">PARAMETERS</span></span>

### <span data-ttu-id="ad296-282">-ComputerName</span><span class="sxs-lookup"><span data-stu-id="ad296-282">-ComputerName</span></span>

<span data-ttu-id="ad296-283">指定此 Cmdlet 從事件記錄檔取得事件的電腦名稱稱。</span><span class="sxs-lookup"><span data-stu-id="ad296-283">Specifies the name of the computer that this cmdlet gets events from the event logs.</span></span> <span data-ttu-id="ad296-284">輸入電腦的 NetBIOS 名稱、IP 位址或完整功能變數名稱 (FQDN) 。</span><span class="sxs-lookup"><span data-stu-id="ad296-284">Type the NetBIOS name, an IP address, or the fully qualified domain name (FQDN) of the computer.</span></span> <span data-ttu-id="ad296-285">預設值為本機電腦 **localhost** 。</span><span class="sxs-lookup"><span data-stu-id="ad296-285">The default value is the local computer, **localhost** .</span></span> <span data-ttu-id="ad296-286">此參數一次只能接受一個電腦名稱。</span><span class="sxs-lookup"><span data-stu-id="ad296-286">This parameter accepts only one computer name at a time.</span></span>

<span data-ttu-id="ad296-287">若要從遠端電腦取得事件記錄檔，請將事件記錄檔服務的防火牆埠設定為允許遠端存取。</span><span class="sxs-lookup"><span data-stu-id="ad296-287">To get event logs from remote computers, configure the firewall port for the event log service to allow remote access.</span></span>

<span data-ttu-id="ad296-288">此 Cmdlet 不依賴 PowerShell 遠端功能。</span><span class="sxs-lookup"><span data-stu-id="ad296-288">This cmdlet does not rely on PowerShell remoting.</span></span> <span data-ttu-id="ad296-289">即使您的電腦未設定為執行遠端命令，您仍然可以使用 **ComputerName** 參數。</span><span class="sxs-lookup"><span data-stu-id="ad296-289">You can use the **ComputerName** parameter even if your computer is not configured to run remote commands.</span></span>

```yaml
Type: System.String
Parameter Sets: GetLogSet, ListLogSet, ListProviderSet, GetProviderSet, HashQuerySet, XmlQuerySet
Aliases: Cn

Required: False
Position: Named
Default value: Local computer
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="ad296-290">-Credential</span><span class="sxs-lookup"><span data-stu-id="ad296-290">-Credential</span></span>

<span data-ttu-id="ad296-291">指定具有執行此動作權限的使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="ad296-291">Specifies a user account that has permission to perform this action.</span></span> <span data-ttu-id="ad296-292">預設值為目前使用者。</span><span class="sxs-lookup"><span data-stu-id="ad296-292">The default value is the current user.</span></span>

<span data-ttu-id="ad296-293">輸入使用者名稱，例如 **User01** 或 **Domain01\User01** 。</span><span class="sxs-lookup"><span data-stu-id="ad296-293">Type a user name, such as **User01** or **Domain01\User01** .</span></span> <span data-ttu-id="ad296-294">或者，輸入 **PSCredential** 物件，例如 Cmdlet 所產生的物件 `Get-Credential` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-294">Or, enter a **PSCredential** object, such as one generated by the `Get-Credential` cmdlet.</span></span> <span data-ttu-id="ad296-295">若您輸入使用者名稱時，會提示您輸入密碼。</span><span class="sxs-lookup"><span data-stu-id="ad296-295">If you type a user name, you are prompted for a password.</span></span> <span data-ttu-id="ad296-296">如果您只輸入參數名稱，系統會提示您輸入使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="ad296-296">If you type only the parameter name, you are prompted for both a username and a password.</span></span>

```yaml
Type: System.Management.Automation.PSCredential
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: Current user
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="ad296-297">-FilterHashtable</span><span class="sxs-lookup"><span data-stu-id="ad296-297">-FilterHashtable</span></span>

<span data-ttu-id="ad296-298">指定雜湊資料表格式的查詢，以從一或多個事件記錄檔選取事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-298">Specifies a query in hash table format to select events from one or more event logs.</span></span> <span data-ttu-id="ad296-299">查詢包含具有一或多個索引 **鍵/值** 組的雜湊表。</span><span class="sxs-lookup"><span data-stu-id="ad296-299">The query contains a hash table with one or more **key/value** pairs.</span></span>

<span data-ttu-id="ad296-300">雜湊資料表查詢有下列規則：</span><span class="sxs-lookup"><span data-stu-id="ad296-300">Hash table queries have the following rules:</span></span>

- <span data-ttu-id="ad296-301">索引鍵和值不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="ad296-301">Keys and values are case-insensitive.</span></span>
- <span data-ttu-id="ad296-302">萬用字元只有在與 **LogName** 和 **ProviderName** 索引鍵相關聯的值中才有效。</span><span class="sxs-lookup"><span data-stu-id="ad296-302">Wildcard characters are valid only in the values associated with the **LogName** and **ProviderName** keys.</span></span>
- <span data-ttu-id="ad296-303">每個索引鍵只能在每個雜湊表中列出一次。</span><span class="sxs-lookup"><span data-stu-id="ad296-303">Each key can be listed only once in each hash table.</span></span>
- <span data-ttu-id="ad296-304">**路徑** 值會取得 `.etl` 、 `.evt` 和記錄檔的路徑 `.evtx` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-304">The **Path** value takes paths to `.etl`, `.evt`, and `.evtx` log files.</span></span>
- <span data-ttu-id="ad296-305">**LogName** 、 **Path** 和 **ProviderName** 索引鍵可以在相同的查詢中使用。</span><span class="sxs-lookup"><span data-stu-id="ad296-305">The **LogName** , **Path** , and **ProviderName** keys can be used in the same query.</span></span>
- <span data-ttu-id="ad296-306">**UserID** 金鑰可以取得有效的安全識別碼 (SID) 或可用來建立有效 **NTAccount 物件** 的網域帳戶名稱。</span><span class="sxs-lookup"><span data-stu-id="ad296-306">The **UserID** key can take a valid security identifier (SID) or a domain account name that can be used to construct a valid **System.Security.Principal.NTAccount object** .</span></span>
- <span data-ttu-id="ad296-307">**資料** 值會接受未命名欄位中的事件資料。</span><span class="sxs-lookup"><span data-stu-id="ad296-307">The **Data** value takes event data in an unnamed field.</span></span> <span data-ttu-id="ad296-308">例如，傳統事件記錄檔中的事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-308">For example, events in classic event logs.</span></span>
- <span data-ttu-id="ad296-309">`<named-data>` 索引鍵代表已命名的事件資料欄位。</span><span class="sxs-lookup"><span data-stu-id="ad296-309">`<named-data>` key represents a named event data field.</span></span>

<span data-ttu-id="ad296-310">當 `Get-WinEvent` 無法解讀索引 **鍵/值** 組時，它會針對事件中的事件資料，將索引鍵解釋為區分大小寫的名稱。</span><span class="sxs-lookup"><span data-stu-id="ad296-310">When `Get-WinEvent` cannot interpret a **key/value** pair, it interprets the key as a case-sensitive name for the event data in the event.</span></span>

<span data-ttu-id="ad296-311">有效的索引 `Get-WinEvent` **鍵/值** 組如下所示：</span><span class="sxs-lookup"><span data-stu-id="ad296-311">The valid `Get-WinEvent` **key/value** pairs are as follows:</span></span>

- <span data-ttu-id="ad296-312">**LogName**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="ad296-312">**LogName**=`<String[]>`</span></span>
- <span data-ttu-id="ad296-313">**ProviderName**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="ad296-313">**ProviderName**=`<String[]>`</span></span>
- <span data-ttu-id="ad296-314">**路徑**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="ad296-314">**Path**=`<String[]>`</span></span>
- <span data-ttu-id="ad296-315">**關鍵 字**=`<Long[]>`</span><span class="sxs-lookup"><span data-stu-id="ad296-315">**Keywords**=`<Long[]>`</span></span>
- <span data-ttu-id="ad296-316">**Id**=`<Int32[]>`</span><span class="sxs-lookup"><span data-stu-id="ad296-316">**ID**=`<Int32[]>`</span></span>
- <span data-ttu-id="ad296-317">**水準**=`<Int32[]>`</span><span class="sxs-lookup"><span data-stu-id="ad296-317">**Level**=`<Int32[]>`</span></span>
- <span data-ttu-id="ad296-318">**StartTime**=`<DateTime>`</span><span class="sxs-lookup"><span data-stu-id="ad296-318">**StartTime**=`<DateTime>`</span></span>
- <span data-ttu-id="ad296-319">**EndTime**=`<DateTime>`</span><span class="sxs-lookup"><span data-stu-id="ad296-319">**EndTime**=`<DateTime>`</span></span>
- <span data-ttu-id="ad296-320">**UserID**=`<SID>`</span><span class="sxs-lookup"><span data-stu-id="ad296-320">**UserID**=`<SID>`</span></span>
- <span data-ttu-id="ad296-321">**資料**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="ad296-321">**Data**=`<String[]>`</span></span>
- `<named-data>`=`<String[]>`
- <span data-ttu-id="ad296-322">**SuppressHashFilter**=`<Hashtable>`</span><span class="sxs-lookup"><span data-stu-id="ad296-322">**SuppressHashFilter**=`<Hashtable>`</span></span>

```yaml
Type: System.Collections.Hashtable[]
Parameter Sets: HashQuerySet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="ad296-323">-FilterXml</span><span class="sxs-lookup"><span data-stu-id="ad296-323">-FilterXml</span></span>

<span data-ttu-id="ad296-324">指定結構化 XML 查詢，此 Cmdlet 會從一或多個事件記錄檔中選取事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-324">Specifies a structured XML query that this cmdlet selects events from one or more event logs.</span></span>

<span data-ttu-id="ad296-325">若要產生有效的 XML 查詢，請使用 Windows 事件檢視器中的 [ **建立自訂視圖** ] 和 [ **篩選目前的記錄** ] 功能。</span><span class="sxs-lookup"><span data-stu-id="ad296-325">To generate a valid XML query, use the **Create Custom View** and **Filter Current Log** features in Windows Event Viewer.</span></span> <span data-ttu-id="ad296-326">使用對話方塊中的項目建立查詢，然後按一下 XML 索引標籤來使用 XML 格式檢視查詢。</span><span class="sxs-lookup"><span data-stu-id="ad296-326">Use the items in the dialog box to create a query, and then click the XML tab to view the query in XML format.</span></span> <span data-ttu-id="ad296-327">您也可以從 XML 索引標籤將 XML 複製到 **FilterXml** 參數的值。</span><span class="sxs-lookup"><span data-stu-id="ad296-327">You can copy the XML from the XML tab into the value of the **FilterXml** parameter.</span></span> <span data-ttu-id="ad296-328">如需事件檢視器功能的詳細資訊，請參閱事件檢視器說明。</span><span class="sxs-lookup"><span data-stu-id="ad296-328">For more information about the Event Viewer features, see Event Viewer Help.</span></span>

<span data-ttu-id="ad296-329">您可以使用 XML 查詢來建立包含數個 XPath 語句的複雜查詢。</span><span class="sxs-lookup"><span data-stu-id="ad296-329">Use an XML query to create a complex query that contains several XPath statements.</span></span> <span data-ttu-id="ad296-330">XML 格式也可讓您使用 **抑制 XML** 專案，該專案會從查詢中排除事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-330">The XML format also allows you to use a **Suppress XML** element that excludes events from the query.</span></span> <span data-ttu-id="ad296-331">如需事件記錄檔查詢之 XML 架構的詳細資訊，請參閱[事件選取範圍](/previous-versions/aa385231(v=vs.85))的[查詢架構](/windows/win32/wes/queryschema-schema)和 xml 事件查詢一節。</span><span class="sxs-lookup"><span data-stu-id="ad296-331">For more information about the XML schema for event log queries, see [Query Schema](/windows/win32/wes/queryschema-schema) and the XML Event Queries section of [Event Selection](/previous-versions/aa385231(v=vs.85)).</span></span>

<span data-ttu-id="ad296-332">您也可以使用 **FilterHashtable** 參數建立 **隱藏** 元素。</span><span class="sxs-lookup"><span data-stu-id="ad296-332">You may also create a **Suppress** element using the **FilterHashtable** parameter.</span></span>

```yaml
Type: System.Xml.XmlDocument
Parameter Sets: XmlQuerySet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="ad296-333">-FilterXPath</span><span class="sxs-lookup"><span data-stu-id="ad296-333">-FilterXPath</span></span>

<span data-ttu-id="ad296-334">指定此 Cmdlet 從一個或多個記錄檔中選取事件的 XPath 查詢。</span><span class="sxs-lookup"><span data-stu-id="ad296-334">Specifies an XPath query that this cmdlet select events from one or more logs.</span></span>

<span data-ttu-id="ad296-335">如需有關 XPath 語言的詳細資訊，請參閱[事件選取專案](/previous-versions/aa385231(v=vs.85))的 [ [xpath 參考](/previous-versions/dotnet/netframework-4.0/ms256115(v=vs.100))] 和 [選取篩選] 區段。</span><span class="sxs-lookup"><span data-stu-id="ad296-335">For more information about the XPath language, see [XPath Reference](/previous-versions/dotnet/netframework-4.0/ms256115(v=vs.100)) and the Selection Filters section of [Event Selection](/previous-versions/aa385231(v=vs.85)).</span></span>

```yaml
Type: System.String
Parameter Sets: GetLogSet, GetProviderSet, FileSet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="ad296-336">-Force</span><span class="sxs-lookup"><span data-stu-id="ad296-336">-Force</span></span>

<span data-ttu-id="ad296-337">除了其他事件記錄檔之外，也會取得偵錯和分析記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-337">Gets debug and analytic logs, in addition to other event logs.</span></span> <span data-ttu-id="ad296-338">當名稱參數的值包括萬用字元時， **Force** 參數為取得偵錯或分析記錄檔的必要參數。</span><span class="sxs-lookup"><span data-stu-id="ad296-338">The **Force** parameter is required to get a debug or analytic log when the value of the name parameter includes wildcard characters.</span></span>

<span data-ttu-id="ad296-339">依預設，此 `Get-WinEvent` Cmdlet 會排除這些記錄檔，除非您指定 debug 或 analytics 記錄檔的完整名稱。</span><span class="sxs-lookup"><span data-stu-id="ad296-339">By default, the `Get-WinEvent` cmdlet excludes these logs unless you specify the full name of a debug or analytic log.</span></span>

```yaml
Type: System.Management.Automation.SwitchParameter
Parameter Sets: GetLogSet, ListLogSet, GetProviderSet, HashQuerySet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="ad296-340">-ListLog</span><span class="sxs-lookup"><span data-stu-id="ad296-340">-ListLog</span></span>

<span data-ttu-id="ad296-341">指定事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-341">Specifies the event logs.</span></span> <span data-ttu-id="ad296-342">以逗號分隔的清單方式輸入事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="ad296-342">Enter the event log names in a comma-separated list.</span></span> <span data-ttu-id="ad296-343">允許使用萬用字元。</span><span class="sxs-lookup"><span data-stu-id="ad296-343">Wildcards are permitted.</span></span> <span data-ttu-id="ad296-344">若要取得所有記錄檔，請使用星號 (`*`) 萬用字元。</span><span class="sxs-lookup"><span data-stu-id="ad296-344">To get all the logs, use the asterisk (`*`) wildcard.</span></span>

```yaml
Type: System.String[]
Parameter Sets: ListLogSet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: True
```

### <span data-ttu-id="ad296-345">-ListProvider</span><span class="sxs-lookup"><span data-stu-id="ad296-345">-ListProvider</span></span>

<span data-ttu-id="ad296-346">指定此 Cmdlet 取得的事件記錄檔提供者。</span><span class="sxs-lookup"><span data-stu-id="ad296-346">Specifies the event log providers that this cmdlet gets.</span></span> <span data-ttu-id="ad296-347">事件記錄檔提供者是將事件寫入事件記錄檔的程式或服務。</span><span class="sxs-lookup"><span data-stu-id="ad296-347">An event log provider is a program or service that writes events to the event log.</span></span>

<span data-ttu-id="ad296-348">以逗號分隔的清單方式輸入提供者名稱。</span><span class="sxs-lookup"><span data-stu-id="ad296-348">Enter the provider names in a comma-separated list.</span></span> <span data-ttu-id="ad296-349">允許使用萬用字元。</span><span class="sxs-lookup"><span data-stu-id="ad296-349">Wildcards are permitted.</span></span> <span data-ttu-id="ad296-350">若要取得電腦上所有事件記錄檔的提供者，請使用星號 (`*`) 萬用字元。</span><span class="sxs-lookup"><span data-stu-id="ad296-350">To get the providers of all the event logs on the computer, use the asterisk (`*`) wildcard.</span></span>

```yaml
Type: System.String[]
Parameter Sets: ListProviderSet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: True
```

### <span data-ttu-id="ad296-351">-LogName</span><span class="sxs-lookup"><span data-stu-id="ad296-351">-LogName</span></span>

<span data-ttu-id="ad296-352">指定此 Cmdlet 從中取得事件的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ad296-352">Specifies the event logs that this cmdlet get events from.</span></span> <span data-ttu-id="ad296-353">以逗號分隔的清單方式輸入事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="ad296-353">Enter the event log names in a comma-separated list.</span></span> <span data-ttu-id="ad296-354">允許使用萬用字元。</span><span class="sxs-lookup"><span data-stu-id="ad296-354">Wildcards are permitted.</span></span> <span data-ttu-id="ad296-355">您也可以透過管線將記錄檔名稱傳送至 `Get-WinEvent` Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-355">You can also pipe log names to the `Get-WinEvent` cmdlet.</span></span>

> [!NOTE]
> <span data-ttu-id="ad296-356">PowerShell 不會限制您可以要求的記錄數量。</span><span class="sxs-lookup"><span data-stu-id="ad296-356">PowerShell does not limit the amount of logs you can request.</span></span> <span data-ttu-id="ad296-357">不過，此 `Get-WinEvent` Cmdlet 會查詢 WINDOWS API，其限制為256。</span><span class="sxs-lookup"><span data-stu-id="ad296-357">However, the `Get-WinEvent` cmdlet queries the Windows API which has a limit of 256.</span></span> <span data-ttu-id="ad296-358">這可能會讓您難以一次篩選所有記錄。</span><span class="sxs-lookup"><span data-stu-id="ad296-358">This can make it difficult to filter through all of your logs at one time.</span></span> <span data-ttu-id="ad296-359">若要解決此問題，您可以使用 `foreach` 迴圈逐一查看每個記錄檔，如下所示： `Get-WinEvent -ListLog * | ForEach-Object{ Get-WinEvent -LogName $_.Logname }`</span><span class="sxs-lookup"><span data-stu-id="ad296-359">You can work around this by using a `foreach` loop to iterate through each log like this: `Get-WinEvent -ListLog * | ForEach-Object{ Get-WinEvent -LogName $_.Logname }`</span></span>

```yaml
Type: System.String[]
Parameter Sets: GetLogSet
Aliases:

Required: False
Position: 0
Default value: None
Accept pipeline input: True (ByPropertyName, ByValue)
Accept wildcard characters: True
```

### <span data-ttu-id="ad296-360">-MaxEvents</span><span class="sxs-lookup"><span data-stu-id="ad296-360">-MaxEvents</span></span>

<span data-ttu-id="ad296-361">指定傳回的最大事件數目。</span><span class="sxs-lookup"><span data-stu-id="ad296-361">Specifies the maximum number of events that are returned.</span></span> <span data-ttu-id="ad296-362">輸入整數，例如100。</span><span class="sxs-lookup"><span data-stu-id="ad296-362">Enter an integer such as 100.</span></span> <span data-ttu-id="ad296-363">預設值為傳回記錄檔或檔案中的所有事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-363">The default is to return all the events in the logs or files.</span></span>

```yaml
Type: System.Int64
Parameter Sets: GetLogSet, GetProviderSet, FileSet, HashQuerySet, XmlQuerySet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="ad296-364">-最舊</span><span class="sxs-lookup"><span data-stu-id="ad296-364">-Oldest</span></span>

<span data-ttu-id="ad296-365">指出此 Cmdlet 會以最舊的第一個順序取得事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-365">Indicate that this cmdlet gets the events in oldest-first order.</span></span> <span data-ttu-id="ad296-366">根據預設，事件是最新者先傳回的順序傳回。</span><span class="sxs-lookup"><span data-stu-id="ad296-366">By default, events are returned in newest-first order.</span></span>

<span data-ttu-id="ad296-367">此參數是從 `.etl` 和檔案 `.evt` ，以及從偵測和分析記錄檔取得事件時所需的參數。</span><span class="sxs-lookup"><span data-stu-id="ad296-367">This parameter is required to get events from `.etl` and `.evt` files and from debug and analytic logs.</span></span> <span data-ttu-id="ad296-368">在這些檔案中，事件是以最舊者先記錄的順序記錄，並且只能以最舊者先傳回的順序傳回事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-368">In these files, events are recorded in oldest-first order, and the events can be returned only in oldest-first order.</span></span>

```yaml
Type: System.Management.Automation.SwitchParameter
Parameter Sets: GetLogSet, GetProviderSet, FileSet, HashQuerySet, XmlQuerySet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="ad296-369">-Path</span><span class="sxs-lookup"><span data-stu-id="ad296-369">-Path</span></span>

<span data-ttu-id="ad296-370">指定此 Cmdlet 從中取得事件之事件記錄檔的路徑。</span><span class="sxs-lookup"><span data-stu-id="ad296-370">Specifies the path to the event log files that this cmdlet get events from.</span></span> <span data-ttu-id="ad296-371">在使用逗號分隔的清單中輸入記錄檔路徑，或使用萬用字元來建立檔案路徑模式。</span><span class="sxs-lookup"><span data-stu-id="ad296-371">Enter the paths to the log files in a comma-separated list, or use wildcard characters to create file path patterns.</span></span>

<span data-ttu-id="ad296-372">`Get-WinEvent` 支援具有、和副檔名的檔案 `.evt` `.evtx` `.etl` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-372">`Get-WinEvent` supports files with the `.evt`, `.evtx`, and `.etl` file name extensions.</span></span> <span data-ttu-id="ad296-373">您可以在同一個命令中包含來自不同檔案和檔案類型的事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-373">You can include events from different files and file types in the same command.</span></span>

```yaml
Type: System.String[]
Parameter Sets: FileSet
Aliases: PSPath

Required: True
Position: 0
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: True
```

### <span data-ttu-id="ad296-374">-ProviderName</span><span class="sxs-lookup"><span data-stu-id="ad296-374">-ProviderName</span></span>

<span data-ttu-id="ad296-375">以字串陣列指定此 Cmdlet 從中取得事件的事件記錄檔提供者。</span><span class="sxs-lookup"><span data-stu-id="ad296-375">Specifies, as a string array, the event log providers from which this cmdlet gets events.</span></span> <span data-ttu-id="ad296-376">在使用逗號區隔的清單中輸入提供者名稱，或使用萬用字元來建立提供者名稱模式。</span><span class="sxs-lookup"><span data-stu-id="ad296-376">Enter the provider names in a comma-separated list, or use wildcard characters to create provider name patterns.</span></span>

<span data-ttu-id="ad296-377">事件記錄檔提供者是將事件寫入事件記錄檔的程式或服務。</span><span class="sxs-lookup"><span data-stu-id="ad296-377">An event log provider is a program or service that writes events to the event log.</span></span> <span data-ttu-id="ad296-378">它不是 PowerShell 提供者。</span><span class="sxs-lookup"><span data-stu-id="ad296-378">It is not a PowerShell provider.</span></span>

```yaml
Type: System.String[]
Parameter Sets: GetProviderSet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: True
```

### <span data-ttu-id="ad296-379">CommonParameters</span><span class="sxs-lookup"><span data-stu-id="ad296-379">CommonParameters</span></span>

<span data-ttu-id="ad296-380">這個 Cmdlet 支援一般參數：-Debug、-ErrorAction、-ErrorVariable、-InformationAction、-InformationVariable、-OutVariable、-OutBuffer、-PipelineVariable、-Verbose、-WarningAction 和 -WarningVariable。</span><span class="sxs-lookup"><span data-stu-id="ad296-380">This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable.</span></span> <span data-ttu-id="ad296-381">如需詳細資訊，請參閱 [about_CommonParameters](https://go.microsoft.com/fwlink/?LinkID=113216)。</span><span class="sxs-lookup"><span data-stu-id="ad296-381">For more information, see [about_CommonParameters](https://go.microsoft.com/fwlink/?LinkID=113216).</span></span>

## <span data-ttu-id="ad296-382">輸入</span><span class="sxs-lookup"><span data-stu-id="ad296-382">INPUTS</span></span>

### <span data-ttu-id="ad296-383">System.string、System.Xml.Xml檔、System.object</span><span class="sxs-lookup"><span data-stu-id="ad296-383">System.String, System.Xml.XmlDocument, System.Collections.Hashtable</span></span>

<span data-ttu-id="ad296-384">您可以使用管線將 **LogName** (字串) 、 **FilterXML** 查詢或 **FilterHashtable** 查詢管線至 `Get-WinEvent` 。</span><span class="sxs-lookup"><span data-stu-id="ad296-384">You can pipeline a **LogName** (string), a **FilterXML** query, or a **FilterHashtable** query to `Get-WinEvent`.</span></span>

## <span data-ttu-id="ad296-385">輸出</span><span class="sxs-lookup"><span data-stu-id="ad296-385">OUTPUTS</span></span>

### <span data-ttu-id="ad296-386">System.diagnostics.eventing.reader.eventlogconfiguration，EventLogRecord，，ProviderMetadata 的，中的程式，系統中的</span><span class="sxs-lookup"><span data-stu-id="ad296-386">System.Diagnostics.Eventing.Reader.EventLogConfiguration, System.Diagnostics.Eventing.Reader.EventLogRecord, System.Diagnostics.Eventing.Reader.ProviderMetadata</span></span>

<span data-ttu-id="ad296-387">使用 **ListLog** 參數，會 `Get-WinEvent` 傳回 **system.diagnostics.eventing.reader.eventlogconfiguration** 物件。</span><span class="sxs-lookup"><span data-stu-id="ad296-387">With the **ListLog** parameter, `Get-WinEvent` returns **System.Diagnostics.Eventing.Reader.EventLogConfiguration** objects.</span></span>

<span data-ttu-id="ad296-388">使用 **ListProvider** 參數，會 `Get-WinEvent` 傳回 **ProviderMetadata** 物件。</span><span class="sxs-lookup"><span data-stu-id="ad296-388">With the **ListProvider** parameter, `Get-WinEvent` returns **System.Diagnostics.Eventing.Reader.ProviderMetadata** objects.</span></span>

<span data-ttu-id="ad296-389">使用所有其他參數時，會傳回 `Get-WinEvent` **EventLogRecord** 物件。</span><span class="sxs-lookup"><span data-stu-id="ad296-389">With all other parameters, `Get-WinEvent` returns **System.Diagnostics.Eventing.Reader.EventLogRecord** objects.</span></span>

## <span data-ttu-id="ad296-390">注意</span><span class="sxs-lookup"><span data-stu-id="ad296-390">NOTES</span></span>

<span data-ttu-id="ad296-391">`Get-WinEvent` 的設計目的是要取代執行 `Get-EventLog` Windows Vista 和更新版本之 windows 電腦上的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-391">`Get-WinEvent` is designed to replace the `Get-EventLog` cmdlet on computers running Windows Vista and later versions of Windows.</span></span> <span data-ttu-id="ad296-392">`Get-EventLog` 只取得傳統事件記錄檔中的事件。</span><span class="sxs-lookup"><span data-stu-id="ad296-392">`Get-EventLog` gets events only in classic event logs.</span></span> <span data-ttu-id="ad296-393">`Get-EventLog` 保留以提供回溯相容性。</span><span class="sxs-lookup"><span data-stu-id="ad296-393">`Get-EventLog` is retained for backward compatibility.</span></span>

<span data-ttu-id="ad296-394">`Get-WinEvent` `Get-EventLog` Windows 預先安裝環境 (Windows PE) 不支援和 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ad296-394">The `Get-WinEvent` and `Get-EventLog` cmdlets are not supported in Windows Pre-installation Environment (Windows PE).</span></span>

## <span data-ttu-id="ad296-395">相關連結</span><span class="sxs-lookup"><span data-stu-id="ad296-395">RELATED LINKS</span></span>

[<span data-ttu-id="ad296-396">about_Automatic_Variables</span><span class="sxs-lookup"><span data-stu-id="ad296-396">about_Automatic_Variables</span></span>](../Microsoft.PowerShell.Core/about/about_automatic_variables.md)

[<span data-ttu-id="ad296-397">about_Foreach</span><span class="sxs-lookup"><span data-stu-id="ad296-397">about_Foreach</span></span>](../Microsoft.PowerShell.Core/about/about_Foreach.md)

[<span data-ttu-id="ad296-398">about_Hash_Tables</span><span class="sxs-lookup"><span data-stu-id="ad296-398">about_Hash_Tables</span></span>](../Microsoft.PowerShell.Core/about/about_hash_tables.md)

[<span data-ttu-id="ad296-399">使用 FilterHashtable 建立 Get-WinEvent 查詢</span><span class="sxs-lookup"><span data-stu-id="ad296-399">Creating Get-WinEvent queries with FilterHashtable</span></span>](/powershell/scripting/samples/Creating-Get-WinEvent-queries-with-FilterHashtable)

[<span data-ttu-id="ad296-400">Format-Table</span><span class="sxs-lookup"><span data-stu-id="ad296-400">Format-Table</span></span>](../Microsoft.PowerShell.Utility/Format-Table.md)

[<span data-ttu-id="ad296-401">Group-Object</span><span class="sxs-lookup"><span data-stu-id="ad296-401">Group-Object</span></span>](../Microsoft.PowerShell.Utility/Group-Object.md)

[<span data-ttu-id="ad296-402">Sort-Object</span><span class="sxs-lookup"><span data-stu-id="ad296-402">Sort-Object</span></span>](../Microsoft.PowerShell.Utility/Sort-Object.md)

[<span data-ttu-id="ad296-403">Where-Object</span><span class="sxs-lookup"><span data-stu-id="ad296-403">Where-Object</span></span>](../Microsoft.PowerShell.Core/Where-Object.md)
