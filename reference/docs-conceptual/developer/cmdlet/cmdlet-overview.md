---
title: Cmdlet 概觀
ms.date: 06/11/2020
ms.openlocfilehash: 576df03f35dff80479d1fce18cf4306c9219d42f
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/05/2020
ms.locfileid: "87784396"
---
# <a name="cmdlet-overview"></a><span data-ttu-id="0f4ef-102">Cmdlet 概觀</span><span class="sxs-lookup"><span data-stu-id="0f4ef-102">Cmdlet Overview</span></span>

<span data-ttu-id="0f4ef-103">Cmdlet 是在 PowerShell 環境中使用的輕量命令。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-103">A cmdlet is a lightweight command that is used in the PowerShell environment.</span></span> <span data-ttu-id="0f4ef-104">PowerShell 執行時間會在命令列提供的自動化腳本內容中叫用這些 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-104">The PowerShell runtime invokes these cmdlets within the context of automation scripts that are provided at the command line.</span></span> <span data-ttu-id="0f4ef-105">PowerShell 執行時間也會透過 PowerShell Api 以程式設計方式叫用它們。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-105">The PowerShell runtime also invokes them programmatically through PowerShell APIs.</span></span>

## <a name="cmdlets"></a><span data-ttu-id="0f4ef-106">指令程式</span><span class="sxs-lookup"><span data-stu-id="0f4ef-106">Cmdlets</span></span>

<span data-ttu-id="0f4ef-107">Cmdlet 會執行動作，而且通常會將 Microsoft .NET 物件傳回給管線中的下一個命令。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-107">Cmdlets perform an action and typically return a Microsoft .NET object to the next command in the pipeline.</span></span> <span data-ttu-id="0f4ef-108">Cmdlet 是參與 PowerShell 管線語義的單一命令。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-108">A cmdlet is a single command that participates in the pipeline semantics of PowerShell.</span></span>
<span data-ttu-id="0f4ef-109">這包括二進位 (c # ) Cmdlet、advanced script 函數、CDXML 和工作流程。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-109">This includes binary (C#) cmdlets, advanced script functions, CDXML, and Workflows.</span></span>

<span data-ttu-id="0f4ef-110">此 SDK 檔描述如何建立以 c # 撰寫的二進位 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-110">This SDK documentation describes how to create binary cmdlets written in C#.</span></span> <span data-ttu-id="0f4ef-111">如需以腳本為基礎的 Cmdlet 的詳細資訊，請參閱：</span><span class="sxs-lookup"><span data-stu-id="0f4ef-111">For information about script-based cmdlets, see:</span></span>

- [<span data-ttu-id="0f4ef-112">about_Functions_Advanced</span><span class="sxs-lookup"><span data-stu-id="0f4ef-112">about_Functions_Advanced</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_advanced)
- [<span data-ttu-id="0f4ef-113">about_Functions_CmdletBindingAttribute</span><span class="sxs-lookup"><span data-stu-id="0f4ef-113">about_Functions_CmdletBindingAttribute</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_cmdletbindingattribute)
- [<span data-ttu-id="0f4ef-114">about_Functions_Advanced_Methods</span><span class="sxs-lookup"><span data-stu-id="0f4ef-114">about_Functions_Advanced_Methods</span></span>](/powershell/module/microsoft.powershell.core/about/about_functions_advanced_methods)

<span data-ttu-id="0f4ef-115">若要建立二元 Cmdlet，您必須執行一個衍生自兩個特製化 Cmdlet 基類之一的 Cmdlet 類別。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-115">To create a binary cmdlet, you must implement a cmdlet class that derives from one of two specialized cmdlet base classes.</span></span> <span data-ttu-id="0f4ef-116">衍生的類別必須：</span><span class="sxs-lookup"><span data-stu-id="0f4ef-116">The derived class must:</span></span>

- <span data-ttu-id="0f4ef-117">宣告會將衍生類別識別為 Cmdlet 的屬性。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-117">Declare an attribute that identifies the derived class as a cmdlet.</span></span>
- <span data-ttu-id="0f4ef-118">定義使用屬性裝飾的公用屬性，以將公用屬性識別為 Cmdlet 參數。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-118">Define public properties that are decorated with attributes that identify the public properties as cmdlet parameters.</span></span>
- <span data-ttu-id="0f4ef-119">覆寫一或多個輸入處理方法來處理記錄。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-119">Override one or more of the input processing methods to process records.</span></span>

<span data-ttu-id="0f4ef-120">您可以使用[import-module](/powershell/module/microsoft.powershell.core/import-module) Cmdlet 直接載入包含類別的元件，也可以使用[System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API 來建立裝載該元件的主應用程式。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-120">You can load the assembly that contains the class directly by using the [Import-Module](/powershell/module/microsoft.powershell.core/import-module) cmdlet, or you can create a host application that loads the assembly by using the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API.</span></span> <span data-ttu-id="0f4ef-121">這兩種方法都可讓您以程式設計方式和命令列存取 Cmdlet 的功能。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-121">Both methods provide programmatic and command-line access to the functionality of the cmdlet.</span></span>

## <a name="cmdlet-terms"></a><span data-ttu-id="0f4ef-122">Cmdlet 詞彙</span><span class="sxs-lookup"><span data-stu-id="0f4ef-122">Cmdlet Terms</span></span>

<span data-ttu-id="0f4ef-123">以下是 PowerShell Cmdlet 檔中經常使用的詞彙：</span><span class="sxs-lookup"><span data-stu-id="0f4ef-123">The following terms are used frequently in the PowerShell cmdlet documentation:</span></span>

### <a name="cmdlet-attribute"></a><span data-ttu-id="0f4ef-124">Cmdlet 屬性</span><span class="sxs-lookup"><span data-stu-id="0f4ef-124">Cmdlet attribute</span></span>

<span data-ttu-id="0f4ef-125">用來將 Cmdlet 類別宣告為 Cmdlet 的 .NET 屬性。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-125">A .NET attribute that is used to declare a cmdlet class as a cmdlet.</span></span> <span data-ttu-id="0f4ef-126">雖然 PowerShell 使用其他幾個選擇性的屬性，但 Cmdlet 屬性是必要的。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-126">Although PowerShell uses several other attributes that are optional, the Cmdlet attribute is required.</span></span> <span data-ttu-id="0f4ef-127">如需此屬性的詳細資訊，請參閱[Cmdlet 屬性](cmdlet-attribute-declaration.md)宣告。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-127">For more information about this attribute, see [Cmdlet Attribute Declaration](cmdlet-attribute-declaration.md).</span></span>

### <a name="cmdlet-parameter"></a><span data-ttu-id="0f4ef-128">Cmdlet 參數</span><span class="sxs-lookup"><span data-stu-id="0f4ef-128">Cmdlet parameter</span></span>

<span data-ttu-id="0f4ef-129">公用屬性，定義可供使用者或執行 Cmdlet 之應用程式使用的參數。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-129">The public properties that define the parameters that are available to the user or to the application that is running the cmdlet.</span></span> <span data-ttu-id="0f4ef-130">Cmdlet 可以有必要、命名、位置和*切換*參數。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-130">Cmdlets can have required, named, positional, and *switch* parameters.</span></span> <span data-ttu-id="0f4ef-131">切換參數可讓您定義只有在呼叫中指定參數時才會評估的參數。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-131">Switch parameters allow you to define parameters that are evaluated only if the parameters are specified in the call.</span></span> <span data-ttu-id="0f4ef-132">如需不同類型參數的詳細資訊，請參閱[Cmdlet 參數](cmdlet-parameters.md)。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-132">For more information about the different types of parameters, see [Cmdlet Parameters](cmdlet-parameters.md).</span></span>

### <a name="parameter-set"></a><span data-ttu-id="0f4ef-133">參數集</span><span class="sxs-lookup"><span data-stu-id="0f4ef-133">Parameter set</span></span>

<span data-ttu-id="0f4ef-134">可在相同命令中用來執行特定動作的一組參數。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-134">A group of parameters that can be used in the same command to perform a specific action.</span></span> <span data-ttu-id="0f4ef-135">一個 Cmdlet 可以有多個參數集，但每個參數集必須至少有一個唯一的參數。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-135">A cmdlet can have multiple parameter sets, but each parameter set must have at least one parameter that is unique.</span></span> <span data-ttu-id="0f4ef-136">良好的 Cmdlet 設計強烈建議，unique 參數也是必要參數。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-136">Good cmdlet design strongly suggests that the unique parameter also be a required parameter.</span></span>
<span data-ttu-id="0f4ef-137">如需參數集的詳細資訊，請參閱[Cmdlet 參數集](cmdlet-parameter-sets.md)。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-137">For more information about parameter sets, see [Cmdlet Parameter Sets](cmdlet-parameter-sets.md).</span></span>

### <a name="dynamic-parameter"></a><span data-ttu-id="0f4ef-138">動態參數</span><span class="sxs-lookup"><span data-stu-id="0f4ef-138">Dynamic parameter</span></span>

<span data-ttu-id="0f4ef-139">在執行時間新增至 Cmdlet 的參數。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-139">A parameter that is added to the cmdlet at runtime.</span></span> <span data-ttu-id="0f4ef-140">一般而言，當另一個參數設定為特定值時，會將動態參數新增至 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-140">Typically, the dynamic parameters are added to the cmdlet when another parameter is set to a specific value.</span></span> <span data-ttu-id="0f4ef-141">如需動態參數的詳細資訊，請參閱[Cmdlet 動態參數](cmdlet-dynamic-parameters.md)。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-141">For more information about dynamic parameters, see [Cmdlet Dynamic Parameters](cmdlet-dynamic-parameters.md).</span></span>

### <a name="input-processing-methods"></a><span data-ttu-id="0f4ef-142">輸入處理方法</span><span class="sxs-lookup"><span data-stu-id="0f4ef-142">Input processing methods</span></span>

<span data-ttu-id="0f4ef-143">[System.web](/dotnet/api/System.Management.Automation.Cmdlet)類別提供了下列用來處理記錄的虛擬方法。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-143">The [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class provides the following virtual methods that are used to process records.</span></span> <span data-ttu-id="0f4ef-144">所有衍生的 Cmdlet 類別都必須覆寫前三個方法的其中一個或多個：</span><span class="sxs-lookup"><span data-stu-id="0f4ef-144">All the derived cmdlet classes must override one or more of the first three methods:</span></span>

- <span data-ttu-id="0f4ef-145">[BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)：用來為指令程式提供選擇性的一次性、前置處理的功能。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-145">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): Used to provide optional one-time, pre-processing functionality for the cmdlet.</span></span>
- <span data-ttu-id="0f4ef-146">[ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)：用來提供 Cmdlet 的記錄依記錄的處理功能（）。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-146">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): Used to provide record-by-record processing functionality for the cmdlet.</span></span> <span data-ttu-id="0f4ef-147">視 Cmdlet 的輸入而定，可能會呼叫[ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)方法任意次數，或根本不需要任何次數。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-147">The [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method might be called any number of times, or not at all, depending on the input of the cmdlet.</span></span>
- <span data-ttu-id="0f4ef-148">System.servicemodel：用來為 Cmdlet 提供選擇性的一次性、後置處理的[功能。](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)</span><span class="sxs-lookup"><span data-stu-id="0f4ef-148">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): Used to provide optional one-time, post-processing functionality for the cmdlet.</span></span>
- <span data-ttu-id="0f4ef-149">[StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing)：用來在使用者以非同步方式停止 Cmdlet 時停止處理 (例如，按下<kbd>CTRL</kbd> + <kbd>C</kbd>) 。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-149">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): Used to stop processing when the user stops the cmdlet asynchronously (for example, by pressing <kbd>CTRL</kbd>+<kbd>C</kbd>).</span></span>

<span data-ttu-id="0f4ef-150">如需這些方法的詳細資訊，請參閱[Cmdlet 輸入處理方法](./cmdlet-input-processing-methods.md)。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-150">For more information about these methods, see [Cmdlet Input Processing Methods](./cmdlet-input-processing-methods.md).</span></span>

<span data-ttu-id="0f4ef-151">當您執行 Cmdlet 時，您必須至少覆寫其中一個輸入處理方法。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-151">When you implement a cmdlet, you must override at least one of these input processing methods.</span></span>
<span data-ttu-id="0f4ef-152">一般而言， **ProcessRecord ( # B1**是您覆寫的方法，因為它會針對 Cmdlet 所處理的每一筆記錄進行呼叫。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-152">Typically, the **ProcessRecord()** is the method that you override because it is called for every record that the cmdlet processes.</span></span> <span data-ttu-id="0f4ef-153">相反地， **BeginProcessing ( # B1**方法和**EndProcessing ( # B3**方法會呼叫一次來執行記錄的前置處理或後置處理。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-153">In contrast, the **BeginProcessing()** method and the **EndProcessing()** method are called one time to perform pre-processing or post-processing of the records.</span></span> <span data-ttu-id="0f4ef-154">如需這些方法的詳細資訊，請參閱[輸入處理方法](cmdlet-input-processing-methods.md)。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-154">For more information about these methods, see [Input Processing Methods](cmdlet-input-processing-methods.md).</span></span>

### <a name="shouldprocess-feature"></a><span data-ttu-id="0f4ef-155">ShouldProcess 功能</span><span class="sxs-lookup"><span data-stu-id="0f4ef-155">ShouldProcess feature</span></span>

<span data-ttu-id="0f4ef-156">PowerShell 可讓您建立 Cmdlet，在 Cmdlet 對系統進行變更之前提示使用者提供意見反應。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-156">PowerShell allows you to create cmdlets that prompt the user for feedback before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="0f4ef-157">若要使用這項功能，Cmdlet 必須在宣告 `ShouldProcess` Cmdlet 屬性時宣告其支援功能，而此 Cmdlet 必須從輸入處理方法中呼叫[ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)和[ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)方法，而此指令程式必須是。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-157">To use this feature, the cmdlet must declare that it supports the `ShouldProcess` feature when you declare the Cmdlet attribute, and the cmdlet must call the [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) and [System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) methods from within an input processing method.</span></span> <span data-ttu-id="0f4ef-158">如需如何支援功能的詳細資訊 `ShouldProcess` ，請參閱[要求確認](requesting-confirmation-from-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-158">For more information about how to support the `ShouldProcess` functionality, see [Requesting Confirmation](requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="transaction"></a><span data-ttu-id="0f4ef-159">交易</span><span class="sxs-lookup"><span data-stu-id="0f4ef-159">Transaction</span></span>

<span data-ttu-id="0f4ef-160">視為單一工作的命令邏輯群組。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-160">A logical group of commands that are treated as a single task.</span></span> <span data-ttu-id="0f4ef-161">如果群組中有任何命令失敗，此工作會自動失敗，而且使用者可以選擇接受或拒絕在交易內執行的動作。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-161">The task automatically fails if any command in the group fails, and the user has the choice to accept or reject the actions performed within the transaction.</span></span> <span data-ttu-id="0f4ef-162">若要參與交易，Cmdlet 必須在宣告 Cmdlet 屬性時宣告它支援交易。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-162">To participate in a transaction, the cmdlet must declare that it supports transactions when the Cmdlet attribute is declared.</span></span> <span data-ttu-id="0f4ef-163">對交易的支援是在 Windows PowerShell 2.0 中引進。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-163">Support for transactions was introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="0f4ef-164">如需交易的詳細資訊，請參閱[如何支援交易](how-to-support-transactions.md)。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-164">For more information about transactions, see [How to Support Transactions](how-to-support-transactions.md).</span></span>

## <a name="how-cmdlets-differ-from-commands"></a><span data-ttu-id="0f4ef-165">Cmdlet 與命令有何不同</span><span class="sxs-lookup"><span data-stu-id="0f4ef-165">How Cmdlets Differ from Commands</span></span>

<span data-ttu-id="0f4ef-166">Cmdlet 與其他命令 shell 環境中的命令不同，有下列幾種方式：</span><span class="sxs-lookup"><span data-stu-id="0f4ef-166">Cmdlets differ from commands in other command-shell environments in the following ways:</span></span>

- <span data-ttu-id="0f4ef-167">Cmdlet 是 .NET 類別的實例;它們不是獨立的可執行檔。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-167">Cmdlets are instances of .NET classes; they are not stand-alone executables.</span></span>
- <span data-ttu-id="0f4ef-168">您可以從短短幾行程式碼建立 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-168">Cmdlets can be created from as few as a dozen lines of code.</span></span>
- <span data-ttu-id="0f4ef-169">Cmdlet 通常不會執行自己的剖析、錯誤簡報或輸出格式。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-169">Cmdlets do not generally do their own parsing, error presentation, or output formatting.</span></span> <span data-ttu-id="0f4ef-170">剖析、錯誤簡報和輸出格式是由 PowerShell 執行時間處理。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-170">Parsing, error presentation, and output formatting are handled by the PowerShell runtime.</span></span>
- <span data-ttu-id="0f4ef-171">Cmdlet 會處理來自管線的輸入物件，而不是從文字的資料流程，而 Cmdlet 通常會將物件當做輸出傳遞至管線。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-171">Cmdlets process input objects from the pipeline rather than from streams of text, and cmdlets typically deliver objects as output to the pipeline.</span></span>
- <span data-ttu-id="0f4ef-172">Cmdlet 是記錄導向的，因為它們會一次處理一個物件。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-172">Cmdlets are record-oriented because they process a single object at a time.</span></span>

## <a name="cmdlet-base-classes"></a><span data-ttu-id="0f4ef-173">Cmdlet 基類</span><span class="sxs-lookup"><span data-stu-id="0f4ef-173">Cmdlet Base Classes</span></span>

<span data-ttu-id="0f4ef-174">Windows PowerShell 支援衍生自下列兩個基類的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-174">Windows PowerShell supports cmdlets that are derived from the following two base classes.</span></span>

- <span data-ttu-id="0f4ef-175">大部分的 Cmdlet 都是以衍生自[system.object](/dotnet/api/System.Management.Automation.Cmdlet)基類的 .net 類別為基礎。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-175">Most cmdlets are based on .NET classes that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) base class.</span></span>
  <span data-ttu-id="0f4ef-176">衍生自這個類別可讓 Cmdlet 使用 Windows PowerShell 執行時間上的最小相依性集合。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-176">Deriving from this class allows a cmdlet to use the minimum set of dependencies on the Windows PowerShell runtime.</span></span> <span data-ttu-id="0f4ef-177">這樣有兩個優點。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-177">This has two benefits.</span></span> <span data-ttu-id="0f4ef-178">第一個優點是 Cmdlet 物件較小，而且您較不可能受到 PowerShell 執行時間變更的影響。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-178">The first benefit is that the cmdlet objects are smaller, and you are less likely to be affected by changes to the PowerShell runtime.</span></span> <span data-ttu-id="0f4ef-179">第二個優點是，如果您需要，可以直接建立 Cmdlet 物件的實例，然後直接叫用它，而不是透過 PowerShell 執行時間叫用它。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-179">The second benefit is that, if you have to, you can directly create an instance of the cmdlet object and then invoke it directly instead of invoking it through the PowerShell runtime.</span></span>

- <span data-ttu-id="0f4ef-180">較複雜的 Cmdlet 是以衍生自[PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)基類的 .net 類別為基礎。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-180">The more-complex cmdlets are based on .NET classes that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="0f4ef-181">衍生自這個類別可讓您更容易存取 PowerShell 執行時間。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-181">Deriving from this class gives you much more access to the PowerShell runtime.</span></span> <span data-ttu-id="0f4ef-182">此存取可讓您的 Cmdlet 呼叫腳本、存取提供者，以及存取目前的會話狀態。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-182">This access allows your cmdlet to call scripts, to access providers, and to access the current session state.</span></span>
  <span data-ttu-id="0f4ef-183"> (存取目前的會話狀態時，您會取得並設定會話變數與喜好設定。 ) 不過，衍生自這個類別會增加 Cmdlet 物件的大小，這表示您的 Cmdlet 會與目前的 PowerShell 執行時間版本緊密結合。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-183">(To access the current session state, you get and set session variables and preferences.) However, deriving from this class increases the size of the cmdlet object, and it means that your cmdlet is more tightly coupled to the current version of the PowerShell runtime.</span></span>

<span data-ttu-id="0f4ef-184">一般而言，除非您需要 PowerShell 執行時間的延伸存取權，否則您應該衍生自[system.object](/dotnet/api/System.Management.Automation.Cmdlet)類別。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-184">In general, unless you need the extended access to the PowerShell runtime, you should derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span>
<span data-ttu-id="0f4ef-185">不過，PowerShell 執行時間具有廣泛的記錄功能，可執行 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-185">However, the PowerShell runtime has extensive logging capabilities for the execution of cmdlets.</span></span> <span data-ttu-id="0f4ef-186">如果您的審核模型相依于此記錄，您可以藉由衍生自[PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)類別，防止從另一個 Cmdlet 中執行 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-186">If your auditing model depends on this logging, you can prevent the execution of your cmdlet from within another cmdlet by deriving from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class.</span></span>

## <a name="cmdlet-attributes"></a><span data-ttu-id="0f4ef-187">Cmdlet 屬性</span><span class="sxs-lookup"><span data-stu-id="0f4ef-187">Cmdlet Attributes</span></span>

<span data-ttu-id="0f4ef-188">PowerShell 定義數個用來管理 Cmdlet 的 .NET 屬性，並指定 PowerShell 提供的一般功能，以及 Cmdlet 可能需要的功能。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-188">PowerShell defines several .NET attributes that are used to manage cmdlets and to specify common functionality that is provided by PowerShell and that might be required by the cmdlet.</span></span> <span data-ttu-id="0f4ef-189">例如，屬性是用來指定類別做為 Cmdlet、指定 Cmdlet 的參數，以及要求輸入的驗證，讓 Cmdlet 開發人員不需要在其 Cmdlet 程式碼中執行該功能。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-189">For example, attributes are used to designate a class as a cmdlet, to specify the parameters of the cmdlet, and to request the validation of input so that cmdlet developers do not have to implement that functionality in their cmdlet code.</span></span> <span data-ttu-id="0f4ef-190">如需有關屬性的詳細資訊，請參閱[PowerShell 屬性](./cmdlet-attributes.md)。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-190">For more information about attributes, see [PowerShell Attributes](./cmdlet-attributes.md).</span></span>

## <a name="cmdlet-names"></a><span data-ttu-id="0f4ef-191">Cmdlet 名稱</span><span class="sxs-lookup"><span data-stu-id="0f4ef-191">Cmdlet Names</span></span>

<span data-ttu-id="0f4ef-192">PowerShell 會使用動詞和名詞名稱配對來命名 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-192">PowerShell uses a verb-and-noun name pair to name cmdlets.</span></span> <span data-ttu-id="0f4ef-193">例如， `Get-Command` PowerShell 中包含的 Cmdlet 會用來取得在命令 shell 中註冊的所有 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-193">For example, the `Get-Command` cmdlet included in PowerShell is used to get all the cmdlets that are registered in the command shell.</span></span> <span data-ttu-id="0f4ef-194">動詞識別指令程式所執行的動作，名詞則識別此 Cmdlet 執行其動作的資源。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-194">The verb identifies the action that the cmdlet performs, and the noun identifies the resource on which the cmdlet performs its action.</span></span>

<span data-ttu-id="0f4ef-195">當 .NET 類別宣告為 Cmdlet 時，會指定這些名稱。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-195">These names are specified when the .NET class is declared as a cmdlet.</span></span> <span data-ttu-id="0f4ef-196">如需如何將 .NET 類別宣告為 Cmdlet 的詳細資訊，請參閱[Cmdlet 屬性](./cmdlet-class-declaration.md)宣告。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-196">For more information about how to declare a .NET class as a cmdlet, see [Cmdlet Attribute Declaration](./cmdlet-class-declaration.md).</span></span>

## <a name="writing-cmdlet-code"></a><span data-ttu-id="0f4ef-197">撰寫 Cmdlet 程式碼</span><span class="sxs-lookup"><span data-stu-id="0f4ef-197">Writing Cmdlet Code</span></span>

<span data-ttu-id="0f4ef-198">本檔提供兩種方式來探索 Cmdlet 程式碼的撰寫方式。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-198">This document provides two ways to discover how cmdlet code is written.</span></span> <span data-ttu-id="0f4ef-199">如果您想要查看程式碼而不會有太多說明，請參閱[Cmdlet 程式碼的範例](./examples-of-cmdlet-code.md)。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-199">If you prefer to see the code without much explanation, see [Examples of Cmdlet Code](./examples-of-cmdlet-code.md).</span></span> <span data-ttu-id="0f4ef-200">如果您想要更多有關程式碼的說明，請參閱[GetProc 教學](./getproc-tutorial.md)課程、 [StopProc 教學](./stopproc-tutorial.md)課程或[SelectStr 教學](./selectstr-tutorial.md)課程主題。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-200">If you prefer more explanation about the code, see the [GetProc Tutorial](./getproc-tutorial.md), [StopProc Tutorial](./stopproc-tutorial.md), or [SelectStr Tutorial](./selectstr-tutorial.md) topics.</span></span>

<span data-ttu-id="0f4ef-201">如需撰寫 Cmdlet 之指導方針的詳細資訊，請參閱[Cmdlet 開發指導方針](./cmdlet-development-guidelines.md)。</span><span class="sxs-lookup"><span data-stu-id="0f4ef-201">For more information about the guidelines for writing cmdlets, see [Cmdlet Development Guidelines](./cmdlet-development-guidelines.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="0f4ef-202">另請參閱</span><span class="sxs-lookup"><span data-stu-id="0f4ef-202">See Also</span></span>

[<span data-ttu-id="0f4ef-203">PowerShell Cmdlet 概念</span><span class="sxs-lookup"><span data-stu-id="0f4ef-203">PowerShell Cmdlet Concepts</span></span>](./windows-powershell-cmdlet-concepts.md)

[<span data-ttu-id="0f4ef-204">撰寫 PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0f4ef-204">Writing a PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

[<span data-ttu-id="0f4ef-205">PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="0f4ef-205">PowerShell SDK</span></span>](../windows-powershell-reference.md)
