---
title: 解讀 ErrorRecord 物件 |Microsoft Docs
ms.date: 09/13/2016
ms.openlocfilehash: 249fff7d14023806d75aeca40f4d9b7231e14311
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/05/2020
ms.locfileid: "87786589"
---
# <a name="interpreting-errorrecord-objects"></a><span data-ttu-id="1a277-102">解譯 ErrorRecord 物件</span><span class="sxs-lookup"><span data-stu-id="1a277-102">Interpreting ErrorRecord Objects</span></span>

<span data-ttu-id="1a277-103">在大多數情況下， [ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件代表命令或腳本所產生的非終止錯誤。</span><span class="sxs-lookup"><span data-stu-id="1a277-103">In most cases, an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object represents a non-terminating error generated by a command or script.</span></span> <span data-ttu-id="1a277-104">終止錯誤也可以透過[Icontainserrorrecord](/dotnet/api/System.Management.Automation.IContainsErrorRecord)介面，在 ErrorRecord 中指定其他資訊。</span><span class="sxs-lookup"><span data-stu-id="1a277-104">Terminating errors can also specify the additional information in an ErrorRecord via the [System.Management.Automation.Icontainserrorrecord](/dotnet/api/System.Management.Automation.IContainsErrorRecord) interface.</span></span>

<span data-ttu-id="1a277-105">如果您想要在腳本或主控制項中寫入錯誤處理常式，以處理命令或腳本執行期間所發生的特定錯誤，您必須解讀[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件，以判斷它是否代表您要處理之錯誤的類別。</span><span class="sxs-lookup"><span data-stu-id="1a277-105">If you want to write an error handler in your script or a host to handle specific errors that occur during command or script execution, you must interpret the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object to determine whether it represents the class of error that you want to handle.</span></span>

<span data-ttu-id="1a277-106">當 Cmdlet 遇到終止或非終止錯誤時，應該會建立描述錯誤狀況的錯誤記錄。</span><span class="sxs-lookup"><span data-stu-id="1a277-106">When a cmdlet encounters a terminating or non-terminating error, it should create an error record that describes the error condition.</span></span> <span data-ttu-id="1a277-107">主應用程式必須調查這些錯誤記錄，並執行任何動作來減輕錯誤。</span><span class="sxs-lookup"><span data-stu-id="1a277-107">The host application must investigate these error records and perform whatever action will mitigate the error.</span></span> <span data-ttu-id="1a277-108">主應用程式也必須調查錯誤記錄，找出無法處理記錄但可以繼續的非終止錯誤，而且必須調查錯誤記錄，以找出導致管線停止的終止錯誤。</span><span class="sxs-lookup"><span data-stu-id="1a277-108">The host application must also investigate error records for nonterminating errors that failed to process a record but were able to continue, and it must investigate error records for terminating errors that caused the pipeline to stop.</span></span>

> [!NOTE]
> <span data-ttu-id="1a277-109">針對終止錯誤，此 Cmdlet 會呼叫[Throwterminatingerror \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)方法。</span><span class="sxs-lookup"><span data-stu-id="1a277-109">For terminating errors, the cmdlet calls the [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method.</span></span> <span data-ttu-id="1a277-110">若為非終止錯誤，此 Cmdlet 會呼叫[WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)方法。</span><span class="sxs-lookup"><span data-stu-id="1a277-110">For non-terminating errors, the cmdlet calls the [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method.</span></span>

## <a name="error-record-design"></a><span data-ttu-id="1a277-111">錯誤記錄設計</span><span class="sxs-lookup"><span data-stu-id="1a277-111">Error Record Design</span></span>

<span data-ttu-id="1a277-112">錯誤記錄的設計目的是要提供例外狀況中未提供的其他錯誤資訊，同時確保每個錯誤記錄中的合併資訊都是唯一的。</span><span class="sxs-lookup"><span data-stu-id="1a277-112">Error records are designed to provide additional error information that is not available in exceptions while ensuring that the combined information in each error record is unique.</span></span> <span data-ttu-id="1a277-113">這項唯一性可讓主應用程式檢查錯誤記錄的不同部分，讓它能夠識別錯誤狀況，以及主機必須採取的動作。</span><span class="sxs-lookup"><span data-stu-id="1a277-113">This uniqueness allows the host application to inspect the different parts of the error record so that it can identify the error condition and the action the host must take.</span></span>

## <a name="interpreting-error-records"></a><span data-ttu-id="1a277-114">解讀錯誤記錄</span><span class="sxs-lookup"><span data-stu-id="1a277-114">Interpreting Error Records</span></span>

<span data-ttu-id="1a277-115">您可以檢查錯誤記錄的幾個部分，以找出錯誤。</span><span class="sxs-lookup"><span data-stu-id="1a277-115">You can review several parts of the error record to identify the error.</span></span> <span data-ttu-id="1a277-116">這些元件包括下列各項：</span><span class="sxs-lookup"><span data-stu-id="1a277-116">These parts include the following:</span></span>

- <span data-ttu-id="1a277-117">錯誤分類</span><span class="sxs-lookup"><span data-stu-id="1a277-117">The error category</span></span>

- <span data-ttu-id="1a277-118">錯誤例外狀況</span><span class="sxs-lookup"><span data-stu-id="1a277-118">The error exception</span></span>

- <span data-ttu-id="1a277-119"> (FQID 的完整錯誤識別碼) </span><span class="sxs-lookup"><span data-stu-id="1a277-119">The fully qualified error identifier (FQID)</span></span>

- <span data-ttu-id="1a277-120">其他資訊</span><span class="sxs-lookup"><span data-stu-id="1a277-120">Other information</span></span>

### <a name="the-error-category"></a><span data-ttu-id="1a277-121">錯誤分類</span><span class="sxs-lookup"><span data-stu-id="1a277-121">The Error Category</span></span>

<span data-ttu-id="1a277-122">錯誤記錄的錯誤類別是[Errorcategory](/dotnet/api/System.Management.Automation.ErrorCategory)列舉所提供的其中一個預先定義常數。</span><span class="sxs-lookup"><span data-stu-id="1a277-122">The error category of the error record is one of the predefined constants provided by the [System.Management.Automation.Errorcategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span> <span data-ttu-id="1a277-123">這項資訊可透過[ErrorRecord.](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo) [ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件的 CategoryInfo 屬性來取得，而提供。</span><span class="sxs-lookup"><span data-stu-id="1a277-123">This information  is available through the [System.Management.Automation.ErrorRecord.CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

<span data-ttu-id="1a277-124">此 Cmdlet 可以指定 CloseError、OpenError、InvalidType、ReadError 和 WriteError 類別目錄，以及其他錯誤分類。</span><span class="sxs-lookup"><span data-stu-id="1a277-124">The cmdlet can specify the CloseError, OpenError, InvalidType, ReadError, and WriteError categories, and other error categories.</span></span> <span data-ttu-id="1a277-125">主應用程式可以使用錯誤類別來捕捉錯誤群組。</span><span class="sxs-lookup"><span data-stu-id="1a277-125">The host application can use the error category to capture groups of errors.</span></span>

### <a name="the-exception"></a><span data-ttu-id="1a277-126">例外狀況</span><span class="sxs-lookup"><span data-stu-id="1a277-126">The Exception</span></span>

<span data-ttu-id="1a277-127">錯誤記錄中包含的例外狀況是由指令程式所提供，而且可以透過[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件的[ErrorRecord. exception \*](/dotnet/api/System.Management.Automation.ErrorRecord.Exception)屬性來存取。</span><span class="sxs-lookup"><span data-stu-id="1a277-127">The exception included in the error record is provided by the cmdlet and can be accessed through the [System.Management.Automation.ErrorRecord.Exception\*](/dotnet/api/System.Management.Automation.ErrorRecord.Exception) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

<span data-ttu-id="1a277-128">主應用程式可以使用 `is` 關鍵字來識別例外狀況是特定類別或衍生類別。</span><span class="sxs-lookup"><span data-stu-id="1a277-128">Host applications can use the `is` keyword to identify that the exception is of a specific class or of a derived class.</span></span> <span data-ttu-id="1a277-129">較好的方式是在例外狀況類型上分支，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="1a277-129">It is better to branch on the exception type, as shown in the following example.</span></span>

`if (MyNonTerminatingError.Exception is AccessDeniedException)`

<span data-ttu-id="1a277-130">如此一來，您就可以攔截衍生的類別。</span><span class="sxs-lookup"><span data-stu-id="1a277-130">This way, you catch the derived classes.</span></span> <span data-ttu-id="1a277-131">不過，如果已還原序列化例外狀況，就會發生問題。</span><span class="sxs-lookup"><span data-stu-id="1a277-131">However, there are problems if the exception is deserialized.</span></span>

### <a name="the-fqid"></a><span data-ttu-id="1a277-132">FQID</span><span class="sxs-lookup"><span data-stu-id="1a277-132">The FQID</span></span>

<span data-ttu-id="1a277-133">FQID 是您可以用來識別錯誤的最特定資訊。</span><span class="sxs-lookup"><span data-stu-id="1a277-133">The FQID is the most specific information you can use to identify the error.</span></span> <span data-ttu-id="1a277-134">它是一個字串，其中包含 Cmdlet 定義的識別碼、Cmdlet 類別的名稱，以及報告錯誤的來源。</span><span class="sxs-lookup"><span data-stu-id="1a277-134">It is a string that includes a cmdlet-defined identifier, the name of the cmdlet class, and the source that reported the error.</span></span> <span data-ttu-id="1a277-135">一般來說，錯誤記錄類似于 Windows 事件記錄檔的事件記錄。</span><span class="sxs-lookup"><span data-stu-id="1a277-135">In general, an error record is analogous to an event record of a Windows Event log.</span></span> <span data-ttu-id="1a277-136">FQID 類似于下列元組，可識別事件記錄的類別： (*記錄檔名稱*、*來源*、*事件識別碼*) 。</span><span class="sxs-lookup"><span data-stu-id="1a277-136">The FQID is analogous to the following tuple, which identifies the class of the event record: (*log name*, *source*, *event ID*).</span></span>

<span data-ttu-id="1a277-137">FQID 的設計是要檢查成單一字串。</span><span class="sxs-lookup"><span data-stu-id="1a277-137">The FQID is designed to be inspected as a single string.</span></span> <span data-ttu-id="1a277-138">不過，有一些案例是由主應用程式剖析的錯誤識別碼所設計。</span><span class="sxs-lookup"><span data-stu-id="1a277-138">However, cases exist in which the error identifier is designed to be parsed by the host application.</span></span> <span data-ttu-id="1a277-139">下列範例是格式正確的完整錯誤識別碼。</span><span class="sxs-lookup"><span data-stu-id="1a277-139">The following example is a well-formed fully qualified error identifier.</span></span>

`CommandNotFoundException,Microsoft.PowerShell.Commands.GetCommandCommand.`

<span data-ttu-id="1a277-140">在上述範例中，第一個權杖是錯誤識別碼，後面接著 Cmdlet 類別的名稱。</span><span class="sxs-lookup"><span data-stu-id="1a277-140">In the previous example, the first token is the error identifier, which is followed by the name of the cmdlet class.</span></span> <span data-ttu-id="1a277-141">錯誤識別碼可以是單一權杖，也可以是以點分隔的識別碼，以允許在檢查識別碼時進行分支。</span><span class="sxs-lookup"><span data-stu-id="1a277-141">The error identifier can be a single token, or it can be a dot-separated identifier that allows for branching on inspection of the identifier.</span></span> <span data-ttu-id="1a277-142">請勿在錯誤識別碼中使用空白字元或標點符號。</span><span class="sxs-lookup"><span data-stu-id="1a277-142">Do not use white space or punctuation in the error identifier.</span></span> <span data-ttu-id="1a277-143">特別重要的是不要使用逗號;Windows PowerShell 會使用逗號來分隔識別碼和 Cmdlet 類別名稱。</span><span class="sxs-lookup"><span data-stu-id="1a277-143">It is especially important not to use a comma; a comma is used by Windows PowerShell to separate the identifier and the cmdlet class name.</span></span>

### <a name="other-information"></a><span data-ttu-id="1a277-144">其他資訊</span><span class="sxs-lookup"><span data-stu-id="1a277-144">Other Information</span></span>

<span data-ttu-id="1a277-145">[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件也可能會提供描述發生錯誤之環境的資訊。</span><span class="sxs-lookup"><span data-stu-id="1a277-145">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object might also provide information that describes the environment in which the error occurred.</span></span> <span data-ttu-id="1a277-146">這項資訊包含錯誤詳細資料、調用資訊，以及發生錯誤時正在處理的目標物件等專案。</span><span class="sxs-lookup"><span data-stu-id="1a277-146">This information includes items such as error details, invocation information, and the target object that was being processed when the error occurred.</span></span> <span data-ttu-id="1a277-147">雖然這種資訊對主應用程式可能很有用，但通常不會用來識別錯誤。</span><span class="sxs-lookup"><span data-stu-id="1a277-147">Although this information might be useful to the host application, it is not typically used to identify the error.</span></span> <span data-ttu-id="1a277-148">這項資訊可透過下列屬性取得：</span><span class="sxs-lookup"><span data-stu-id="1a277-148">This information is available through the following properties:</span></span>

[<span data-ttu-id="1a277-149">System.web. ErrorRecord. ErrorDetails</span><span class="sxs-lookup"><span data-stu-id="1a277-149">System.Management.Automation.ErrorRecord.ErrorDetails</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails)

[<span data-ttu-id="1a277-150">System.web. ErrorRecord. InvocationInfo</span><span class="sxs-lookup"><span data-stu-id="1a277-150">System.Management.Automation.ErrorRecord.InvocationInfo</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord.InvocationInfo)

[<span data-ttu-id="1a277-151">System.web. ErrorRecord. TargetObject</span><span class="sxs-lookup"><span data-stu-id="1a277-151">System.Management.Automation.ErrorRecord.TargetObject</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord.TargetObject)

## <a name="see-also"></a><span data-ttu-id="1a277-152">另請參閱</span><span class="sxs-lookup"><span data-stu-id="1a277-152">See Also</span></span>

[<span data-ttu-id="1a277-153">ErrorRecord。</span><span class="sxs-lookup"><span data-stu-id="1a277-153">System.Management.Automation.ErrorRecord</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord)

[<span data-ttu-id="1a277-154">Errorcategory。</span><span class="sxs-lookup"><span data-stu-id="1a277-154">System.Management.Automation.Errorcategory</span></span>](/dotnet/api/System.Management.Automation.ErrorCategory)

[<span data-ttu-id="1a277-155">Errorcategoryinfo。</span><span class="sxs-lookup"><span data-stu-id="1a277-155">System.Management.Automation.Errorcategoryinfo</span></span>](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)

[<span data-ttu-id="1a277-156">WriteError 的管理元件</span><span class="sxs-lookup"><span data-stu-id="1a277-156">System.Management.Automation.Cmdlet.WriteError</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)

[<span data-ttu-id="1a277-157">Throwterminatingerror \* 的 \*</span><span class="sxs-lookup"><span data-stu-id="1a277-157">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)

[<span data-ttu-id="1a277-158">新增非終止錯誤報告到您的 Cmdlet</span><span class="sxs-lookup"><span data-stu-id="1a277-158">Adding Non-Terminating Error Reporting to Your Cmdlet</span></span>](./adding-non-terminating-error-reporting-to-your-cmdlet.md)

[<span data-ttu-id="1a277-159">Windows PowerShell 錯誤報告</span><span class="sxs-lookup"><span data-stu-id="1a277-159">Windows PowerShell Error Reporting</span></span>](./error-reporting-concepts.md)

[<span data-ttu-id="1a277-160">撰寫 Windows PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="1a277-160">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
