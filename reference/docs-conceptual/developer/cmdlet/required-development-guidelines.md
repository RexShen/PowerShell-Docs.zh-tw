---
title: 必要的開發指導方針 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 41d2b308-a36a-496f-8542-666b6a21eedc
caps.latest.revision: 19
ms.openlocfilehash: e68e43a91f9139e8d3dc636b5740121515aab2e6
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/05/2019
ms.locfileid: "72369517"
---
# <a name="required-development-guidelines"></a><span data-ttu-id="a829b-102">必要的開發指導方針</span><span class="sxs-lookup"><span data-stu-id="a829b-102">Required Development Guidelines</span></span>

<span data-ttu-id="a829b-103">當您撰寫 Cmdlet 時，必須遵循下列指導方針。</span><span class="sxs-lookup"><span data-stu-id="a829b-103">The following guidelines must be followed when you write your cmdlets.</span></span> <span data-ttu-id="a829b-104">它們會分成設計 Cmdlet 的指導方針，以及撰寫 Cmdlet 程式碼的指導方針。</span><span class="sxs-lookup"><span data-stu-id="a829b-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="a829b-105">如果您未遵循這些指導方針，您的 Cmdlet 可能會失敗，且您的使用者在使用您的 Cmdlet 時可能會有不佳的體驗。</span><span class="sxs-lookup"><span data-stu-id="a829b-105">If you do not follow these guidelines, your cmdlets could fail, and your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="in-this-topic"></a><span data-ttu-id="a829b-106">本主題內容</span><span class="sxs-lookup"><span data-stu-id="a829b-106">In this Topic</span></span>

### <a name="design-guidelines"></a><span data-ttu-id="a829b-107">設計指導方針</span><span class="sxs-lookup"><span data-stu-id="a829b-107">Design Guidelines</span></span>

- [<span data-ttu-id="a829b-108">只使用核准的動詞（RD01）</span><span class="sxs-lookup"><span data-stu-id="a829b-108">Use Only Approved Verbs (RD01)</span></span>](./required-development-guidelines.md#use-only-approved-verbs-rd01)

- [<span data-ttu-id="a829b-109">Cmdlet 名稱：無法使用的字元（RD02）</span><span class="sxs-lookup"><span data-stu-id="a829b-109">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>](./required-development-guidelines.md#cmdlet-names-characters-that-cannot-be-used-rd02)

- [<span data-ttu-id="a829b-110">無法使用的參數名稱（RD03）</span><span class="sxs-lookup"><span data-stu-id="a829b-110">Parameters Names that cannot be Used (RD03)</span></span>](./required-development-guidelines.md#parameters-names-that-cannot-be-used-rd03)

- [<span data-ttu-id="a829b-111">支援確認要求（RD04）</span><span class="sxs-lookup"><span data-stu-id="a829b-111">Support Confirmation Requests (RD04)</span></span>](./required-development-guidelines.md#support-confirmation-requests-rd04)

- [<span data-ttu-id="a829b-112">互動式會話的支援強制參數（RD05）</span><span class="sxs-lookup"><span data-stu-id="a829b-112">Support Force Parameter for Interactive Sessions (RD05)</span></span>](./required-development-guidelines.md#support-force-parameter-for-interactive-sessions-rd05)

- [<span data-ttu-id="a829b-113">檔輸出物件（RD06）</span><span class="sxs-lookup"><span data-stu-id="a829b-113">Document Output Objects (RD06)</span></span>](./required-development-guidelines.md#document-output-objects-rd06)

### <a name="code-guidelines"></a><span data-ttu-id="a829b-114">程式碼方針</span><span class="sxs-lookup"><span data-stu-id="a829b-114">Code Guidelines</span></span>

- [<span data-ttu-id="a829b-115">衍生自 Cmdlet 或 PSCmdlet 類別（RC01）</span><span class="sxs-lookup"><span data-stu-id="a829b-115">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>](./required-development-guidelines.md#derive-from-the-cmdlet-or-pscmdlet-classes-rc01)

- [<span data-ttu-id="a829b-116">指定 Cmdlet 屬性（RC02）</span><span class="sxs-lookup"><span data-stu-id="a829b-116">Specify the Cmdlet Attribute (RC02)</span></span>](./required-development-guidelines.md#specify-the-cmdlet-attribute-rc02)

- [<span data-ttu-id="a829b-117">覆寫輸入處理方法（RC03）</span><span class="sxs-lookup"><span data-stu-id="a829b-117">Override an Input Processing Method (RC03)</span></span>](./required-development-guidelines.md#override-an-input-processing-method-rc03)

- [<span data-ttu-id="a829b-118">指定 OutputType 屬性（RC04）</span><span class="sxs-lookup"><span data-stu-id="a829b-118">Specify the OutputType Attribute (RC04)</span></span>](./required-development-guidelines.md#specify-the-outputtype-attribute-rc04)

- [<span data-ttu-id="a829b-119">不要保留輸出物件的控制碼（RC05）</span><span class="sxs-lookup"><span data-stu-id="a829b-119">Do Not Retain Handles to Output Objects (RC05)</span></span>](./required-development-guidelines.md#do-not-retain-handles-to-output-objects-rc05)

- [<span data-ttu-id="a829b-120">穩定處理錯誤（RC06）</span><span class="sxs-lookup"><span data-stu-id="a829b-120">Handle Errors Robustly (RC06)</span></span>](./required-development-guidelines.md#handle-errors-robustly-rc06)

- [<span data-ttu-id="a829b-121">使用 Windows PowerShell 模組來部署您的 Cmdlet （RC07）</span><span class="sxs-lookup"><span data-stu-id="a829b-121">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>](./required-development-guidelines.md#use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07)

## <a name="design-guidelines"></a><span data-ttu-id="a829b-122">設計指導方針</span><span class="sxs-lookup"><span data-stu-id="a829b-122">Design Guidelines</span></span>

<span data-ttu-id="a829b-123">設計 Cmdlet 時必須遵循下列指導方針，以確保使用您的 Cmdlet 和其他 Cmdlet 的使用者體驗一致。</span><span class="sxs-lookup"><span data-stu-id="a829b-123">The following guidelines must be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="a829b-124">當您找到適用于您情況的設計指導方針時，請務必查看類似方針的程式碼方針。</span><span class="sxs-lookup"><span data-stu-id="a829b-124">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-only-approved-verbs-rd01"></a><span data-ttu-id="a829b-125">只使用核准的動詞（RD01）</span><span class="sxs-lookup"><span data-stu-id="a829b-125">Use Only Approved Verbs (RD01)</span></span>

<span data-ttu-id="a829b-126">Cmdlet 屬性中指定的動詞必須來自 Windows PowerShell 所提供的一組可辨識動詞。</span><span class="sxs-lookup"><span data-stu-id="a829b-126">The verb specified in the Cmdlet attribute must come from the recognized set of verbs provided by Windows PowerShell.</span></span> <span data-ttu-id="a829b-127">不得為其中一個禁止的同義字。</span><span class="sxs-lookup"><span data-stu-id="a829b-127">It must not be one of the prohibited synonyms.</span></span> <span data-ttu-id="a829b-128">使用下列列舉所定義的常數位串來指定 Cmdlet 動詞：</span><span class="sxs-lookup"><span data-stu-id="a829b-128">Use the constant strings that are defined by the following enumerations to specify cmdlet verbs:</span></span>

- [<span data-ttu-id="a829b-129">VerbsCommon。</span><span class="sxs-lookup"><span data-stu-id="a829b-129">System.Management.Automation.VerbsCommon</span></span>](/dotnet/api/System.Management.Automation.VerbsCommon)

- [<span data-ttu-id="a829b-130">VerbsCommunications。</span><span class="sxs-lookup"><span data-stu-id="a829b-130">System.Management.Automation.VerbsCommunications</span></span>](/dotnet/api/System.Management.Automation.VerbsCommunications)

- [<span data-ttu-id="a829b-131">VerbsData。</span><span class="sxs-lookup"><span data-stu-id="a829b-131">System.Management.Automation.VerbsData</span></span>](/dotnet/api/System.Management.Automation.VerbsData)

- [<span data-ttu-id="a829b-132">VerbsDiagnostic。</span><span class="sxs-lookup"><span data-stu-id="a829b-132">System.Management.Automation.VerbsDiagnostic</span></span>](/dotnet/api/System.Management.Automation.VerbsDiagnostic)

- [<span data-ttu-id="a829b-133">VerbsLifeCycle。</span><span class="sxs-lookup"><span data-stu-id="a829b-133">System.Management.Automation.VerbsLifeCycle</span></span>](/dotnet/api/System.Management.Automation.VerbsLifeCycle)

- [<span data-ttu-id="a829b-134">VerbsSecurity。</span><span class="sxs-lookup"><span data-stu-id="a829b-134">System.Management.Automation.VerbsSecurity</span></span>](/dotnet/api/System.Management.Automation.VerbsSecurity)

- [<span data-ttu-id="a829b-135">VerbsOther。</span><span class="sxs-lookup"><span data-stu-id="a829b-135">System.Management.Automation.VerbsOther</span></span>](/dotnet/api/System.Management.Automation.VerbsOther)

<span data-ttu-id="a829b-136">如需已核准動詞名稱的詳細資訊，請參閱[Cmdlet 動詞](./approved-verbs-for-windows-powershell-commands.md)。</span><span class="sxs-lookup"><span data-stu-id="a829b-136">For more information about the approved verb names, see [Cmdlet Verbs](./approved-verbs-for-windows-powershell-commands.md).</span></span>

<span data-ttu-id="a829b-137">使用者需要一組可探索且預期的 Cmdlet 名稱。</span><span class="sxs-lookup"><span data-stu-id="a829b-137">Users need a set of discoverable and expected cmdlet names.</span></span> <span data-ttu-id="a829b-138">使用適當的動詞，讓使用者可以快速評估 Cmdlet 的用途，並輕鬆地探索系統的功能。</span><span class="sxs-lookup"><span data-stu-id="a829b-138">Use the appropriate verb so that the user can make a quick assessment of what a cmdlet does and to easily discover the capabilities of the system.</span></span> <span data-ttu-id="a829b-139">例如，下列命令列命令會取得系統上名稱開頭為 "start" 的所有命令清單： `get-command start-*`。</span><span class="sxs-lookup"><span data-stu-id="a829b-139">For example, the following command-line command gets a list of all the commands on the system whose names begin with "start": `get-command start-*`.</span></span> <span data-ttu-id="a829b-140">使用 Cmdlet 中的名詞來區分您的 Cmdlet 與其他 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a829b-140">Use the nouns in your cmdlets to differentiate your cmdlets from other cmdlets.</span></span> <span data-ttu-id="a829b-141">名詞表示將在其上執行作業的資源。</span><span class="sxs-lookup"><span data-stu-id="a829b-141">The noun indicates the resource on which the operation will be performed.</span></span> <span data-ttu-id="a829b-142">作業本身是以動詞來表示。</span><span class="sxs-lookup"><span data-stu-id="a829b-142">The operation itself is represented by the verb.</span></span>

### <a name="cmdlet-names-characters-that-cannot-be-used-rd02"></a><span data-ttu-id="a829b-143">Cmdlet 名稱：無法使用的字元（RD02）</span><span class="sxs-lookup"><span data-stu-id="a829b-143">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>

<span data-ttu-id="a829b-144">當您命名 Cmdlet 時，請勿使用下列任何特殊字元。</span><span class="sxs-lookup"><span data-stu-id="a829b-144">When you name cmdlets, do not use any of the following special characters.</span></span>

|<span data-ttu-id="a829b-145">字元</span><span class="sxs-lookup"><span data-stu-id="a829b-145">Character</span></span>|<span data-ttu-id="a829b-146">Name</span><span class="sxs-lookup"><span data-stu-id="a829b-146">Name</span></span>|
|---------------|----------|
|#|<span data-ttu-id="a829b-147">數字正負號</span><span class="sxs-lookup"><span data-stu-id="a829b-147">number sign</span></span>|
|<span data-ttu-id="a829b-148">、</span><span class="sxs-lookup"><span data-stu-id="a829b-148">,</span></span>|<span data-ttu-id="a829b-149">逗號</span><span class="sxs-lookup"><span data-stu-id="a829b-149">comma</span></span>|
|<span data-ttu-id="a829b-150">()</span><span class="sxs-lookup"><span data-stu-id="a829b-150">()</span></span>|<span data-ttu-id="a829b-151">括號</span><span class="sxs-lookup"><span data-stu-id="a829b-151">parentheses</span></span>|
|{}|<span data-ttu-id="a829b-152">成對</span><span class="sxs-lookup"><span data-stu-id="a829b-152">braces</span></span>|
|<span data-ttu-id="a829b-153">[]</span><span class="sxs-lookup"><span data-stu-id="a829b-153">[]</span></span>|<span data-ttu-id="a829b-154">內</span><span class="sxs-lookup"><span data-stu-id="a829b-154">brackets</span></span>|
|&|<span data-ttu-id="a829b-155">字元</span><span class="sxs-lookup"><span data-stu-id="a829b-155">ampersand</span></span>|
|-|<span data-ttu-id="a829b-156">連字號**附注：** 連字號可以用來分隔動詞和名詞，但不能用在名詞或動詞內。</span><span class="sxs-lookup"><span data-stu-id="a829b-156">hyphen **Note:**  The hyphen can be used to separate the verb from the noun, but it cannot be used within the noun or within the verb.</span></span>|
|/|<span data-ttu-id="a829b-157">斜線</span><span class="sxs-lookup"><span data-stu-id="a829b-157">slash mark</span></span>|
|<span data-ttu-id="a829b-158">\\| 反斜線</span><span class="sxs-lookup"><span data-stu-id="a829b-158">\\|backslash</span></span>|
|$|<span data-ttu-id="a829b-159">貨幣符號</span><span class="sxs-lookup"><span data-stu-id="a829b-159">dollar sign</span></span>|
|^|<span data-ttu-id="a829b-160">caret</span><span class="sxs-lookup"><span data-stu-id="a829b-160">caret</span></span>|
|<span data-ttu-id="a829b-161">；</span><span class="sxs-lookup"><span data-stu-id="a829b-161">;</span></span>|<span data-ttu-id="a829b-162">冒號</span><span class="sxs-lookup"><span data-stu-id="a829b-162">semicolon</span></span>|
|<span data-ttu-id="a829b-163">:</span><span class="sxs-lookup"><span data-stu-id="a829b-163">:</span></span>|<span data-ttu-id="a829b-164">加</span><span class="sxs-lookup"><span data-stu-id="a829b-164">colon</span></span>|
|<span data-ttu-id="a829b-165">"</span><span class="sxs-lookup"><span data-stu-id="a829b-165">"</span></span>|<span data-ttu-id="a829b-166">雙引號</span><span class="sxs-lookup"><span data-stu-id="a829b-166">double quotation mark</span></span>|
|<span data-ttu-id="a829b-167">'</span><span class="sxs-lookup"><span data-stu-id="a829b-167">'</span></span>|<span data-ttu-id="a829b-168">單引號</span><span class="sxs-lookup"><span data-stu-id="a829b-168">single quotation mark</span></span>|
|<>|<span data-ttu-id="a829b-169">角括弧</span><span class="sxs-lookup"><span data-stu-id="a829b-169">angle brackets</span></span>|
|<span data-ttu-id="a829b-170">&#124;</span><span class="sxs-lookup"><span data-stu-id="a829b-170">&#124;</span></span>|<span data-ttu-id="a829b-171">分隔號</span><span class="sxs-lookup"><span data-stu-id="a829b-171">vertical bar</span></span>|
|<span data-ttu-id="a829b-172">?</span><span class="sxs-lookup"><span data-stu-id="a829b-172">?</span></span>|<span data-ttu-id="a829b-173">問號</span><span class="sxs-lookup"><span data-stu-id="a829b-173">question mark</span></span>|
|@|<span data-ttu-id="a829b-174">@ 符號</span><span class="sxs-lookup"><span data-stu-id="a829b-174">at sign</span></span>|
|`|<span data-ttu-id="a829b-175">反向刻度（抑音符號）</span><span class="sxs-lookup"><span data-stu-id="a829b-175">back tick (grave accent)</span></span>|
|*|<span data-ttu-id="a829b-176">星號</span><span class="sxs-lookup"><span data-stu-id="a829b-176">asterisk</span></span>|
|%|<span data-ttu-id="a829b-177">百分比符號</span><span class="sxs-lookup"><span data-stu-id="a829b-177">percent sign</span></span>|
|+|<span data-ttu-id="a829b-178">加號</span><span class="sxs-lookup"><span data-stu-id="a829b-178">plus sign</span></span>|
|=|<span data-ttu-id="a829b-179">等號</span><span class="sxs-lookup"><span data-stu-id="a829b-179">equals sign</span></span>|
|~|<span data-ttu-id="a829b-180">線</span><span class="sxs-lookup"><span data-stu-id="a829b-180">tilde</span></span>|

### <a name="parameters-names-that-cannot-be-used-rd03"></a><span data-ttu-id="a829b-181">無法使用的參數名稱（RD03）</span><span class="sxs-lookup"><span data-stu-id="a829b-181">Parameters Names that cannot be Used (RD03)</span></span>

<span data-ttu-id="a829b-182">Windows PowerShell 提供一組通用的參數給所有 Cmdlet，再加上在特定情況下新增的其他參數。</span><span class="sxs-lookup"><span data-stu-id="a829b-182">Windows PowerShell provides a common set a parameters to all cmdlets plus additional parameters that are added in specific situations.</span></span> <span data-ttu-id="a829b-183">在設計您自己的 Cmdlet 時，您無法使用下列名稱： Confirm、Debug、ErrorAction、ErrorVariable、OutBuffer、OutVariable、WarningAction、WarningVariable、WhatIf、UseTransaction 和 Verbose。</span><span class="sxs-lookup"><span data-stu-id="a829b-183">When designing your own cmdlets you cannot use the following names: Confirm, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction, and Verbose.</span></span> <span data-ttu-id="a829b-184">如需這些參數的詳細資訊，請參閱[一般參數名稱](./common-parameter-names.md)。</span><span class="sxs-lookup"><span data-stu-id="a829b-184">For more information about these parameters, see [Common Parameter Names](./common-parameter-names.md).</span></span>

### <a name="support-confirmation-requests-rd04"></a><span data-ttu-id="a829b-185">支援確認要求（RD04）</span><span class="sxs-lookup"><span data-stu-id="a829b-185">Support Confirmation Requests (RD04)</span></span>

<span data-ttu-id="a829b-186">對於執行修改系統之作業的 Cmdlet，它們應該呼叫[ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法來要求確認，而在特殊情況下，則會呼叫[ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)方法，而這會是。</span><span class="sxs-lookup"><span data-stu-id="a829b-186">For cmdlets that perform an operation that modifies the system, they should call the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method to request confirmation, and in special cases call the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method.</span></span> <span data-ttu-id="a829b-187">（只有在呼叫[ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法之後，才應呼叫[ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)方法）。）。（& i）</span><span class="sxs-lookup"><span data-stu-id="a829b-187">(The [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method should be called only after the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method is called.)</span></span>

<span data-ttu-id="a829b-188">若要進行這些呼叫，Cmdlet 必須藉由設定 Cmdlet 屬性的 `SupportsShouldProcess` 關鍵字來指定它支援確認要求。</span><span class="sxs-lookup"><span data-stu-id="a829b-188">To make these calls the cmdlet must specify that it supports confirmation requests by setting the `SupportsShouldProcess` keyword of the Cmdlet attribute.</span></span> <span data-ttu-id="a829b-189">如需設定此屬性的詳細資訊，請參閱[Cmdlet 屬性](./cmdlet-attribute-declaration.md)宣告。</span><span class="sxs-lookup"><span data-stu-id="a829b-189">For more information about setting this attribute, see [Cmdlet Attribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

> [!NOTE]
> <span data-ttu-id="a829b-190">如果 Cmdlet 類別的 Cmdlet 屬性指出此 Cmdlet 支援[ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法的呼叫，而此 Cmdlet 無法呼叫[ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法，則使用者可能會非預期地修改系統，而無法對系統進行錯誤的程式。</span><span class="sxs-lookup"><span data-stu-id="a829b-190">If the Cmdlet attribute of the cmdlet class indicates that the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, and the cmdlet fails to make the call to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, the user could modify the system unexpectedly.</span></span>

<span data-ttu-id="a829b-191">針對任何系統修改，請使用[ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法。</span><span class="sxs-lookup"><span data-stu-id="a829b-191">Use the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method for any system modification.</span></span> <span data-ttu-id="a829b-192">使用者喜好設定和 `WhatIf` 參數，會控制[ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法。</span><span class="sxs-lookup"><span data-stu-id="a829b-192">A user preference and the `WhatIf` parameter control the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="a829b-193">相反地， [ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)呼叫會執行額外的檢查，以進行潛在的危險修改。</span><span class="sxs-lookup"><span data-stu-id="a829b-193">In contrast, the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) call performs an additional check for potentially dangerous modifications.</span></span> <span data-ttu-id="a829b-194">這個方法不是由任何使用者喜好設定或 `WhatIf` 參數所控制。</span><span class="sxs-lookup"><span data-stu-id="a829b-194">This method is not controlled by any user preference or the `WhatIf` parameter.</span></span> <span data-ttu-id="a829b-195">如果您的 Cmdlet 呼叫[ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)方法，它應該會有一個 `Force` 參數，可略過這兩個方法的呼叫，並繼續進行作業。</span><span class="sxs-lookup"><span data-stu-id="a829b-195">If your cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method, it should have a `Force` parameter that bypasses the calls to these two methods and that proceeds with the operation.</span></span> <span data-ttu-id="a829b-196">這很重要，因為它可讓您的 Cmdlet 用於非互動式腳本和主機。</span><span class="sxs-lookup"><span data-stu-id="a829b-196">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span>

<span data-ttu-id="a829b-197">如果您的 Cmdlet 支援這些呼叫，使用者可以決定是否要實際執行動作。</span><span class="sxs-lookup"><span data-stu-id="a829b-197">If your cmdlets support these calls, the user can determine whether the action should actually be performed.</span></span> <span data-ttu-id="a829b-198">例如，[停止進程](/powershell/module/microsoft.powershell.management/stop-process)Cmdlet 會先呼叫[ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)方法，再停止一組重要的進程，包括系統、Winlogon 和 spoolsv.exe 進程。</span><span class="sxs-lookup"><span data-stu-id="a829b-198">For example, the [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method before it stops a set of critical processes, including the System, Winlogon, and Spoolsv processes.</span></span>

<span data-ttu-id="a829b-199">如需有關支援這些方法的詳細資訊，請參閱[要求確認](./requesting-confirmation-from-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="a829b-199">For more information about supporting these methods, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="support-force-parameter-for-interactive-sessions-rd05"></a><span data-ttu-id="a829b-200">互動式會話的支援強制參數（RD05）</span><span class="sxs-lookup"><span data-stu-id="a829b-200">Support Force Parameter for Interactive Sessions (RD05)</span></span>

<span data-ttu-id="a829b-201">如果您的 Cmdlet 以互動方式使用，請一律提供 Force 參數來覆寫互動式動作，例如提示或讀取輸入的行）。</span><span class="sxs-lookup"><span data-stu-id="a829b-201">If your cmdlet is used interactively, always provide a Force parameter to override the interactive actions, such as prompts or reading lines of input).</span></span> <span data-ttu-id="a829b-202">這很重要，因為它可讓您的 Cmdlet 用於非互動式腳本和主機。</span><span class="sxs-lookup"><span data-stu-id="a829b-202">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span> <span data-ttu-id="a829b-203">下列方法可由互動式主機來執行。</span><span class="sxs-lookup"><span data-stu-id="a829b-203">The following methods can be implemented by an interactive host.</span></span>

- [<span data-ttu-id="a829b-204">PSHostUserInterface。提示字元（\*）</span><span class="sxs-lookup"><span data-stu-id="a829b-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.Prompt)

- [<span data-ttu-id="a829b-205">Pshostuserinterface. PromptForChoice （系統管理）</span><span class="sxs-lookup"><span data-stu-id="a829b-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForChoice)

- [<span data-ttu-id="a829b-206">Ihostuisupportsmultiplechoiceselection. PromptForChoice （系統管理）</span><span class="sxs-lookup"><span data-stu-id="a829b-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.IHostUISupportsMultipleChoiceSelection.PromptForChoice)

- [<span data-ttu-id="a829b-207">System.web. Pshostuserinterface. PromptForCredential \*</span><span class="sxs-lookup"><span data-stu-id="a829b-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForCredential)

- [<span data-ttu-id="a829b-208">Pshostuserinterface. ReadLine \* 的 \*</span><span class="sxs-lookup"><span data-stu-id="a829b-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLine)

- [<span data-ttu-id="a829b-209">System.web. Pshostuserinterface. ReadLineAsSecureString \*</span><span class="sxs-lookup"><span data-stu-id="a829b-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLineAsSecureString)

### <a name="document-output-objects-rd06"></a><span data-ttu-id="a829b-210">檔輸出物件（RD06）</span><span class="sxs-lookup"><span data-stu-id="a829b-210">Document Output Objects (RD06)</span></span>

<span data-ttu-id="a829b-211">Windows PowerShell 會使用寫入管線的物件。</span><span class="sxs-lookup"><span data-stu-id="a829b-211">Windows PowerShell uses the objects that are written to the pipeline.</span></span> <span data-ttu-id="a829b-212">為了讓使用者能夠充分利用每個 Cmdlet 所傳回的物件，您必須記載傳回的物件，而且您必須記載這些傳回物件的成員會用於哪些內容。</span><span class="sxs-lookup"><span data-stu-id="a829b-212">In order for users to take advantage of the objects that are returned by each cmdlet, you must document the objects that are returned, and you must document what the members of those returned objects are used for.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="a829b-213">程式碼方針</span><span class="sxs-lookup"><span data-stu-id="a829b-213">Code Guidelines</span></span>

<span data-ttu-id="a829b-214">撰寫 Cmdlet 程式碼時，必須遵循下列指導方針。</span><span class="sxs-lookup"><span data-stu-id="a829b-214">The following guidelines must be followed when writing cmdlet code.</span></span> <span data-ttu-id="a829b-215">當您找到適用于您情況的程式碼指導方針時，請務必查看類似方針的設計方針。</span><span class="sxs-lookup"><span data-stu-id="a829b-215">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="derive-from-the-cmdlet-or-pscmdlet-classes-rc01"></a><span data-ttu-id="a829b-216">衍生自 Cmdlet 或 PSCmdlet 類別（RC01）</span><span class="sxs-lookup"><span data-stu-id="a829b-216">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>

<span data-ttu-id="a829b-217">Cmdlet 必須衍生自[PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)基類，或從系統. 管理[元件](/dotnet/api/System.Management.Automation.Cmdlet)衍生而來。</span><span class="sxs-lookup"><span data-stu-id="a829b-217">A cmdlet must derive from either the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) or [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="a829b-218">衍生自[system.object](/dotnet/api/System.Management.Automation.Cmdlet)類別的 Cmdlet 不會相依于 Windows PowerShell 執行時間。</span><span class="sxs-lookup"><span data-stu-id="a829b-218">Cmdlets that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class do not depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="a829b-219">可以直接從任何 Microsoft .NET Framework 語言呼叫。</span><span class="sxs-lookup"><span data-stu-id="a829b-219">They can be called directly from any Microsoft .NET Framework language.</span></span> <span data-ttu-id="a829b-220">衍生自[PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)類別的 Cmdlet 取決於 Windows PowerShell 執行時間。</span><span class="sxs-lookup"><span data-stu-id="a829b-220">Cmdlets that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="a829b-221">因此，它們會在運行空間內執行。</span><span class="sxs-lookup"><span data-stu-id="a829b-221">Therefore, they execute within a runspace.</span></span>

<span data-ttu-id="a829b-222">您所執行的所有 Cmdlet 類別都必須是公用類別。</span><span class="sxs-lookup"><span data-stu-id="a829b-222">All cmdlet classes that you implement must be public classes.</span></span> <span data-ttu-id="a829b-223">如需這些 Cmdlet 類別的詳細資訊，請參閱[Cmdlet 總覽](./cmdlet-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="a829b-223">For more information about these cmdlet classes, see [Cmdlet Overview](./cmdlet-overview.md).</span></span>

### <a name="specify-the-cmdlet-attribute-rc02"></a><span data-ttu-id="a829b-224">指定 Cmdlet 屬性（RC02）</span><span class="sxs-lookup"><span data-stu-id="a829b-224">Specify the Cmdlet Attribute (RC02)</span></span>

<span data-ttu-id="a829b-225">為了讓 Windows PowerShell 能夠辨識 Cmdlet，其 .NET Framework 類別必須以 Cmdlet 屬性裝飾。</span><span class="sxs-lookup"><span data-stu-id="a829b-225">For a cmdlet to be recognized by Windows PowerShell, its .NET Framework class must be decorated with the Cmdlet attribute.</span></span> <span data-ttu-id="a829b-226">這個屬性會指定 Cmdlet 的下列功能。</span><span class="sxs-lookup"><span data-stu-id="a829b-226">This attribute specifies the following features of the cmdlet.</span></span>

- <span data-ttu-id="a829b-227">識別 Cmdlet 的動詞和名詞配對。</span><span class="sxs-lookup"><span data-stu-id="a829b-227">The verb-and-noun pair that identifies the cmdlet.</span></span>

- <span data-ttu-id="a829b-228">當指定多個參數集時，所使用的預設參數集。</span><span class="sxs-lookup"><span data-stu-id="a829b-228">The default parameter set that is used when multiple parameter sets are specified.</span></span> <span data-ttu-id="a829b-229">當 Windows PowerShell 沒有足夠的資訊來判斷要使用哪個參數集時，會使用預設的參數集。</span><span class="sxs-lookup"><span data-stu-id="a829b-229">The default parameter set is used when Windows PowerShell does not have enough information to determine which parameter set to use.</span></span>

- <span data-ttu-id="a829b-230">指出此 Cmdlet 是否支援對[ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法的呼叫。</span><span class="sxs-lookup"><span data-stu-id="a829b-230">Indicates if the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="a829b-231">這個方法會在 Cmdlet 對系統進行變更之前，向使用者顯示確認訊息。</span><span class="sxs-lookup"><span data-stu-id="a829b-231">This method displays a confirmation message to the user before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="a829b-232">如需有關如何提出確認要求的詳細資訊，請參閱[要求確認](./requesting-confirmation-from-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="a829b-232">For more information about how confirmation requests are made, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

- <span data-ttu-id="a829b-233">指出與確認訊息相關聯之動作的影響層級（或嚴重性）。</span><span class="sxs-lookup"><span data-stu-id="a829b-233">Indicate the impact level (or severity) of the action associated with the confirmation message.</span></span> <span data-ttu-id="a829b-234">在大部分情況下，應該使用預設值 Medium。</span><span class="sxs-lookup"><span data-stu-id="a829b-234">In most cases, the default value of Medium should be used.</span></span> <span data-ttu-id="a829b-235">如需影響層級如何影響向使用者顯示的確認要求的詳細資訊，請參閱[要求確認](./requesting-confirmation-from-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="a829b-235">For more information about how the impact level affects the confirmation requests that are displayed to the user, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="a829b-236">如需如何宣告 Cmdlet 屬性的詳細資訊，請參閱[CmdletAttribute](./cmdlet-attribute-declaration.md)宣告。</span><span class="sxs-lookup"><span data-stu-id="a829b-236">For more information about how to declare the cmdlet attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="override-an-input-processing-method-rc03"></a><span data-ttu-id="a829b-237">覆寫輸入處理方法（RC03）</span><span class="sxs-lookup"><span data-stu-id="a829b-237">Override an Input Processing Method (RC03)</span></span>

<span data-ttu-id="a829b-238">若要讓 Cmdlet 參與 Windows PowerShell 環境，它必須至少覆寫下列其中一個*輸入處理方法*。</span><span class="sxs-lookup"><span data-stu-id="a829b-238">For the cmdlet to participate in the Windows PowerShell environment, it must override at least one of the following *input processing methods*.</span></span>

<span data-ttu-id="a829b-239">[BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)會呼叫這個方法一次，並使用它來提供前置處理功能。」</span><span class="sxs-lookup"><span data-stu-id="a829b-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) This method is called one time, and it is used to provide pre-processing functionality.</span></span>

<span data-ttu-id="a829b-240">[ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)會多次呼叫這個方法，而且它會用來提供記錄式的記錄功能。</span><span class="sxs-lookup"><span data-stu-id="a829b-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) This method is called multiple times, and it is used to provide record-by-record functionality.</span></span>

<span data-ttu-id="a829b-241">將會[呼叫這個方法](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)一次，並使用它來提供後置處理功能。</span><span class="sxs-lookup"><span data-stu-id="a829b-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) This method is called one time, and it is used to provide post-processing functionality.</span></span>

### <a name="specify-the-outputtype-attribute-rc04"></a><span data-ttu-id="a829b-242">指定 OutputType 屬性（RC04）</span><span class="sxs-lookup"><span data-stu-id="a829b-242">Specify the OutputType Attribute (RC04)</span></span>

<span data-ttu-id="a829b-243">OutputType 屬性（在 Windows PowerShell 2.0 中引進）會指定您的 Cmdlet 傳回給管線的 .NET Framework 類型。</span><span class="sxs-lookup"><span data-stu-id="a829b-243">The OutputType attribute (introduced in Windows PowerShell 2.0) specifies the .NET Framework type that your cmdlet returns to the pipeline.</span></span> <span data-ttu-id="a829b-244">藉由指定 Cmdlet 的輸出類型，您可以讓 Cmdlet 傳回的物件更容易被其他 Cmdlet 探索。</span><span class="sxs-lookup"><span data-stu-id="a829b-244">By specifying the output type of your cmdlets you make the objects returned by your cmdlet more discoverable by other cmdlets.</span></span> <span data-ttu-id="a829b-245">如需使用此屬性裝飾 Cmdlet 類別的詳細資訊，請參閱[OutputType 屬性](./outputtype-attribute-declaration.md)宣告。</span><span class="sxs-lookup"><span data-stu-id="a829b-245">For more information about decorating the cmdlet class with this attribute, see [OutputType Attribute Declaration](./outputtype-attribute-declaration.md).</span></span>

### <a name="do-not-retain-handles-to-output-objects-rc05"></a><span data-ttu-id="a829b-246">不要保留輸出物件的控制碼（RC05）</span><span class="sxs-lookup"><span data-stu-id="a829b-246">Do Not Retain Handles to Output Objects (RC05)</span></span>

<span data-ttu-id="a829b-247">您的 Cmdlet 不應保留傳遞至[WriteObject \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject)方法之物件的任何控制碼。</span><span class="sxs-lookup"><span data-stu-id="a829b-247">Your cmdlet should not retain any handles to the objects that are passed to the [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="a829b-248">這些物件會傳遞至管線中的下一個 Cmdlet，或由腳本使用。</span><span class="sxs-lookup"><span data-stu-id="a829b-248">These objects are passed to the next cmdlet in the pipeline, or they are used by a script.</span></span> <span data-ttu-id="a829b-249">如果您保留物件的控制碼，兩個實體會擁有每個物件，這會造成錯誤。</span><span class="sxs-lookup"><span data-stu-id="a829b-249">If you retain the handles to the objects, two entities will own each object, which causes errors.</span></span>

### <a name="handle-errors-robustly-rc06"></a><span data-ttu-id="a829b-250">穩定處理錯誤（RC06）</span><span class="sxs-lookup"><span data-stu-id="a829b-250">Handle Errors Robustly (RC06)</span></span>

<span data-ttu-id="a829b-251">系統管理環境原本就會偵測並對您所管理的系統進行重要變更。</span><span class="sxs-lookup"><span data-stu-id="a829b-251">An administration environment inherently detects and makes important changes to the system that you are administering.</span></span> <span data-ttu-id="a829b-252">因此，Cmdlet 會正確處理錯誤。</span><span class="sxs-lookup"><span data-stu-id="a829b-252">Therefore, it is vital that cmdlets handle errors correctly.</span></span> <span data-ttu-id="a829b-253">如需錯誤記錄的詳細資訊，請參閱[Windows PowerShell 錯誤報表](./error-reporting-concepts.md)。</span><span class="sxs-lookup"><span data-stu-id="a829b-253">For more information about error records, see [Windows PowerShell Error Reporting](./error-reporting-concepts.md).</span></span>

- <span data-ttu-id="a829b-254">當錯誤阻止 Cmdlet 繼續處理任何其他記錄時，就會發生終止錯誤。</span><span class="sxs-lookup"><span data-stu-id="a829b-254">When an error prevents a cmdlet from continuing to process any more records, it is a terminating error.</span></span> <span data-ttu-id="a829b-255">此 Cmdlet 必須呼叫[ThrowTerminatingError \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)方法，此方法會參考[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件，而此方法會參考。</span><span class="sxs-lookup"><span data-stu-id="a829b-255">The cmdlet must call the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="a829b-256">如果 Cmdlet 未攔截到例外狀況，Windows PowerShell 執行時間本身會擲回包含較少資訊的終止錯誤。</span><span class="sxs-lookup"><span data-stu-id="a829b-256">If an exception is not caught by the cmdlet, the Windows PowerShell runtime itself throws a terminating error that contains less information.</span></span>

- <span data-ttu-id="a829b-257">針對不會在來自管線的下一筆記錄（例如，由不同進程所產生的記錄）上停止作業的非終止錯誤，此 Cmdlet 必須呼叫[WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)方法，此方法會參考[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件的資訊。</span><span class="sxs-lookup"><span data-stu-id="a829b-257">For a non-terminating error that does not stop operation on the next record that is coming from the pipeline (for example, a record produced by a different process), the cmdlet must call the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="a829b-258">非終止錯誤的範例就是當特定進程無法停止時，所發生的錯誤。</span><span class="sxs-lookup"><span data-stu-id="a829b-258">An example of a non-terminating error is the error that occurs if a particular process fails to stop.</span></span> <span data-ttu-id="a829b-259">呼叫[WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)方法可讓使用者一致地執行所要求的動作，並保留特定動作失敗的資訊。</span><span class="sxs-lookup"><span data-stu-id="a829b-259">Calling the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method allows the user to consistently perform the actions requested and to retain the information for particular actions that fail.</span></span> <span data-ttu-id="a829b-260">您的 Cmdlet 應該盡可能獨立處理每一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="a829b-260">Your cmdlet should handle each record as independently as possible.</span></span>

- <span data-ttu-id="a829b-261">[ThrowTerminatingError \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)和[WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)方法所參考的[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件，在其核心時需要例外狀況（exception），而不會有例外狀況（exception）。</span><span class="sxs-lookup"><span data-stu-id="a829b-261">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that is referenced by the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) and [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) methods requires an exception at its core.</span></span> <span data-ttu-id="a829b-262">當您判斷要使用的例外狀況時，請遵循 .NET Framework 的設計方針。</span><span class="sxs-lookup"><span data-stu-id="a829b-262">Follow the .NET Framework design guidelines when you determine the exception to use.</span></span> <span data-ttu-id="a829b-263">如果錯誤在語義上與現有的例外狀況相同，請使用該例外狀況或衍生自該例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a829b-263">If the error is semantically the same as an existing exception, use that exception or derive from that exception.</span></span> <span data-ttu-id="a829b-264">否則，請直接從[system.exception 類型衍生](/dotnet/api/System.Exception)新的例外狀況或例外狀況階層。</span><span class="sxs-lookup"><span data-stu-id="a829b-264">Otherwise, derive a new exception or exception hierarchy directly from the [System.Exception](/dotnet/api/System.Exception) type.</span></span>

<span data-ttu-id="a829b-265">[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件也需要將使用者的錯誤分組的錯誤分類。</span><span class="sxs-lookup"><span data-stu-id="a829b-265">An [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object also requires an error category that groups errors for the user.</span></span> <span data-ttu-id="a829b-266">使用者可以將 `$ErrorView` shell 變數的值設定為 CategoryView，以根據類別來查看錯誤。</span><span class="sxs-lookup"><span data-stu-id="a829b-266">The user can view errors based on the category by setting the value of the `$ErrorView` shell variable to CategoryView.</span></span> <span data-ttu-id="a829b-267">可能的類別是由[ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory)列舉所定義。</span><span class="sxs-lookup"><span data-stu-id="a829b-267">The possible categories are defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span>

- <span data-ttu-id="a829b-268">如果 Cmdlet 會建立新的執行緒，而且如果在該執行緒中執行的程式碼擲回未處理的例外狀況，Windows PowerShell 將不會攔截錯誤，並會終止進程。</span><span class="sxs-lookup"><span data-stu-id="a829b-268">If a cmdlet creates a new thread, and if the code that is running in that thread throws an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span>

- <span data-ttu-id="a829b-269">如果物件在其析構函式中有程式碼造成未處理的例外狀況，Windows PowerShell 將不會攔截錯誤，並會終止進程。</span><span class="sxs-lookup"><span data-stu-id="a829b-269">If an object has code in its destructor that causes an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span> <span data-ttu-id="a829b-270">如果物件呼叫造成未處理例外狀況的 Dispose 方法，也會發生這種情況。</span><span class="sxs-lookup"><span data-stu-id="a829b-270">This also occurs if an object calls Dispose methods that cause an unhandled exception.</span></span>

### <a name="use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07"></a><span data-ttu-id="a829b-271">使用 Windows PowerShell 模組來部署您的 Cmdlet （RC07）</span><span class="sxs-lookup"><span data-stu-id="a829b-271">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>

<span data-ttu-id="a829b-272">建立 Windows PowerShell 模組來封裝和部署 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a829b-272">Create a Windows PowerShell module to package and deploy your cmdlets.</span></span> <span data-ttu-id="a829b-273">Windows PowerShell 2.0 中引進模組的支援。</span><span class="sxs-lookup"><span data-stu-id="a829b-273">Support for modules is introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="a829b-274">您可以直接使用包含 Cmdlet 類別的元件做為二進位模組檔案（這在測試 Cmdlet 時非常有用），或者您也可以建立參考 Cmdlet 元件的模組資訊清單。</span><span class="sxs-lookup"><span data-stu-id="a829b-274">You can use the assemblies that contain your cmdlet classes directly as binary module files (this is very useful when testing your cmdlets), or you can create a module manifest that references the cmdlet assemblies.</span></span> <span data-ttu-id="a829b-275">（使用模組時，您也可以新增現有的嵌入式管理單元元件）。如需模組的詳細資訊，請參閱[撰寫 Windows PowerShell 模組](../module/writing-a-windows-powershell-module.md)。</span><span class="sxs-lookup"><span data-stu-id="a829b-275">(You can also add existing snap-in assemblies when using modules.) For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="a829b-276">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a829b-276">See Also</span></span>

[<span data-ttu-id="a829b-277">強烈建議的開發指導方針</span><span class="sxs-lookup"><span data-stu-id="a829b-277">Strongly Encouraged Development Guidelines</span></span>](./strongly-encouraged-development-guidelines.md)

[<span data-ttu-id="a829b-278">諮詢開發指導方針</span><span class="sxs-lookup"><span data-stu-id="a829b-278">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="a829b-279">撰寫 Windows PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a829b-279">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
