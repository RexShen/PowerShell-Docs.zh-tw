---
title: Windows PowerShell 錯誤記錄 |Microsoft Docs
ms.date: 09/13/2016
helpviewer_keywords:
- error category [PowerShell SDK]
- error identifier [PowerShell SDK]
- error records [PowerShell SDK]
- error category string [PowerShell SDK]
ms.openlocfilehash: 52243916adf18b4f3a1e00f1fb4199c2619946e9
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/05/2020
ms.locfileid: "87783971"
---
# <a name="windows-powershell-error-records"></a><span data-ttu-id="b926e-102">Windows PowerShell 錯誤記錄</span><span class="sxs-lookup"><span data-stu-id="b926e-102">Windows PowerShell Error Records</span></span>

<span data-ttu-id="b926e-103">Cmdlet 必須傳遞[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件，以識別終止和非終止錯誤的錯誤狀況。</span><span class="sxs-lookup"><span data-stu-id="b926e-103">Cmdlets must pass an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that identifies the error condition for terminating and non-terminating errors.</span></span>

<span data-ttu-id="b926e-104">[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件會包含下列資訊：</span><span class="sxs-lookup"><span data-stu-id="b926e-104">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object contains the following information:</span></span>

- <span data-ttu-id="b926e-105">描述錯誤的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="b926e-105">The exception that describes the error.</span></span> <span data-ttu-id="b926e-106">通常，這是 Cmdlet 攔截並轉換成錯誤記錄的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="b926e-106">Often, this is an exception that the cmdlet caught and converted into an error record.</span></span> <span data-ttu-id="b926e-107">每個錯誤記錄都必須包含例外狀況。</span><span class="sxs-lookup"><span data-stu-id="b926e-107">Every error record must contain an exception.</span></span>

<span data-ttu-id="b926e-108">如果 Cmdlet 未攔截到例外狀況，則必須建立新的例外狀況，並選擇最能描述錯誤情況的例外狀況類別。</span><span class="sxs-lookup"><span data-stu-id="b926e-108">If the cmdlet did not catch an exception, it must create a new exception and choose the exception class that best describes the error condition.</span></span> <span data-ttu-id="b926e-109">不過，您不需要擲回例外狀況，因為它可以透過[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件的[ErrorRecord. exception](/dotnet/api/System.Management.Automation.ErrorRecord.Exception)屬性來加以存取的。</span><span class="sxs-lookup"><span data-stu-id="b926e-109">However, you do not need to throw the exception because it can be accessed through the [System.Management.Automation.ErrorRecord.Exception](/dotnet/api/System.Management.Automation.ErrorRecord.Exception) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

- <span data-ttu-id="b926e-110">提供目標指示項的錯誤識別碼，可用於診斷目的和 Windows PowerShell 腳本，以處理特定錯誤處理常式的特定錯誤狀況。</span><span class="sxs-lookup"><span data-stu-id="b926e-110">An error identifier that provides a targeted designator that can be used for diagnostic purposes and by Windows PowerShell scripts to handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="b926e-111">每個錯誤記錄都必須包含錯誤識別碼 (請參閱錯誤識別碼) 。</span><span class="sxs-lookup"><span data-stu-id="b926e-111">Every error record must contain an error identifier (see Error Identifier).</span></span>

- <span data-ttu-id="b926e-112">提供一般指示項的錯誤分類，可用於診斷目的。</span><span class="sxs-lookup"><span data-stu-id="b926e-112">An error category that provides a general designator that can be used for diagnostic purposes.</span></span> <span data-ttu-id="b926e-113">每個錯誤記錄都必須指定錯誤類別， (查看錯誤類別) 。</span><span class="sxs-lookup"><span data-stu-id="b926e-113">Every error record must specify an error category (see Error Category).</span></span>

- <span data-ttu-id="b926e-114">選擇性的取代錯誤訊息和建議的動作 (參閱取代錯誤訊息) 。</span><span class="sxs-lookup"><span data-stu-id="b926e-114">An optional replacement error message and a recommended action (see Replacement Error Message).</span></span>

- <span data-ttu-id="b926e-115">擲回錯誤之 Cmdlet 的選擇性調用資訊。</span><span class="sxs-lookup"><span data-stu-id="b926e-115">Optional invocation information about the cmdlet that threw the error.</span></span> <span data-ttu-id="b926e-116">這項資訊是由 Windows PowerShell 所指定 (請參閱調用訊息) 。</span><span class="sxs-lookup"><span data-stu-id="b926e-116">This information is specified by Windows PowerShell (see Invocation Message).</span></span>

- <span data-ttu-id="b926e-117">發生錯誤時正在處理的目標物件。</span><span class="sxs-lookup"><span data-stu-id="b926e-117">The target object that was being processed when the error occurred.</span></span> <span data-ttu-id="b926e-118">這可能是輸入物件，也可能是您的 Cmdlet 正在處理的另一個物件。</span><span class="sxs-lookup"><span data-stu-id="b926e-118">This might be the input object, or it might be another object that your cmdlet was processing.</span></span> <span data-ttu-id="b926e-119">例如，針對命令 `remove-item -recurse c:\somedirectory` ，錯誤可能是 "c:\somedirectory\lockedfile" 的 FileInfo 物件實例。</span><span class="sxs-lookup"><span data-stu-id="b926e-119">For example, for the command `remove-item -recurse c:\somedirectory`, the error might be an instance of a FileInfo object for "c:\somedirectory\lockedfile".</span></span> <span data-ttu-id="b926e-120">目標物件資訊是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="b926e-120">The target object information is optional.</span></span>

## <a name="error-identifier"></a><span data-ttu-id="b926e-121">錯誤識別碼</span><span class="sxs-lookup"><span data-stu-id="b926e-121">Error Identifier</span></span>

<span data-ttu-id="b926e-122">當您建立錯誤記錄時，請指定識別碼，以在您的 Cmdlet 中指定錯誤狀況。</span><span class="sxs-lookup"><span data-stu-id="b926e-122">When you create an error record, specify an identifier that designates the error condition within your cmdlet.</span></span> <span data-ttu-id="b926e-123">Windows PowerShell 會將目標識別碼與您的 Cmdlet 名稱結合，以建立完整的錯誤識別碼。</span><span class="sxs-lookup"><span data-stu-id="b926e-123">Windows PowerShell combines the targeted identifier with the name of your cmdlet to create a fully qualified error identifier.</span></span> <span data-ttu-id="b926e-124">您可以透過[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件的[ErrorRecord. FullyQualifiedErrorId](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId)屬性來存取完整的錯誤識別碼（error identifier）。</span><span class="sxs-lookup"><span data-stu-id="b926e-124">The fully qualified error identifier can be accessed through the [System.Management.Automation.ErrorRecord.FullyQualifiedErrorId](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="b926e-125">錯誤識別碼本身無法使用。</span><span class="sxs-lookup"><span data-stu-id="b926e-125">The error identifier is not available by itself.</span></span> <span data-ttu-id="b926e-126">它僅適用于完整錯誤識別碼的一部分。</span><span class="sxs-lookup"><span data-stu-id="b926e-126">It is available only as part of the fully qualified error identifier.</span></span>

<span data-ttu-id="b926e-127">當您建立錯誤記錄時，請使用下列指導方針來產生錯誤識別碼：</span><span class="sxs-lookup"><span data-stu-id="b926e-127">Use the following guidelines to generate error identifiers when you create error records:</span></span>

- <span data-ttu-id="b926e-128">將錯誤識別碼特定于錯誤狀況。</span><span class="sxs-lookup"><span data-stu-id="b926e-128">Make error identifiers specific to an error condition.</span></span> <span data-ttu-id="b926e-129">針對診斷用途，以及處理具有特定錯誤處理常式之特定錯誤狀況的腳本，鎖定錯誤識別碼。</span><span class="sxs-lookup"><span data-stu-id="b926e-129">Target the error identifiers for diagnostic purposes and for scripts that handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="b926e-130">使用者應該能夠使用錯誤識別碼來識別錯誤及其來源。</span><span class="sxs-lookup"><span data-stu-id="b926e-130">A user should be able to use the error identifier to identify the error and its source.</span></span> <span data-ttu-id="b926e-131">錯誤識別碼也會從現有的例外狀況中針對特定的錯誤情況啟用報告，因此不需要新的例外子類別。</span><span class="sxs-lookup"><span data-stu-id="b926e-131">Error identifiers also enable reporting for specific error conditions from existing exceptions so that new exception subclasses are not required.</span></span>

- <span data-ttu-id="b926e-132">一般來說，請將不同的錯誤識別碼指派給不同的程式碼路徑。</span><span class="sxs-lookup"><span data-stu-id="b926e-132">In general, assign different error identifiers to different code paths.</span></span> <span data-ttu-id="b926e-133">使用者會受益于特定識別碼。</span><span class="sxs-lookup"><span data-stu-id="b926e-133">The end-user benefits from specific identifiers.</span></span> <span data-ttu-id="b926e-134">通常，每個呼叫[WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或[Throwterminatingerror \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)的程式碼路徑都有它自己的識別碼（identifier）。</span><span class="sxs-lookup"><span data-stu-id="b926e-134">Often, each code path that calls [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) has its own identifier.</span></span> <span data-ttu-id="b926e-135">作為規則，當您為錯誤訊息定義新的範本字串時，請定義新的識別碼，反之亦然。</span><span class="sxs-lookup"><span data-stu-id="b926e-135">As a rule, define a new identifier when you define a new template string for the error message, and vice-versa.</span></span> <span data-ttu-id="b926e-136">請勿使用錯誤訊息做為識別碼。</span><span class="sxs-lookup"><span data-stu-id="b926e-136">Do not use the error message as an identifier.</span></span>

- <span data-ttu-id="b926e-137">當您使用特定的錯誤識別碼發行程式碼時，您可以使用該識別碼來建立錯誤的語義，以提供完整的產品支援週期。</span><span class="sxs-lookup"><span data-stu-id="b926e-137">When you publish code using a particular error identifier, you establish the semantics of errors with that identifier for your complete product support lifecycle.</span></span> <span data-ttu-id="b926e-138">請勿在語義上與原始內容不同的內容中重複使用它。</span><span class="sxs-lookup"><span data-stu-id="b926e-138">Do not reuse it in a context that is semantically different from the original context.</span></span> <span data-ttu-id="b926e-139">如果此錯誤的語義變更，請建立，然後使用新的識別碼。</span><span class="sxs-lookup"><span data-stu-id="b926e-139">If the semantics of this error change, create and then use a new identifier.</span></span>

- <span data-ttu-id="b926e-140">一般來說，您應該只針對特定 CLR 類型的例外狀況使用特定的錯誤識別碼。</span><span class="sxs-lookup"><span data-stu-id="b926e-140">You should generally use a particular error identifier only for exceptions of a particular CLR type.</span></span> <span data-ttu-id="b926e-141">如果例外狀況的類型或目標物件的類型變更，請建立，然後使用新的識別碼。</span><span class="sxs-lookup"><span data-stu-id="b926e-141">If the type of the exception or the type of the target object changes, create and then use a new identifier.</span></span>

- <span data-ttu-id="b926e-142">選擇您的錯誤識別碼文字，以簡明地對應至您所報告的錯誤。</span><span class="sxs-lookup"><span data-stu-id="b926e-142">Choose text for your error identifier that concisely corresponds to the error that you are reporting.</span></span> <span data-ttu-id="b926e-143">使用標準 .NET Framework 命名和大小寫慣例。</span><span class="sxs-lookup"><span data-stu-id="b926e-143">Use standard .NET Framework naming and capitalization conventions.</span></span> <span data-ttu-id="b926e-144">請勿使用空白字元或標點符號。</span><span class="sxs-lookup"><span data-stu-id="b926e-144">Do not use white space or punctuation.</span></span> <span data-ttu-id="b926e-145">請勿將錯誤識別碼當地語系化。</span><span class="sxs-lookup"><span data-stu-id="b926e-145">Do not localize error identifiers.</span></span>

- <span data-ttu-id="b926e-146">請勿以不可重現的方式動態產生錯誤識別碼。</span><span class="sxs-lookup"><span data-stu-id="b926e-146">Do not dynamically generate error identifiers in a non-reproducible way.</span></span> <span data-ttu-id="b926e-147">例如，請勿併入錯誤資訊，例如處理序識別碼。</span><span class="sxs-lookup"><span data-stu-id="b926e-147">For example, do not incorporate error information such as a process ID.</span></span> <span data-ttu-id="b926e-148">只有當錯誤識別碼對應至其他遇到相同錯誤狀況的使用者所看到的錯誤識別碼時，才有用。</span><span class="sxs-lookup"><span data-stu-id="b926e-148">Error identifiers are useful only if they correspond to the error identifiers seen by other users who are experiencing the same error condition.</span></span>

## <a name="error-category"></a><span data-ttu-id="b926e-149">錯誤類別</span><span class="sxs-lookup"><span data-stu-id="b926e-149">Error Category</span></span>

<span data-ttu-id="b926e-150">當您建立錯誤記錄時，請使用[ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)列舉所定義的其中一個常數來指定錯誤的類別。</span><span class="sxs-lookup"><span data-stu-id="b926e-150">When you create an error record, specify the category of the error using one of the constants defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) enumeration.</span></span> <span data-ttu-id="b926e-151">當使用者將變數設定為時，Windows PowerShell 會使用錯誤類別來顯示錯誤資訊 `$ErrorView` `"CategoryView"` 。</span><span class="sxs-lookup"><span data-stu-id="b926e-151">Windows PowerShell uses the error category to display error information when users set the `$ErrorView` variable to `"CategoryView"`.</span></span>

<span data-ttu-id="b926e-152">避免使用[ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) **NotSpecified**常數。</span><span class="sxs-lookup"><span data-stu-id="b926e-152">Avoid using the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) **NotSpecified** constant.</span></span> <span data-ttu-id="b926e-153">如果您有任何有關錯誤或造成錯誤之作業的資訊，請選擇最能描述錯誤或作業的類別，即使類別不是完全相符。</span><span class="sxs-lookup"><span data-stu-id="b926e-153">If you have any information about the error or about the operation that caused the error, choose the category that best describes the error or the operation, even if the category is not a perfect match.</span></span>

<span data-ttu-id="b926e-154">Windows PowerShell 所顯示的資訊稱為類別目錄檢視字串，並是從[Errorcategoryinfo](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)類別的屬性所建立。</span><span class="sxs-lookup"><span data-stu-id="b926e-154">The information displayed by Windows PowerShell is referred to as the category-view string and is built from the properties of the [System.Management.Automation.Errorcategoryinfo](/dotnet/api/System.Management.Automation.ErrorCategoryInfo) class.</span></span> <span data-ttu-id="b926e-155"> (這個類別會透過[ErrorRecord. CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo)屬性來存取。 ) </span><span class="sxs-lookup"><span data-stu-id="b926e-155">(This class is accessed through the error [System.Management.Automation.ErrorRecord.CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo) property.)</span></span>

```
{Category}: ({TargetName}:{TargetType}):[{Activity}], {Reason}
```

<span data-ttu-id="b926e-156">下列清單說明顯示的資訊：</span><span class="sxs-lookup"><span data-stu-id="b926e-156">The following list describes the information displayed:</span></span>

- <span data-ttu-id="b926e-157">Category： Windows PowerShell 定義的[ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)常數。</span><span class="sxs-lookup"><span data-stu-id="b926e-157">Category: A Windows PowerShell-defined [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) constant.</span></span>

- <span data-ttu-id="b926e-158">TargetName：根據預設，當發生錯誤時，Cmdlet 正在處理的物件名稱。</span><span class="sxs-lookup"><span data-stu-id="b926e-158">TargetName: By default, the name of the object the cmdlet was processing when the error occurred.</span></span> <span data-ttu-id="b926e-159">或者，另一個 Cmdlet 定義的字串。</span><span class="sxs-lookup"><span data-stu-id="b926e-159">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="b926e-160">TargetType：根據預設，目標物件的類型。</span><span class="sxs-lookup"><span data-stu-id="b926e-160">TargetType: By default, the type of the target object.</span></span> <span data-ttu-id="b926e-161">或者，另一個 Cmdlet 定義的字串。</span><span class="sxs-lookup"><span data-stu-id="b926e-161">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="b926e-162">活動：根據預設，建立錯誤記錄的 Cmdlet 名稱。</span><span class="sxs-lookup"><span data-stu-id="b926e-162">Activity: By default, the name of the cmdlet that created the error record.</span></span> <span data-ttu-id="b926e-163">或者，其他 Cmdlet 定義的字串。</span><span class="sxs-lookup"><span data-stu-id="b926e-163">Or, some other cmdlet-defined string.</span></span>

- <span data-ttu-id="b926e-164">原因：根據預設，例外狀況類型。</span><span class="sxs-lookup"><span data-stu-id="b926e-164">Reason: By default, the exception type.</span></span> <span data-ttu-id="b926e-165">或者，另一個 Cmdlet 定義的字串。</span><span class="sxs-lookup"><span data-stu-id="b926e-165">Or, another cmdlet-defined string.</span></span>

## <a name="replacement-error-message"></a><span data-ttu-id="b926e-166">取代錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="b926e-166">Replacement Error Message</span></span>

<span data-ttu-id="b926e-167">當您開發 Cmdlet 的錯誤記錄時，錯誤的預設錯誤訊息是來自[system.object](/dotnet/api/System.Exception.Message)屬性中的預設郵件內文。</span><span class="sxs-lookup"><span data-stu-id="b926e-167">When you develop an error record for a cmdlet, the default error message for the error comes from the default message text in the [System.Exception.Message](/dotnet/api/System.Exception.Message) property.</span></span> <span data-ttu-id="b926e-168">這是唯讀屬性，其郵件內文僅供偵錯工具使用， (根據 .NET Framework 方針) 。</span><span class="sxs-lookup"><span data-stu-id="b926e-168">This is a read-only property whose message text is intended only for debugging purposes (according to the .NET Framework guidelines).</span></span> <span data-ttu-id="b926e-169">我們建議您建立一個錯誤訊息，以取代或擴大預設郵件內文。</span><span class="sxs-lookup"><span data-stu-id="b926e-169">We recommend that you create an error message that replaces or augments the default message text.</span></span> <span data-ttu-id="b926e-170">讓訊息更方便使用者易懂，並更明確地提供給 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="b926e-170">Make the message more user-friendly and more specific to the cmdlet.</span></span>

<span data-ttu-id="b926e-171">取代訊息是由[ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails)物件所提供。</span><span class="sxs-lookup"><span data-stu-id="b926e-171">The replacement message is provided by an [System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails) object.</span></span> <span data-ttu-id="b926e-172">請使用此物件的下列其中一個函式，因為它們會提供可供 Windows PowerShell 使用的其他當地語系化資訊。</span><span class="sxs-lookup"><span data-stu-id="b926e-172">Use one of the following constructors of this object because they provide additional localization information that can be used by Windows PowerShell.</span></span>

- <span data-ttu-id="b926e-173">[ErrorDetails (Cmdlet、string、string、Object [] ) ](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Management_Automation_Cmdlet_System_String_System_String_System_Object___)：如果您的範本字串是在執行 Cmdlet 所在的相同元件中的資源字串，或您想要透過[GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)方法的覆寫載入範本字串，請使用這個函式。</span><span class="sxs-lookup"><span data-stu-id="b926e-173">[ErrorDetails(Cmdlet, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Management_Automation_Cmdlet_System_String_System_String_System_Object___): Use this constructor if your template string is a resource string in the same assembly in which the cmdlet is implemented or if you want to load the template string through an override of the  [System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString) method.</span></span>

- <span data-ttu-id="b926e-174">[ErrorDetails (Assembly、string、string、Object [] ) ](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Reflection_Assembly_System_String_System_String_System_Object___)：如果範本字串位於另一個元件中，而您未透過[GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)的覆寫載入它，請使用這個函式。</span><span class="sxs-lookup"><span data-stu-id="b926e-174">[ErrorDetails(Assembly, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Reflection_Assembly_System_String_System_String_System_Object___): Use this constructor if the template string is in another assembly and you do not load it through an override of [System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString).</span></span>

<span data-ttu-id="b926e-175">取代訊息應符合 .NET Framework 的設計指導方針，可讓您以較小的差異來撰寫例外狀況訊息。</span><span class="sxs-lookup"><span data-stu-id="b926e-175">The replacement message should conform to the .NET Framework design guidelines for writing exception messages with a small difference.</span></span> <span data-ttu-id="b926e-176">指導方針說明應該為開發人員撰寫例外狀況訊息。</span><span class="sxs-lookup"><span data-stu-id="b926e-176">The guidelines state that exception messages should be written for developers.</span></span> <span data-ttu-id="b926e-177">應該為 Cmdlet 使用者撰寫這些取代訊息。</span><span class="sxs-lookup"><span data-stu-id="b926e-177">These replacement messages should be written for the cmdlet user.</span></span>

<span data-ttu-id="b926e-178">您必須在呼叫[WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或[Throwterminatingerror \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)方法之前，先新增取代錯誤訊息，然後再加以加入。</span><span class="sxs-lookup"><span data-stu-id="b926e-178">The replacement error message must be added before the [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) methods are called.</span></span> <span data-ttu-id="b926e-179">若要新增取代訊息，請設定錯誤記錄的[ErrorRecord. ErrorDetails](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails)屬性。</span><span class="sxs-lookup"><span data-stu-id="b926e-179">To add a replacement message, set the [System.Management.Automation.ErrorRecord.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails) property of the error record.</span></span> <span data-ttu-id="b926e-180">設定此屬性時，Windows PowerShell 會顯示[ErrorDetails \*](/dotnet/api/System.Management.Automation.ErrorDetails.Message)屬性，而不是預設郵件內文。</span><span class="sxs-lookup"><span data-stu-id="b926e-180">When this property is set, Windows PowerShell displays the [System.Management.Automation.ErrorDetails.Message\*](/dotnet/api/System.Management.Automation.ErrorDetails.Message) property instead of the default message text.</span></span>

## <a name="recommended-action-information"></a><span data-ttu-id="b926e-181">建議的動作資訊</span><span class="sxs-lookup"><span data-stu-id="b926e-181">Recommended Action Information</span></span>

<span data-ttu-id="b926e-182">[ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails)物件也可以提供錯誤發生時建議哪些動作的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="b926e-182">The [System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails) object can also provide information about what actions are recommended when the error occurs.</span></span>

## <a name="invocation-information"></a><span data-ttu-id="b926e-183">調用資訊</span><span class="sxs-lookup"><span data-stu-id="b926e-183">Invocation information</span></span>

<span data-ttu-id="b926e-184">當 Cmdlet 使用[WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或[Throwterminatingerror \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)來報告錯誤記錄時，Windows PowerShell 會自動新增資訊，以描述發生錯誤時所叫用的命令，而不會有問題。</span><span class="sxs-lookup"><span data-stu-id="b926e-184">When a cmdlet uses [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) to report an error record, Windows PowerShell automatically adds information that describes the command that was invoked when the error occurred.</span></span> <span data-ttu-id="b926e-185">這項資訊是由[Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo)物件所提供，其中包含命令所叫用的 Cmdlet 名稱、命令本身，以及管線或腳本的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="b926e-185">This information is provided by a [System.Management.Automation.Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo) object that contains the name of the cmdlet that was invoked by the command, the command itself, and information about the pipeline or script.</span></span> <span data-ttu-id="b926e-186">這個屬性是唯讀的。</span><span class="sxs-lookup"><span data-stu-id="b926e-186">This property is read-only.</span></span>

## <a name="see-also"></a><span data-ttu-id="b926e-187">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b926e-187">See Also</span></span>

[<span data-ttu-id="b926e-188">WriteError 的管理元件</span><span class="sxs-lookup"><span data-stu-id="b926e-188">System.Management.Automation.Cmdlet.WriteError</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)

[<span data-ttu-id="b926e-189">Throwterminatingerror \* 的 \*</span><span class="sxs-lookup"><span data-stu-id="b926e-189">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)

[<span data-ttu-id="b926e-190">ErrorCategory。</span><span class="sxs-lookup"><span data-stu-id="b926e-190">System.Management.Automation.ErrorCategory</span></span>](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)

[<span data-ttu-id="b926e-191">Errorcategoryinfo。</span><span class="sxs-lookup"><span data-stu-id="b926e-191">System.Management.Automation.Errorcategoryinfo</span></span>](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)

[<span data-ttu-id="b926e-192">ErrorRecord。</span><span class="sxs-lookup"><span data-stu-id="b926e-192">System.Management.Automation.ErrorRecord</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord)

[<span data-ttu-id="b926e-193">ErrorDetails。</span><span class="sxs-lookup"><span data-stu-id="b926e-193">System.Management.Automation.ErrorDetails</span></span>](/dotnet/api/System.Management.Automation.ErrorDetails)

[<span data-ttu-id="b926e-194">Invocationinfo。</span><span class="sxs-lookup"><span data-stu-id="b926e-194">System.Management.Automation.Invocationinfo</span></span>](/dotnet/api/System.Management.Automation.InvocationInfo)

[<span data-ttu-id="b926e-195">Windows PowerShell 錯誤報告</span><span class="sxs-lookup"><span data-stu-id="b926e-195">Windows PowerShell Error Reporting</span></span>](./error-reporting-concepts.md)

[<span data-ttu-id="b926e-196">撰寫 Windows PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="b926e-196">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
