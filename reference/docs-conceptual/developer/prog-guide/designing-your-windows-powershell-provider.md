---
title: 設計您的 Windows PowerShell 提供者 |Microsoft Docs
ms.date: 09/13/2016
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], designing
ms.openlocfilehash: dec6c71a2d7bbe5636f96dc140e701213d6f6487
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/05/2020
ms.locfileid: "87778932"
---
# <a name="designing-your-windows-powershell-provider"></a><span data-ttu-id="6c8b5-102">設計 Windows PowerShell 提供者</span><span class="sxs-lookup"><span data-stu-id="6c8b5-102">Designing Your Windows PowerShell Provider</span></span>

<span data-ttu-id="6c8b5-103">如果您的產品或設定會公開一組已儲存的資料（例如，使用者想要流覽或流覽的資料庫），您應該執行 Windows PowerShell 提供者。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-103">You should implement a Windows PowerShell provider if your product or configuration exposes a set of stored data, such as a database that the user will want to navigate or browse.</span></span> <span data-ttu-id="6c8b5-104">此外，如果您的產品提供容器，即使它不是多層容器，還是要執行 Windows PowerShell 提供者是合理的。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-104">Additionally, if your product provides a container, even if it is not a multilevel container, it makes sense to implement a Windows PowerShell provider.</span></span> <span data-ttu-id="6c8b5-105">例如，如果 Cmdlet 動詞複製、移動、重新命名、新增或移除對您產品或設定資料的作業有意義，您可能會想要執行 Windows PowerShell 容器提供者。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-105">For example, you might want to implement a Windows PowerShell container provider if the cmdlet verb Copy, Move, Rename, New, or Remove makes sense as an operation on your product or configuration data.</span></span>

## <a name="windows-powershell-paths-identify-your-provider"></a><span data-ttu-id="6c8b5-106">識別您提供者的 Windows PowerShell 路徑</span><span class="sxs-lookup"><span data-stu-id="6c8b5-106">Windows PowerShell Paths Identify Your Provider</span></span>

<span data-ttu-id="6c8b5-107">Windows PowerShell 執行時間會使用 Windows PowerShell 路徑來存取適當的 Windows PowerShell 提供者。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-107">The Windows PowerShell runtime uses Windows PowerShell paths to access the appropriate Windows PowerShell provider.</span></span> <span data-ttu-id="6c8b5-108">當 Cmdlet 指定其中一個路徑時，執行時間會知道要使用哪個提供者來存取相關聯的資料存放區。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-108">When a cmdlet specifies one of these paths, the runtime knows which provider to use to access the associated data store.</span></span> <span data-ttu-id="6c8b5-109">這些路徑包括磁片磁碟機限定路徑、提供者限定路徑、提供者直接路徑和提供者內部路徑。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-109">These paths include drive-qualified paths, provider-qualified paths, provider-direct paths, and provider-internal paths.</span></span> <span data-ttu-id="6c8b5-110">每個 Windows PowerShell 提供者都必須支援其中一或多個路徑。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-110">Each Windows PowerShell provider must support one or more of these paths.</span></span>

<span data-ttu-id="6c8b5-111">如需 Windows PowerShell 路徑的詳細資訊，請參閱 Windows PowerShell 的運作方式。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-111">For more information about Windows PowerShell paths, see How Windows PowerShell Works.</span></span>

### <a name="defining-a-drive-qualified-path"></a><span data-ttu-id="6c8b5-112">定義磁片磁碟機限定路徑</span><span class="sxs-lookup"><span data-stu-id="6c8b5-112">Defining a Drive-Qualified Path</span></span>

<span data-ttu-id="6c8b5-113">若要允許使用者存取位於實體磁片磁碟機上的資料，您的 Windows PowerShell 提供者必須支援磁片磁碟機限定路徑。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-113">To allow the user to access data located at a physical drive, your Windows PowerShell provider must support a drive-qualified path.</span></span> <span data-ttu-id="6c8b5-114">這個路徑的開頭是磁片磁碟機名稱，後面接著冒號 (： ) ，例如 mydrive： \ abc\bar。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-114">This path starts with the drive name followed by a colon (:), for example, mydrive:\abc\bar.</span></span>

### <a name="defining-a-provider-qualified-path"></a><span data-ttu-id="6c8b5-115">定義提供者限定路徑</span><span class="sxs-lookup"><span data-stu-id="6c8b5-115">Defining a Provider-Qualified Path</span></span>

<span data-ttu-id="6c8b5-116">若要允許 Windows PowerShell 執行時間初始化和取消初始化提供者，您的 Windows PowerShell 提供者必須支援提供者限定的路徑。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-116">To allow the Windows PowerShell runtime to initialize and uninitialize the provider, your Windows PowerShell provider must support a provider-qualified path.</span></span> <span data-ttu-id="6c8b5-117">例如，FileSystem：： \\ \uncshare\abc\bar 是 Windows PowerShell 所提供之 filesystem 提供者的提供者完整路徑。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-117">For example, FileSystem::\\\uncshare\abc\bar is the provider-qualified path for the filesystem provider furnished by Windows PowerShell.</span></span>

### <a name="defining-a-provider-direct-path"></a><span data-ttu-id="6c8b5-118">定義提供者-直接路徑</span><span class="sxs-lookup"><span data-stu-id="6c8b5-118">Defining a Provider-Direct Path</span></span>

<span data-ttu-id="6c8b5-119">若要允許遠端存取您的 Windows PowerShell 提供者，它應該支援提供者直接路徑，以直接傳遞給目前位置的 Windows PowerShell 提供者。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-119">To allow remote access to your Windows PowerShell provider, it should support a provider-direct path to pass directly to the Windows PowerShell provider for the current location.</span></span> <span data-ttu-id="6c8b5-120">例如，登錄 Windows PowerShell 提供者可以使用 \\ \server\regkeypath 做為提供者直接路徑。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-120">For example, the registry Windows PowerShell provider can use \\\server\regkeypath as a provider-direct path.</span></span>

### <a name="defining-a-provider-internal-path"></a><span data-ttu-id="6c8b5-121">定義提供者內部路徑</span><span class="sxs-lookup"><span data-stu-id="6c8b5-121">Defining a Provider-Internal Path</span></span>

<span data-ttu-id="6c8b5-122">若要允許 provider Cmdlet 使用非 Windows PowerShell 應用程式開發介面來存取資料 (Api) ，您的 Windows PowerShell 提供者應該支援提供者內部路徑。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-122">To allow the provider cmdlet to access data using non-Windows PowerShell application programming interfaces (APIs), your Windows PowerShell provider should support a provider-internal path.</span></span> <span data-ttu-id="6c8b5-123">此路徑會在提供者限定路徑中的 "：：" 之後指出。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-123">This path is indicated after the "::" in the provider-qualified path.</span></span> <span data-ttu-id="6c8b5-124">例如，filesystem Windows PowerShell 提供者的提供者內部路徑為 \\ \uncshare\abc\bar。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-124">For example, the provider-internal path for the filesystem Windows PowerShell provider is \\\uncshare\abc\bar.</span></span>

## <a name="changing-stored-data"></a><span data-ttu-id="6c8b5-125">變更儲存的資料</span><span class="sxs-lookup"><span data-stu-id="6c8b5-125">Changing Stored Data</span></span>

<span data-ttu-id="6c8b5-126">覆寫修改基礎資料存放區的方法時，請一律呼叫[Cmdletprovider. Writeitemobject \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject)方法，其中包含該方法所變更之專案的最新版本。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-126">When overriding methods that modify the underlying data store, always call the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method with the most up-to-date version of the item changed by that method.</span></span> <span data-ttu-id="6c8b5-127">提供者基礎結構會判斷是否需要將專案物件傳遞至管線，例如當使用者指定-PassThru 參數時。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-127">The provider infrastructure determines if the item object needs to be passed to the pipeline, such as when the user specifies the -PassThru parameter.</span></span> <span data-ttu-id="6c8b5-128">如果抓取最新的專案是高成本的作業 (效能，) 您可以測試內容。 PassThru 屬性來判斷您是否真的需要寫入產生的專案。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-128">If retrieving the most up-to-date item is a costly operation (performance-wise,) you can test the Context.PassThru property to determine if you actually need to write the resulting item.</span></span>

## <a name="choose-a-base-class-for-your-provider"></a><span data-ttu-id="6c8b5-129">為您的提供者選擇基類</span><span class="sxs-lookup"><span data-stu-id="6c8b5-129">Choose a Base Class for Your Provider</span></span>

<span data-ttu-id="6c8b5-130">Windows PowerShell 提供數個基類，可讓您用來執行自己的 Windows PowerShell 提供者。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-130">Windows PowerShell provides a number of base classes that you can use to implement your own Windows PowerShell provider.</span></span> <span data-ttu-id="6c8b5-131">設計提供者時，請選擇本節中所述的基類，此類別最適合您的需求。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-131">When designing a provider, choose the base class, described in this section, that is most suited to your requirements.</span></span>

<span data-ttu-id="6c8b5-132">每個 Windows PowerShell 提供者基類都會提供一組 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-132">Each Windows PowerShell provider base class makes available a set of cmdlets.</span></span> <span data-ttu-id="6c8b5-133">本節說明 Cmdlet，但不會描述其參數。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-133">This section describes the cmdlets, but it does not describe their parameters.</span></span>

<span data-ttu-id="6c8b5-134">使用會話狀態時，windows powershell 執行時間會針對特定的 Windows powershell 提供者（例如 `Get-Location` 、 `Set-Location` 、 `Pop-Location` 和 Cmdlet）提供數個位置 Cmdlet `Push-Location` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-134">Using the session state, the Windows PowerShell runtime makes several location cmdlets available to certain Windows PowerShell providers, such as the `Get-Location`, `Set-Location`, `Pop-Location`, and `Push-Location` cmdlets.</span></span> <span data-ttu-id="6c8b5-135">您可以使用 `Get-Help` Cmdlet 來取得這些 location Cmdlet 的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-135">You can use the `Get-Help` cmdlet to obtain information about these location cmdlets.</span></span>

### <a name="cmdletprovider-base-class"></a><span data-ttu-id="6c8b5-136">CmdletProvider 基類</span><span class="sxs-lookup"><span data-stu-id="6c8b5-136">CmdletProvider Base Class</span></span>

<span data-ttu-id="6c8b5-137">[Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider)類別會定義基本的 Windows PowerShell 提供者。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-137">The [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) class defines a basic Windows PowerShell provider.</span></span> <span data-ttu-id="6c8b5-138">這個類別支援提供者宣告，並提供一些可供所有 Windows PowerShell 提供者使用的屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-138">This class supports the provider declaration and supplies a number of properties and methods that are available to all Windows PowerShell providers.</span></span>
<span data-ttu-id="6c8b5-139">Cmdlet 會叫用類別， `Get-PSProvider` 以列出會話的所有可用提供者。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-139">The class is invoked by the `Get-PSProvider` cmdlet to list all available providers for a session.</span></span>
<span data-ttu-id="6c8b5-140">此 Cmdlet 的執行是由會話狀態所提供。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-140">The implementation of this cmdlet is furnished by the session state.</span></span>

> [!NOTE]
> <span data-ttu-id="6c8b5-141">Windows PowerShell 提供者可供所有 Windows PowerShell 語言範圍使用。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-141">Windows PowerShell providers are available to all Windows PowerShell language scopes.</span></span>

### <a name="drivecmdletprovider-base-class"></a><span data-ttu-id="6c8b5-142">DriveCmdletProvider 基類</span><span class="sxs-lookup"><span data-stu-id="6c8b5-142">DriveCmdletProvider Base Class</span></span>

<span data-ttu-id="6c8b5-143">[DriveCmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider)類別會定義 Windows PowerShell 磁片磁碟機提供者，它支援新增新磁片磁碟機、移除現有磁片磁碟機，以及初始化預設磁片磁碟機的作業。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-143">The [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class defines a Windows PowerShell drive provider that supports operations for adding new drives, removing existing drives, and initializing default drives.</span></span> <span data-ttu-id="6c8b5-144">例如，Windows PowerShell 提供的 FileSystem 提供者會針對所有掛接的磁片區（例如硬碟機和 CD/DVD 裝置磁片磁碟機）初始化磁片磁碟機。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-144">For example, the FileSystem provider provided by Windows PowerShell initializes drives for all volumes that are mounted, such as hard drives and CD/DVD device drives.</span></span>

<span data-ttu-id="6c8b5-145">這個類別是衍生自[Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider)基類的。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-145">This class derives from the [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class.</span></span> <span data-ttu-id="6c8b5-146">下表列出這個類別所公開的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-146">The following table lists the cmdlets exposed by this class.</span></span> <span data-ttu-id="6c8b5-147">除了列出的指令程式以外， `Get-PSDrive` Cmdlet (由會話狀態公開) 是用來取出可用磁片磁碟機的相關 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-147">In addition to those listed, the `Get-PSDrive` cmdlet (exposed by session state) is a related cmdlet that is used to retrieve available drives.</span></span>

|      <span data-ttu-id="6c8b5-148">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="6c8b5-148">Cmdlet</span></span>      |                             <span data-ttu-id="6c8b5-149">定義</span><span class="sxs-lookup"><span data-stu-id="6c8b5-149">Definition</span></span>                              |
| ---------------- | ------------------------------------------------------------------- |
| `New-PSDrive`    | <span data-ttu-id="6c8b5-150">為會話建立新的磁片磁碟機，並串流磁片磁碟機資訊。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-150">Creates a new drive for the session, and streams drive information.</span></span> |
| `Remove-PSDrive` | <span data-ttu-id="6c8b5-151">從會話中移除磁片磁碟機。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-151">Removes a drive from the session.</span></span>                                   |

### <a name="itemcmdletprovider-base-class"></a><span data-ttu-id="6c8b5-152">ItemCmdletProvider 基類</span><span class="sxs-lookup"><span data-stu-id="6c8b5-152">ItemCmdletProvider Base Class</span></span>

<span data-ttu-id="6c8b5-153">[ItemCmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider)類別會定義 Windows PowerShell 專案提供者，它會在資料存放區的個別專案上執行作業，而且不會假設任何容器或流覽功能。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-153">The [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) class defines a Windows PowerShell item provider that performs operations on the individual items of the data store, and it does not assume any container or navigation capabilities.</span></span> <span data-ttu-id="6c8b5-154">這個類別是衍生自[DriveCmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider)基類的。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-154">This class derives from the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="6c8b5-155">下表列出這個類別所公開的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-155">The following table lists the cmdlets exposed by this class.</span></span>

|     <span data-ttu-id="6c8b5-156">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="6c8b5-156">Cmdlet</span></span>     |                                                                                                                                                            <span data-ttu-id="6c8b5-157">定義</span><span class="sxs-lookup"><span data-stu-id="6c8b5-157">Definition</span></span>                                                                                                                                                            |
| -------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Clear-Item`   | <span data-ttu-id="6c8b5-158">清除指定位置上專案的目前內容，並以提供者所指定的「清除」值來取代它。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-158">Clears the current content of items at the specified location, and replaces it with the "clear" value specified by the provider.</span></span> <span data-ttu-id="6c8b5-159">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-159">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>                                                                                   |
| `Get-Item`     | <span data-ttu-id="6c8b5-160">從指定的位置抓取專案，並串流結果物件。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-160">Retrieves items from the specified location, and streams the resultant objects.</span></span>                                                                                                                                                                                                                                                  |
| `Invoke-Item`  | <span data-ttu-id="6c8b5-161">在指定路徑上叫用專案的預設動作。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-161">Invokes the default action for the item at the specified path.</span></span>                                                                                                                                                                                                                                                                   |
| `Set-Item`     | <span data-ttu-id="6c8b5-162">在指定的位置設定具有指定值的專案。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-162">Sets an item at the specified location with the indicated value.</span></span> <span data-ttu-id="6c8b5-163">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-163">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>                                                                                                                                                   |
| `Resolve-Path` | <span data-ttu-id="6c8b5-164">解析 Windows PowerShell 路徑的萬用字元，並串流路徑資訊。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-164">Resolves the wildcards for a Windows PowerShell path, and streams path information.</span></span>                                                                                                                                                                                                                                              |
| `Test-Path`    | <span data-ttu-id="6c8b5-165">測試指定的路徑，如果存在則傳回， `true` 否則傳回 `false` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-165">Tests for the specified path, and returns `true` if it exists and `false` otherwise.</span></span> <span data-ttu-id="6c8b5-166">這個指令程式會實作為支援 `IsContainer` [Cmdletprovider. Writeitemobject \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject)方法的參數。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-166">This cmdlet is implemented to support the `IsContainer` parameter for the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method.</span></span> |

### <a name="containercmdletprovider-base-class"></a><span data-ttu-id="6c8b5-167">ContainerCmdletProvider 基類</span><span class="sxs-lookup"><span data-stu-id="6c8b5-167">ContainerCmdletProvider Base Class</span></span>

<span data-ttu-id="6c8b5-168">[ContainerCmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)類別會定義 Windows PowerShell 容器提供者，以向使用者公開資料存放區專案的容器。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-168">The [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class defines a Windows PowerShell container provider that exposes a container, for data store items, to the user.</span></span> <span data-ttu-id="6c8b5-169">請注意，只有在有一個容器 (沒有任何包含專案的嵌套容器) 時，才可以使用 Windows PowerShell 容器提供者。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-169">Be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="6c8b5-170">如果有嵌套的容器，則您必須執行 Windows PowerShell 流覽提供者。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-170">If there are nested containers, then you must implement a Windows PowerShell navigation provider .</span></span>

<span data-ttu-id="6c8b5-171">這個類別是衍生自[ItemCmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider)基類的。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-171">This class derives from the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="6c8b5-172">下表定義這個類別所執行的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-172">The following table defines the cmdlets implemented by this class.</span></span>

|     <span data-ttu-id="6c8b5-173">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="6c8b5-173">Cmdlet</span></span>      |                                                                        <span data-ttu-id="6c8b5-174">定義</span><span class="sxs-lookup"><span data-stu-id="6c8b5-174">Definition</span></span>                                                                        |
| --------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Copy-Item`     | <span data-ttu-id="6c8b5-175">將專案從一個位置複製到另一個位置。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-175">Copies items from one location to another.</span></span> <span data-ttu-id="6c8b5-176">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-176">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span> |
| `Get-Childitem` | <span data-ttu-id="6c8b5-177">抓取位於指定位置的子專案，並將它們串流為物件。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-177">Retrieves the child items at the specified location, and streams them as objects.</span></span>                                                                        |
| `New-Item`      | <span data-ttu-id="6c8b5-178">在指定的位置建立新專案，並串流結果物件。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-178">Creates new items at the specified location, and streams the resultant object.</span></span>                                                                           |
| `Remove-Item`   | <span data-ttu-id="6c8b5-179">從指定的位置移除專案。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-179">Removes items from the specified location.</span></span>                                                                                                               |
| `Rename-Item`   | <span data-ttu-id="6c8b5-180">重新命名指定位置的專案。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-180">Renames an item at the specified location.</span></span> <span data-ttu-id="6c8b5-181">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-181">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span> |

### <a name="navigationcmdletprovider-base-class"></a><span data-ttu-id="6c8b5-182">NavigationCmdletProvider 基類</span><span class="sxs-lookup"><span data-stu-id="6c8b5-182">NavigationCmdletProvider Base Class</span></span>

<span data-ttu-id="6c8b5-183">[NavigationCmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider)類別會定義 Windows PowerShell 流覽提供者，以針對使用多個容器的專案執行作業。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-183">The [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) class defines a Windows PowerShell navigation provider that performs operations for items that use more than one container.</span></span> <span data-ttu-id="6c8b5-184">這個類別是衍生自[ContainerCmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)基類的。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-184">This class derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="6c8b5-185">下表列出這個類別所公開的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-185">The following table list the cmdlets exposed by this class.</span></span>

|    <span data-ttu-id="6c8b5-186">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="6c8b5-186">Cmdlet</span></span>    |                                                                      <span data-ttu-id="6c8b5-187">定義</span><span class="sxs-lookup"><span data-stu-id="6c8b5-187">Definition</span></span>                                                                      |
| ------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------- |
| <span data-ttu-id="6c8b5-188">合併-路徑</span><span class="sxs-lookup"><span data-stu-id="6c8b5-188">Combine-Path</span></span> | <span data-ttu-id="6c8b5-189">將兩個路徑結合成單一路徑，並在路徑之間使用提供者特定的分隔符號。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-189">Combines two paths into a single path, using a provider-specific delimiter between paths.</span></span> <span data-ttu-id="6c8b5-190">此 Cmdlet 會串流處理字串。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-190">This cmdlet streams strings.</span></span>                               |
| `Move-Item`  | <span data-ttu-id="6c8b5-191">將專案移到指定的位置。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-191">Moves items to the specified location.</span></span> <span data-ttu-id="6c8b5-192">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-192">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span> |

<span data-ttu-id="6c8b5-193">相關的 Cmdlet 是 Windows PowerShell 所提供的基本剖析路徑 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-193">A related cmdlet is the basic Parse-Path cmdlet furnished by Windows PowerShell.</span></span> <span data-ttu-id="6c8b5-194">此 Cmdlet 可用於剖析 Windows PowerShell 路徑以支援 `Parent` 參數。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-194">This cmdlet can be used to parse a Windows PowerShell path to support the `Parent` parameter.</span></span> <span data-ttu-id="6c8b5-195">它會串流處理父路徑字串。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-195">It streams the parent path string.</span></span>

## <a name="select-provider-interfaces-to-support"></a><span data-ttu-id="6c8b5-196">選取要支援的提供者介面</span><span class="sxs-lookup"><span data-stu-id="6c8b5-196">Select Provider Interfaces to Support</span></span>

<span data-ttu-id="6c8b5-197">除了衍生自其中一個 Windows PowerShell 基類以外，您的 Windows PowerShell 提供者也可以衍生自下列一個或多個提供者介面，以支援其他功能。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-197">In addition to deriving from one of the Windows PowerShell base classes, your Windows PowerShell provider can support other functionality by deriving from one or more of the following provider interfaces.</span></span> <span data-ttu-id="6c8b5-198">這個區段會定義這些介面和各項支援的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-198">This section defines those interfaces and the cmdlets supported by each.</span></span> <span data-ttu-id="6c8b5-199">它不會描述介面支援的 Cmdlet 的參數。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-199">It does not describe the parameters for the interface-supported cmdlets.</span></span> <span data-ttu-id="6c8b5-200">Cmdlet 參數資訊可在線上使用 `Get-Command` 和 `Get-Help` Cmdlet 取得。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-200">Cmdlet parameter information is available online using the `Get-Command` and `Get-Help` cmdlets.</span></span>

### <a name="icontentcmdletprovider"></a><span data-ttu-id="6c8b5-201">IContentCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="6c8b5-201">IContentCmdletProvider</span></span>

<span data-ttu-id="6c8b5-202">[IcontentCmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider)介面會定義內容提供者，以在資料項目的內容上執行作業。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-202">The [System.Management.Automation.Provider.Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider) interface defines a content provider that performs operations on the content of a data item.</span></span> <span data-ttu-id="6c8b5-203">下表列出此介面所公開的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-203">The following table lists the cmdlets exposed by this interface.</span></span>

|     <span data-ttu-id="6c8b5-204">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="6c8b5-204">Cmdlet</span></span>      |                                                                                        <span data-ttu-id="6c8b5-205">定義</span><span class="sxs-lookup"><span data-stu-id="6c8b5-205">Definition</span></span>                                                                                        |
| --------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Add-Content`   | <span data-ttu-id="6c8b5-206">將指示的值長度附加至指定專案的內容。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-206">Appends the indicated value lengths to the contents of the specified item.</span></span> <span data-ttu-id="6c8b5-207">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-207">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span> |
| `Clear-Content` | <span data-ttu-id="6c8b5-208">將指定專案的內容設定為 "clear" 值。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-208">Sets the content of the specified item to the "clear" value.</span></span> <span data-ttu-id="6c8b5-209">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-209">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>               |
| `Get-Content`   | <span data-ttu-id="6c8b5-210">抓取指定專案的內容，並串流結果物件。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-210">Retrieves the contents of the specified items and streams the resultant objects.</span></span>                                                                                                         |
| `Set-Content`   | <span data-ttu-id="6c8b5-211">取代所指定專案的現有內容。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-211">Replaces the existing content for the specified items.</span></span> <span data-ttu-id="6c8b5-212">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-212">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>                     |

### <a name="ipropertycmdletprovider"></a><span data-ttu-id="6c8b5-213">IPropertyCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="6c8b5-213">IPropertyCmdletProvider</span></span>

<span data-ttu-id="6c8b5-214">[IpropertyCmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)介面會定義屬性 Windows PowerShell 提供者，它會對資料存放區中專案的屬性執行作業。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-214">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface defines a property Windows PowerShell provider that performs operations on the properties of items in the data store.</span></span> <span data-ttu-id="6c8b5-215">下表列出此介面所公開的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-215">The following table lists the cmdlets exposed by this interface.</span></span>

> [!NOTE]
> <span data-ttu-id="6c8b5-216">`Path`這些 Cmdlet 上的參數表示專案的路徑，而不是識別屬性。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-216">The `Path` parameter on these cmdlets indicates a path to an item instead of identifying a property.</span></span>

|        <span data-ttu-id="6c8b5-217">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="6c8b5-217">Cmdlet</span></span>        |                                                                                   <span data-ttu-id="6c8b5-218">定義</span><span class="sxs-lookup"><span data-stu-id="6c8b5-218">Definition</span></span>                                                                                    |
| -------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Clear-ItemProperty` | <span data-ttu-id="6c8b5-219">將指定專案的屬性設定為 "clear" 值。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-219">Sets properties of the specified items to the "clear" value.</span></span> <span data-ttu-id="6c8b5-220">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-220">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>      |
| `Get-ItemProperty`   | <span data-ttu-id="6c8b5-221">從指定的專案抓取屬性，並串流結果物件。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-221">Retrieves properties from the specified items and streams the resultant objects.</span></span>                                                                                                |
| `Set-ItemProperty`   | <span data-ttu-id="6c8b5-222">設定具有指定之值的指定專案屬性。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-222">Sets properties of the specified items with the indicated values.</span></span> <span data-ttu-id="6c8b5-223">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-223">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span> |

### <a name="idynamicpropertycmdletprovider"></a><span data-ttu-id="6c8b5-224">IDynamicPropertyCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="6c8b5-224">IDynamicPropertyCmdletProvider</span></span>

<span data-ttu-id="6c8b5-225">[IdynamicpropertyCmdletprovider](/dotnet/api/System.Management.Automation.Provider.IDynamicPropertyCmdletProvider)介面（衍生自[IpropertyCmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)）會定義提供者，以針對其支援的 Cmdlet 指定動態參數（provider）。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-225">The [System.Management.Automation.Provider.Idynamicpropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IDynamicPropertyCmdletProvider) interface, derived from [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider), defines a provider that specifies dynamic parameters for its supported cmdlets.</span></span> <span data-ttu-id="6c8b5-226">這種類型的提供者會處理可以在執行時間定義其屬性的作業，例如，新的屬性操作。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-226">This type of provider handles operations for which properties can be defined at run time, for example, a new property operation.</span></span> <span data-ttu-id="6c8b5-227">在具有靜態定義屬性的專案上無法進行這類作業。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-227">Such operations are not possible on items having statically defined properties.</span></span>
<span data-ttu-id="6c8b5-228">下表列出此介面所公開的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-228">The following table lists the cmdlets exposed by this interface.</span></span>

|        <span data-ttu-id="6c8b5-229">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="6c8b5-229">Cmdlet</span></span>         |                                                                                <span data-ttu-id="6c8b5-230">定義</span><span class="sxs-lookup"><span data-stu-id="6c8b5-230">Definition</span></span>                                                                                |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `Copy-ItemProperty`   | <span data-ttu-id="6c8b5-231">將屬性從指定的專案複製到另一個專案。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-231">Copies a property from the specified item to another item.</span></span> <span data-ttu-id="6c8b5-232">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-232">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span> |
| `Move-ItemProperty`   | <span data-ttu-id="6c8b5-233">將屬性從指定的專案移至另一個專案。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-233">Moves a property from the specified item to another item.</span></span> <span data-ttu-id="6c8b5-234">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-234">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>  |
| `New-ItemProperty`    | <span data-ttu-id="6c8b5-235">在指定的專案上建立屬性，並串流結果物件。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-235">Creates a property on the specified items and streams the resultant objects.</span></span>                                                                                             |
| `Remove-ItemProperty` | <span data-ttu-id="6c8b5-236">移除指定專案的屬性。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-236">Removes a property for the specified items.</span></span>                                                                                                                              |
| `Rename-ItemProperty` | <span data-ttu-id="6c8b5-237">重新命名指定專案的屬性。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-237">Renames a property of the specified items.</span></span> <span data-ttu-id="6c8b5-238">除非已指定其參數，否則這個 Cmdlet 不會透過管線傳遞輸出物件 `PassThru` 。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-238">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>                 |

### <a name="isecuritydescriptorcmdletprovider"></a><span data-ttu-id="6c8b5-239">ISecurityDescriptorCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="6c8b5-239">ISecurityDescriptorCmdletProvider</span></span>

<span data-ttu-id="6c8b5-240">[IsecuritydescriptorCmdletprovider](/dotnet/api/System.Management.Automation.Provider.ISecurityDescriptorCmdletProvider)介面會將安全描述項功能新增至提供者。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-240">The [System.Management.Automation.Provider.Isecuritydescriptorcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ISecurityDescriptorCmdletProvider) interface adds security descriptor functionality to a provider.</span></span> <span data-ttu-id="6c8b5-241">此介面可讓使用者取得和設定資料存放區中專案的安全描述項資訊。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-241">This interface allows the user to get and set security descriptor information for an item in the data store.</span></span> <span data-ttu-id="6c8b5-242">下表列出此介面所公開的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-242">The following table lists the cmdlets exposed by this interface.</span></span>

|  <span data-ttu-id="6c8b5-243">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="6c8b5-243">Cmdlet</span></span>   |                                                                                                                                                                                                          <span data-ttu-id="6c8b5-244">定義</span><span class="sxs-lookup"><span data-stu-id="6c8b5-244">Definition</span></span>                                                                                                                                                                                                          |
| --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Get-Acl` | <span data-ttu-id="6c8b5-245">抓取存取控制清單中包含的資訊 (ACL) ，這是用來保護作業系統資源（例如檔案或物件）之安全描述項的一部分。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-245">Retrieves the information contained in an access control list (ACL), which is part of a security descriptor used to guard operating system resources, for example, a file or an object.</span></span>                                                                                                                                                                                                                                      |
| `Set-Acl` | <span data-ttu-id="6c8b5-246">設定 ACL 的資訊。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-246">Sets the information for an ACL.</span></span> <span data-ttu-id="6c8b5-247">它的形式是 Accesscontrol 的實例， [Objectsecurity](/dotnet/api/System.Security.AccessControl.ObjectSecurity)是針對指定的路徑所指定的專案 () s。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-247">It is in the form of an instance of [System.Security.Accesscontrol.Objectsecurity](/dotnet/api/System.Security.AccessControl.ObjectSecurity) on the item(s) designated for the specified path.</span></span> <span data-ttu-id="6c8b5-248">如果 Windows PowerShell 提供者支援安全性資訊的設定，此 Cmdlet 可以設定登錄中的檔案、金鑰和子機碼，或任何其他提供者專案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6c8b5-248">This cmdlet can set information about files, keys, and subkeys in the registry, or any other provider item, if the Windows PowerShell provider supports the setting of security information.</span></span> |

## <a name="see-also"></a><span data-ttu-id="6c8b5-249">另請參閱</span><span class="sxs-lookup"><span data-stu-id="6c8b5-249">See Also</span></span>

[<span data-ttu-id="6c8b5-250">建立 Windows PowerShell 提供者</span><span class="sxs-lookup"><span data-stu-id="6c8b5-250">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

<span data-ttu-id="6c8b5-251">[Windows PowerShell 的運作方式](/previous-versions/ms714658(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="6c8b5-251">[How Windows PowerShell Works](/previous-versions/ms714658(v=vs.85))</span></span>

[<span data-ttu-id="6c8b5-252">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="6c8b5-252">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)
