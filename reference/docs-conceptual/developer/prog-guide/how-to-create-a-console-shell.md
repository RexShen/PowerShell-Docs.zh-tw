---
ms.date: 09/13/2016
ms.topic: reference
title: 如何建立主控台殼層
description: 如何建立主控台殼層
ms.openlocfilehash: 9ea67c43b1ee35b1fbfc553b22a1423419317ca2
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/10/2020
ms.locfileid: "92657223"
---
# <a name="how-to-create-a-console-shell"></a><span data-ttu-id="0a57a-103">如何建立主控台殼層</span><span class="sxs-lookup"><span data-stu-id="0a57a-103">How to Create a Console Shell</span></span>

<span data-ttu-id="0a57a-104">Windows PowerShell 提供 Make-Shell 工具（也稱為「品牌套件」），可用來建立不可延伸的主控台 shell。</span><span class="sxs-lookup"><span data-stu-id="0a57a-104">Windows PowerShell provides a Make-Shell tool, also referred to as the "make-kit", that is used to create a console shell that is not extensible.</span></span> <span data-ttu-id="0a57a-105">稍後透過 Windows PowerShell 嵌入式管理單元，無法延長以此新工具建立的 shell。</span><span class="sxs-lookup"><span data-stu-id="0a57a-105">Shells created with this new tool cannot be extended later through a Windows PowerShell snap-in.</span></span>

## <a name="syntax"></a><span data-ttu-id="0a57a-106">語法</span><span class="sxs-lookup"><span data-stu-id="0a57a-106">Syntax</span></span>

<span data-ttu-id="0a57a-107">以下是用來從檔案內執行 Make-Shell 的語法。</span><span class="sxs-lookup"><span data-stu-id="0a57a-107">Here is the syntax used to run Make-Shell from within a make-file.</span></span>

```
make-shell
  -out n.exe
  -namespace ns
  [ -lib libdirectory1[,libdirectory2,..] ]
  [ -reference ca1.dll[,ca2.dll,...] ]
  [ -formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...] ]
  [ -typedata td1.type.ps1xml[,td2.type.ps1xml,...] ]
  [ -source c1.cs [,c2.cs,...] ]
  [ -authorizationmanager authorizationManagerType ]
  [ -win32icon i.ico ]
  [ -initscript p.ps1 ]
  [ -builtinscript s1.ps1[,s2.ps1,...] ]
  [ -resource resourcefile.txt ]
  [ -cscflags cscFlags ]
  [ -? | -help ]
```

## <a name="parameters"></a><span data-ttu-id="0a57a-108">參數</span><span class="sxs-lookup"><span data-stu-id="0a57a-108">Parameters</span></span>

<span data-ttu-id="0a57a-109">以下是 Make Shell 參數的簡短描述。</span><span class="sxs-lookup"><span data-stu-id="0a57a-109">Here is a brief description of the parameters of Make-Shell.</span></span>

> [!CAUTION]
> <span data-ttu-id="0a57a-110">Make Shell 不支援元件的 UNC 路徑。</span><span class="sxs-lookup"><span data-stu-id="0a57a-110">UNC paths to assemblies are not supported by Make-Shell.</span></span>

|<span data-ttu-id="0a57a-111">參數</span><span class="sxs-lookup"><span data-stu-id="0a57a-111">Parameter</span></span>|<span data-ttu-id="0a57a-112">說明</span><span class="sxs-lookup"><span data-stu-id="0a57a-112">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="0a57a-113">-out n.exe</span><span class="sxs-lookup"><span data-stu-id="0a57a-113">-out n.exe</span></span>|<span data-ttu-id="0a57a-114">必要。</span><span class="sxs-lookup"><span data-stu-id="0a57a-114">Required.</span></span> <span data-ttu-id="0a57a-115">要產生之 shell 的名稱。</span><span class="sxs-lookup"><span data-stu-id="0a57a-115">The name of the shell to produce.</span></span> <span data-ttu-id="0a57a-116">此路徑會指定為此參數的一部分。</span><span class="sxs-lookup"><span data-stu-id="0a57a-116">The path is specified as part of this parameter.</span></span><br /><br /> <span data-ttu-id="0a57a-117">如果未指定，則 Make shell 會將 ".exe" 附加至這個值。</span><span class="sxs-lookup"><span data-stu-id="0a57a-117">Make-shell will append ".exe" to this value if it is not specified.</span></span> <span data-ttu-id="0a57a-118">**注意：**  請勿使用與參考的 .dll 檔案相同的名稱來建立輸出檔。</span><span class="sxs-lookup"><span data-stu-id="0a57a-118">**Caution:**  Do not create an output file with the same name as the referenced .dll file.</span></span> <span data-ttu-id="0a57a-119">如果您嘗試這麼做，Make-Shell 工具就會建立一個具有相同名稱的 .cs 檔案，而該檔案將會覆寫具有 Cmdlet 原始程式碼的 .cs 檔案。</span><span class="sxs-lookup"><span data-stu-id="0a57a-119">If you attempt this, the Make-Shell tool creates a .cs file with the same name, which will overwrite the .cs file that has your cmdlet source code.</span></span>|
|<span data-ttu-id="0a57a-120">-namespace ns</span><span class="sxs-lookup"><span data-stu-id="0a57a-120">-namespace ns</span></span>|<span data-ttu-id="0a57a-121">必要。</span><span class="sxs-lookup"><span data-stu-id="0a57a-121">Required.</span></span> <span data-ttu-id="0a57a-122">要用於產生和編譯之 [Runspaceconfiguration](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration) 類別的命名空間（namespace）的命名空間。</span><span class="sxs-lookup"><span data-stu-id="0a57a-122">The namespace to use for the derived [System.Management.Automation.Runspaces.Runspaceconfiguration](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration) class that the make-kit generates and compiles.</span></span>|
|<span data-ttu-id="0a57a-123">-lib libdirectory1 [，libdirectory2,..]</span><span class="sxs-lookup"><span data-stu-id="0a57a-123">-lib libdirectory1[,libdirectory2,..]</span></span>|<span data-ttu-id="0a57a-124">針對 .NET 元件搜尋的目錄，包括 Windows PowerShell 元件、參數指定的元件、 `reference` 由另一個元件間接參考的元件，以及 .net 系統元件。</span><span class="sxs-lookup"><span data-stu-id="0a57a-124">The directories that are searched for .NET assemblies, including the Windows PowerShell assemblies, assemblies specified by the `reference` parameter, assemblies indirectly referenced by another assembly, and the .NET system assemblies.</span></span>|
|<span data-ttu-id="0a57a-125">-reference ca1.dll [，ca2.dll,...]</span><span class="sxs-lookup"><span data-stu-id="0a57a-125">-reference ca1.dll[,ca2.dll,...]</span></span>|<span data-ttu-id="0a57a-126">要包含在 shell 中的元件清單（以逗號分隔）。</span><span class="sxs-lookup"><span data-stu-id="0a57a-126">A comma-separated list of the assemblies to include in the shell.</span></span> <span data-ttu-id="0a57a-127">這些元件包括所有的 Cmdlet 和提供者元件，以及應該載入的資源元件。</span><span class="sxs-lookup"><span data-stu-id="0a57a-127">These assemblies  includes all cmdlet and provider assemblies, as well as resource assemblies that should be loaded.</span></span> <span data-ttu-id="0a57a-128">如果未指定此參數，則會產生 shell，其中只包含 Windows PowerShell 所提供的核心 Cmdlet 和提供者。</span><span class="sxs-lookup"><span data-stu-id="0a57a-128">If this parameter is not specified, then a shell is produced that contains only the core cmdlets and providers provided by Windows PowerShell.</span></span><br /><br /> <span data-ttu-id="0a57a-129">您可以使用完整路徑來指定元件，否則會使用參數所指定的路徑來搜尋這些元件 `lib` 。</span><span class="sxs-lookup"><span data-stu-id="0a57a-129">The assemblies can be specified using their full path, otherwise they will be searched for using the path specified by the `lib` parameter.</span></span>|
|<span data-ttu-id="0a57a-130">-formatdata fd1.format.ps1xml [，fd2.format.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="0a57a-130">-formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...]</span></span>|<span data-ttu-id="0a57a-131">要包含在 shell 中的格式資料清單（以逗號分隔）。</span><span class="sxs-lookup"><span data-stu-id="0a57a-131">A comma-separated list of format data to include in the shell.</span></span> <span data-ttu-id="0a57a-132">如果未指定此參數，則會產生 shell，其中只包含 Windows PowerShell 所提供的格式資料。</span><span class="sxs-lookup"><span data-stu-id="0a57a-132">If this parameter is not specified, then a shell is produced that contains only the format data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="0a57a-133">-typedata td1.type.ps1xml [，td2.type.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="0a57a-133">-typedata td1.type.ps1xml[,td2.type.ps1xml,...]</span></span>|<span data-ttu-id="0a57a-134">要包含在 shell 中的型別資料清單（以逗號分隔）。</span><span class="sxs-lookup"><span data-stu-id="0a57a-134">A comma-separated list of type data to include in the shell.</span></span> <span data-ttu-id="0a57a-135">如果未指定此參數，則會產生 shell，其中只包含 Windows PowerShell 所提供的類型資料。</span><span class="sxs-lookup"><span data-stu-id="0a57a-135">If this parameter is not specified, then a shell is produced that contains only the type data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="0a57a-136">-source c1.cs [，c2.cs,...]</span><span class="sxs-lookup"><span data-stu-id="0a57a-136">-source c1.cs [,c2.cs,...]</span></span>|<span data-ttu-id="0a57a-137">Shell 開發人員所提供的檔案名，其中包含建立 shell 所需的任何原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="0a57a-137">The name of a file, provided by the shell developer, that contains any source code needed to build the shell.</span></span><br /><br /> <span data-ttu-id="0a57a-138">原始程式碼檔可以包含下列任何原始程式碼：</span><span class="sxs-lookup"><span data-stu-id="0a57a-138">The source code file can contain any of the following source code:</span></span><br /><br /> <span data-ttu-id="0a57a-139">-覆寫預設授權管理員的授權管理員執行。</span><span class="sxs-lookup"><span data-stu-id="0a57a-139">-   The Authorization manager implementation that overrides the default authorization manager.</span></span> <span data-ttu-id="0a57a-140"> (也可以將其編譯為元件。 ) </span><span class="sxs-lookup"><span data-stu-id="0a57a-140">(This could also be supplied compiled into an assembly.)</span></span><br /><span data-ttu-id="0a57a-141">-元件資訊屬性宣告：例如 System.reflection.assemblycompanyattribute>、System.reflection.assemblycopyrightattribute>、AssemblyFileVersionAttribute、System.reflection.assemblyinformationalversionattribute>、System.reflection.assemblyproductattribute> 和 System.reflection.assemblytrademarkattribute>。</span><span class="sxs-lookup"><span data-stu-id="0a57a-141">-   Assembly informational attribute declarations: such as the AssemblyCompanyAttribute, AssemblyCopyrightAttribute, AssemblyFileVersionAttribute, AssemblyInformationalVersionAttribute, AssemblyProductAttribute, and AssemblyTrademarkAttribute.</span></span>|
|<span data-ttu-id="0a57a-142">-authorizationmanager authorizationManagerType</span><span class="sxs-lookup"><span data-stu-id="0a57a-142">-authorizationmanager authorizationManagerType</span></span>|<span data-ttu-id="0a57a-143">包含授權管理員執行的型別。</span><span class="sxs-lookup"><span data-stu-id="0a57a-143">The type that contains the authorization manager implementation.</span></span> <span data-ttu-id="0a57a-144">這可以在原始程式碼中定義，也可以編譯為參數) 所指定的元件 (`reference` 。</span><span class="sxs-lookup"><span data-stu-id="0a57a-144">This can be defined in source code, or compiled into an assembly (specified by the `reference` parameter).</span></span> <span data-ttu-id="0a57a-145">如果未指定此參數，則會使用預設的安全性管理員。</span><span class="sxs-lookup"><span data-stu-id="0a57a-145">If this parameter is not specified, the default security manager is used.</span></span> <span data-ttu-id="0a57a-146">此值應該是完整的類型名稱，包括命名空間。</span><span class="sxs-lookup"><span data-stu-id="0a57a-146">The value should be the full type name, including namespaces.</span></span>|
|<span data-ttu-id="0a57a-147">-win32icon i .ico</span><span class="sxs-lookup"><span data-stu-id="0a57a-147">-win32icon i.ico</span></span>|<span data-ttu-id="0a57a-148">Shell 之 .exe 檔的圖示。</span><span class="sxs-lookup"><span data-stu-id="0a57a-148">The icon for the .exe file for the shell.</span></span> <span data-ttu-id="0a57a-149">如果未指定，則 shell 會有 c # 編譯器包含 (（如果有任何) ）的圖示。</span><span class="sxs-lookup"><span data-stu-id="0a57a-149">If not specified, then the shell will have the icon that the c# compiler includes (if any).</span></span>|
|<span data-ttu-id="0a57a-150">-initscript p.ps1</span><span class="sxs-lookup"><span data-stu-id="0a57a-150">-initscript p.ps1</span></span>|<span data-ttu-id="0a57a-151">Shell 的啟動設定檔。</span><span class="sxs-lookup"><span data-stu-id="0a57a-151">The startup profile for the shell.</span></span> <span data-ttu-id="0a57a-152">檔案包含「依原樣」;Make Shell 不會執行任何有效性檢查。</span><span class="sxs-lookup"><span data-stu-id="0a57a-152">The file is included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="0a57a-153">-builtinscript s1.ps1 [，s2.ps1,...]</span><span class="sxs-lookup"><span data-stu-id="0a57a-153">-builtinscript s1.ps1[,s2.ps1,...]</span></span>|<span data-ttu-id="0a57a-154">Shell 的內建腳本清單。</span><span class="sxs-lookup"><span data-stu-id="0a57a-154">A list of built-in scripts for the shell.</span></span> <span data-ttu-id="0a57a-155">這些腳本會在路徑中的腳本之前探索，且在建立 shell 之後，就無法變更其內容。</span><span class="sxs-lookup"><span data-stu-id="0a57a-155">These scripts are discovered before scripts in the path, and their contents cannot be changed once the shell is built.</span></span><br /><br /> <span data-ttu-id="0a57a-156">檔案包含「依原樣」;Make Shell 不會執行任何有效性檢查。</span><span class="sxs-lookup"><span data-stu-id="0a57a-156">The files are included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="0a57a-157">-資源 resourcefile.txt</span><span class="sxs-lookup"><span data-stu-id="0a57a-157">-resource resourcefile.txt</span></span>|<span data-ttu-id="0a57a-158">包含 shell 說明和橫幅資源的 .txt 檔案。</span><span class="sxs-lookup"><span data-stu-id="0a57a-158">The .txt file containing help and banner resources for the shell.</span></span> <span data-ttu-id="0a57a-159">第一個資源的名稱是 ShellHelp，並包含使用參數叫用 shell 時所顯示的文字 `help` 。</span><span class="sxs-lookup"><span data-stu-id="0a57a-159">The first resource is named ShellHelp, and contains the text displayed if the shell is invoked with the `help` parameter.</span></span> <span data-ttu-id="0a57a-160">第二個資源的名稱是 ShellBanner，它包含在互動模式中啟動 shell 時所顯示的文字和著作權資訊。</span><span class="sxs-lookup"><span data-stu-id="0a57a-160">The second resource is named ShellBanner, and it contains the text and copyright information displayed when the shell is launched in interactive mode.</span></span><br /><br /> <span data-ttu-id="0a57a-161">如果未提供此參數，或這些資源不存在，則會使用一般說明和橫幅。</span><span class="sxs-lookup"><span data-stu-id="0a57a-161">If this parameter is not provided, or these resources are not present, then a generic help and banner are used.</span></span>|
|<span data-ttu-id="0a57a-162">-cscflags cscFlags</span><span class="sxs-lookup"><span data-stu-id="0a57a-162">-cscflags cscFlags</span></span>|<span data-ttu-id="0a57a-163">應該傳遞至 c # 編譯器 ( # A0) 的旗標。</span><span class="sxs-lookup"><span data-stu-id="0a57a-163">Flags that should be passed to the C# compiler (csc.exe).</span></span> <span data-ttu-id="0a57a-164">這些是透過未變更的傳遞。</span><span class="sxs-lookup"><span data-stu-id="0a57a-164">These are passed through unchanged.</span></span> <span data-ttu-id="0a57a-165">如果此參數包含空格，則應以雙引號括住。</span><span class="sxs-lookup"><span data-stu-id="0a57a-165">If this parameter includes spaces, it should be surrounded in double-quotes.</span></span>|
|<span data-ttu-id="0a57a-166">-?</span><span class="sxs-lookup"><span data-stu-id="0a57a-166">-?</span></span><br /><br /> <span data-ttu-id="0a57a-167">-help</span><span class="sxs-lookup"><span data-stu-id="0a57a-167">-help</span></span>|<span data-ttu-id="0a57a-168">顯示著作權訊息和 Make-Shell 命令列選項。</span><span class="sxs-lookup"><span data-stu-id="0a57a-168">Displays the copyright message and Make-Shell command line options.</span></span>|
|<span data-ttu-id="0a57a-169">-verbose</span><span class="sxs-lookup"><span data-stu-id="0a57a-169">-verbose</span></span>|<span data-ttu-id="0a57a-170">顯示建立 shell 時的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="0a57a-170">Displays detailed information while the shell is being created.</span></span>|

## <a name="see-also"></a><span data-ttu-id="0a57a-171">另請參閱</span><span class="sxs-lookup"><span data-stu-id="0a57a-171">See Also</span></span>

[<span data-ttu-id="0a57a-172">Windows PowerShell 程式設計人員手冊</span><span class="sxs-lookup"><span data-stu-id="0a57a-172">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="0a57a-173">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="0a57a-173">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)
