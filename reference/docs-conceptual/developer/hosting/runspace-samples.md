---
title: 運行空間範例 |Microsoft Docs
ms.date: 09/13/2016
ms.openlocfilehash: f7c11101a570f89657f9ffc4d52fa6ebce3a91e1
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/05/2020
ms.locfileid: "87772207"
---
# <a name="runspace-samples"></a><span data-ttu-id="6fbfa-102">Runspace 範例</span><span class="sxs-lookup"><span data-stu-id="6fbfa-102">Runspace Samples</span></span>

<span data-ttu-id="6fbfa-103">本節包含範例程式碼，示範如何使用不同類型的執行程式，以同步和非同步方式執行命令。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-103">This section includes sample code that shows how to use different types of runspaces to run commands synchronously and asynchronously.</span></span> <span data-ttu-id="6fbfa-104">您可以使用 Microsoft Visual Studio 建立主控台應用程式，然後將此區段中的主題中的程式碼複製到您的主應用程式。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-104">You can use Microsoft Visual Studio to create a console application and then copy the code from the topics in this section into your host application.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="6fbfa-105">本節內容</span><span class="sxs-lookup"><span data-stu-id="6fbfa-105">In This Section</span></span>

> [!NOTE]
> <span data-ttu-id="6fbfa-106">如需建立自訂主機介面之主應用程式的範例，請參閱[自訂主機範例](./custom-host-samples.md)。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-106">For samples of host applications that create custom host interfaces, see [Custom Host Samples](./custom-host-samples.md).</span></span>

 <span data-ttu-id="6fbfa-107">[Runspace01 範例](./runspace01-sample.md)這個範例示範如何使用[system.web](/dotnet/api/system.management.automation.powershell)類別，以同步方式執行[處理常式](/powershell/module/Microsoft.PowerShell.Management/Get-Process)Cmdlet，並在主控台視窗中顯示其輸出。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-107">[Runspace01 Sample](./runspace01-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet synchronously and display its output in a console window.</span></span>

 <span data-ttu-id="6fbfa-108">[Runspace02 範例](./runspace02-sample.md)這個範例示範如何使用[system.web](/dotnet/api/system.management.automation.powershell)類別，以同步方式執行[Get 進程](/powershell/module/Microsoft.PowerShell.Management/Get-Process)和[排序物件](/powershell/module/Microsoft.PowerShell.Utility/Sort-Object)Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-108">[Runspace02 Sample](./runspace02-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) and [Sort-Object](/powershell/module/Microsoft.PowerShell.Utility/Sort-Object) cmdlets synchronously.</span></span> <span data-ttu-id="6fbfa-109">這些命令的結果會使用[system.web](/dotnet/api/System.Windows.Forms.DataGridView)控制項來顯示。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-109">The results of these commands is displayed by using a [System.Windows.Forms.Datagridview](/dotnet/api/System.Windows.Forms.DataGridView) control.</span></span>

 <span data-ttu-id="6fbfa-110">[Runspace03 範例](./runspace03-sample.md)這個範例會示範如何使用[system.web](/dotnet/api/system.management.automation.powershell)類別，以同步方式執行腳本，以及如何處理非終止錯誤。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-110">[Runspace03 Sample](./runspace03-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run a script synchronously, and how to handle non-terminating errors.</span></span> <span data-ttu-id="6fbfa-111">指令碼會接收處理序名稱的清單，然後擷取這些處理序。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-111">The script receives a list of process names and then retrieves those processes.</span></span> <span data-ttu-id="6fbfa-112">指令碼的結果會顯示在主控台視窗中，包括執行指令碼時所產生的任何非終止錯誤在內。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-112">The results of the script, including any non-terminating errors that were generated when running the script, are displayed in a console window.</span></span>

 <span data-ttu-id="6fbfa-113">[Runspace04 範例](./runspace04-sample.md)這個範例會示範如何使用[system.web](/dotnet/api/system.management.automation.powershell)類別來執行命令，以及如何攔截執行命令時所擲回的終止錯誤。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-113">[Runspace04 Sample](./runspace04-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run commands, and how to catch terminating errors that are thrown when running the commands.</span></span> <span data-ttu-id="6fbfa-114">執行了兩個命令，而最後一個命令傳遞了無效的參數引數。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-114">Two commands are run, and the last command is passed a parameter argument that is not valid.</span></span> <span data-ttu-id="6fbfa-115">因此，不會傳回任何物件，也會擲回終止錯誤。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-115">As a result no objects are returned and a terminating error is thrown.</span></span>

 <span data-ttu-id="6fbfa-116">[Runspace05 範例](./runspace05-sample.md)這個範例示範如何將嵌入式管理單元新增至[System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState)物件，以便在開啟執行時間時使用嵌入式管理單元的 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-116">[Runspace05 Sample](./runspace05-sample.md) This sample shows how to add a snap-in to an [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) object so that the cmdlet of the snap-in is available when the runspace is opened.</span></span> <span data-ttu-id="6fbfa-117">此嵌入式管理單元提供的[GetProcessSample01 範例](../cmdlet/getprocesssample01-sample.md)) 所定義的 (，會使用[system.web](/dotnet/api/system.management.automation.powershell)物件以同步方式執行。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-117">The snap-in provides a Get-Proc cmdlet (defined by the [GetProcessSample01 Sample](../cmdlet/getprocesssample01-sample.md)) that is run synchronously using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="6fbfa-118">[Runspace06 範例](./runspace06-sample.md)這個範例會示範如何將模組新增至[System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState)物件，以便在開啟執行時間時載入模組。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-118">[Runspace06 Sample](./runspace06-sample.md) This sample shows how to add a module to an [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) object so that the module is loaded when the runspace is opened.</span></span> <span data-ttu-id="6fbfa-119">此模組會提供[GetProcessSample02 範例](../cmdlet/getprocesssample02-sample.md)) 所定義的 (，此 Cmdlet 是使用[system.web](/dotnet/api/system.management.automation.powershell)物件同步執行。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-119">The module provides a Get-Proc cmdlet (defined by the [GetProcessSample02 Sample](../cmdlet/getprocesssample02-sample.md)) that is run synchronously using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="6fbfa-120">[Runspace07 範例](./runspace07-sample.md)這個範例會示範如何建立執行時間，然後使用該執行時間，透過使用[system.web](/dotnet/api/system.management.automation.powershell)物件，以同步方式執行兩個 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-120">[Runspace07 Sample](./runspace07-sample.md) This sample shows how to create a runspace, and then use that runspace to run two cmdlets synchronously by using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="6fbfa-121">[Runspace08 範例](./runspace08-sample.md)這個範例示範如何將命令和引數新增至[system.web](/dotnet/api/system.management.automation.powershell)物件的管線，以及如何同步執行命令。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-121">[Runspace08 Sample](./runspace08-sample.md) This sample shows how to add commands and arguments to the pipeline of a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object and how to run the commands synchronously.</span></span>

 <span data-ttu-id="6fbfa-122">[Runspace09 範例](./runspace09-sample.md)這個範例示範如何將腳本新增至[system.web](/dotnet/api/system.management.automation.powershell)物件的管線，以及如何以非同步方式執行腳本。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-122">[Runspace09 Sample](./runspace09-sample.md) This sample shows how to add a script to the pipeline of a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object and how to run the script asynchronously.</span></span> <span data-ttu-id="6fbfa-123">事件為用來處理指令碼的輸出。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-123">Events are used to handle the output of the script.</span></span>

 <span data-ttu-id="6fbfa-124">[Runspace10 範例](./runspace10-sample.md)這個範例會示範如何建立預設初始會話狀態、如何將 Cmdlet 新增至[System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState)、如何建立使用初始會話狀態的執行時間，以及如何使用[system.web](/dotnet/api/system.management.automation.powershell)物件來執行命令。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-124">[Runspace10 Sample](./runspace10-sample.md) This sample shows how to create a default initial session state, how to add a cmdlet to the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState), how to create a runspace that uses the initial session state, and how to run the command by using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="6fbfa-125">[Runspace11 範例](./runspace11-sample.md)這會示範如何使用[Proxycommand](/dotnet/api/System.Management.Automation.ProxyCommand)類別來建立 proxy 命令，以呼叫現有的 Cmdlet，但會限制可用的參數集合。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-125">[Runspace11 Sample](./runspace11-sample.md) This shows how to use the [System.Management.Automation.Proxycommand](/dotnet/api/System.Management.Automation.ProxyCommand) class to create a proxy command that calls an existing cmdlet, but restricts the set of available parameters.</span></span> <span data-ttu-id="6fbfa-126">Proxy 命令接著會加入用來建立受限 Runspace 的初始工作階段狀態。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-126">The proxy command is then added to an initial session state that is used to create a constrained runspace.</span></span> <span data-ttu-id="6fbfa-127">這表示使用者只能透過 Proxy 命令使用此 Cmdlet 的功能。</span><span class="sxs-lookup"><span data-stu-id="6fbfa-127">This means that the user can access the functionality of the cmdlet only through the proxy command.</span></span>

## <a name="see-also"></a><span data-ttu-id="6fbfa-128">另請參閱</span><span class="sxs-lookup"><span data-stu-id="6fbfa-128">See Also</span></span>
